<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Module:Lang - Wikipedia</title>
<script>(function(){var className="client-js vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-1 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-enabled skin-theme-clientpref-day vector-sticky-header-enabled vector-toc-available";var cookie=document.cookie.match(/(?:^|; )enwikimwclientpreferences=([^;]+)/);if(cookie){cookie[1].split('%2C').forEach(function(pref){className=className.replace(new RegExp('(^| )'+pref.replace(/-clientpref-\w+$|[^\w-]+/g,'')+'-clientpref-\\w+( |$)'),'$1'+pref+'$2');});}document.documentElement.className=className;}());RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"c0754eb1-0140-41d7-8c1e-b900c1922e63","wgCanonicalNamespace":"Module","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":828,"wgPageName":"Module:Lang","wgTitle":"Lang","wgCurRevisionId":1271539603,"wgRevisionId":1271539603,"wgArticleId":55674518,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Wikipedia template-protected modules","Language-related modules","Modules that check for strip markers"],"wgPageViewLanguage":"en","wgPageContentLanguage":"en","wgPageContentModel":"Scribunto","wgRelevantPageName":"Module:Lang","wgRelevantArticleId":55674518,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":["templateeditor"],"wgRestrictionMove":["templateeditor"],"wgNoticeProject":"wikipedia","wgCiteReferencePreviewsActive":false,"wgFlaggedRevsParams":{"tags":{"status":{"levels":1}}},"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgPopupsFlags":0,"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"watchlist":true,"tagline":false,"nearby":true},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":90000,"wgEditSubmitButtonLabelPublish":true,"wgULSPosition":"interlanguage","wgULSisCompactLinksEnabled":false,"wgVector2022LanguageInHeader":true,"wgULSisLanguageSelectorEmpty":false,"wgWikibaseItemId":"Q42895737","wgCheckUserClientHintsHeadersJsApi":["brands","architecture","bitness","fullVersionList","mobile","model","platform","platformVersion"],"GEHomepageSuggestedEditsEnableTopics":true,"wgGETopicsMatchModeEnabled":false,"wgGELevelingUpEnabledForUser":false};
RLSTATE={"ext.globalCssJs.user.styles":"ready","site.styles":"ready","user.styles":"ready","ext.globalCssJs.user":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","skins.vector.search.codex.styles":"ready","skins.vector.styles":"ready","skins.vector.icons":"ready","ext.wikimediamessages.styles":"ready","ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.interlanguage":"ready","wikibase.client.init":"ready"};RLPAGEMODULES=["ext.pygments.view","site","mediawiki.page.ready","mediawiki.toc","skins.vector.js","ext.centralNotice.geoIP","ext.centralNotice.startUp","ext.gadget.ReferenceTooltips","ext.gadget.switcher","ext.urlShortener.toolbar","ext.centralauth.centralautologin","mmv.bootstrap","ext.popups","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.echo.centralauth","ext.eventLogging","ext.wikimediaEvents","ext.navigationTiming","ext.uls.interface","ext.cx.eventlogging.campaigns","wikibase.client.vector-2022","ext.checkUser.clientHints"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.impl(function(){return["user.options@12s5i",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
}];});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.pygments%7Cext.uls.interlanguage%7Cext.visualEditor.desktopArticleTarget.noscript%7Cext.wikimediamessages.styles%7Cskins.vector.icons%2Cstyles%7Cskins.vector.search.codex.styles%7Cwikibase.client.init&amp;only=styles&amp;skin=vector-2022">
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector-2022"></script>
<meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector-2022">
<meta name="generator" content="MediaWiki 1.44.0-wmf.22">
<meta name="referrer" content="origin">
<meta name="referrer" content="origin-when-cross-origin">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=1120">
<meta property="og:title" content="Module:Lang - Wikipedia">
<meta property="og:type" content="website">
<link rel="preconnect" href="//upload.wikimedia.org">
<link rel="alternate" media="only screen and (max-width: 640px)" href="//en.m.wikipedia.org/wiki/Module:Lang">
<link rel="apple-touch-icon" href="/static/apple-touch/wikipedia.png">
<link rel="icon" href="/static/favicon/wikipedia.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/w/rest.php/v1/search" title="Wikipedia (en)">
<link rel="EditURI" type="application/rsd+xml" href="//en.wikipedia.org/w/api.php?action=rsd">
<link rel="canonical" href="https://en.wikipedia.org/wiki/Module:Lang">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">
<link rel="alternate" type="application/atom+xml" title="Wikipedia Atom feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom">
<link rel="dns-prefetch" href="//meta.wikimedia.org" />
<link rel="dns-prefetch" href="login.wikimedia.org">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-828 ns-subject page-Module_Lang rootpage-Module_Lang skin-vector-2022 action-view"><a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	<header class="vector-header mw-header">
		<div class="vector-header-start">
			<nav class="vector-main-menu-landmark" aria-label="Site">
				
<div id="vector-main-menu-dropdown" class="vector-dropdown vector-main-menu-dropdown vector-button-flush-left vector-button-flush-right"  title="Main menu" >
	<input type="checkbox" id="vector-main-menu-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-main-menu-dropdown" class="vector-dropdown-checkbox "  aria-label="Main menu"  >
	<label id="vector-main-menu-dropdown-label" for="vector-main-menu-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-menu mw-ui-icon-wikimedia-menu"></span>

<span class="vector-dropdown-label-text">Main menu</span>
	</label>
	<div class="vector-dropdown-content">


				<div id="vector-main-menu-unpinned-container" class="vector-unpinned-container">
		
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-main-menu-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="main-menu-pinned"
	data-pinnable-element-id="vector-main-menu"
	data-pinned-container-id="vector-main-menu-pinned-container"
	data-unpinned-container-id="vector-main-menu-unpinned-container"
>
	<div class="vector-pinnable-header-label">Main menu</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-main-menu.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-main-menu.unpin">hide</button>
</div>

	
<div id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation"  >
	<div class="vector-menu-heading">
		Navigation
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-mainpage-description" class="mw-list-item"><a href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-contents" class="mw-list-item"><a href="/wiki/Wikipedia:Contents" title="Guides to browsing Wikipedia"><span>Contents</span></a></li><li id="n-currentevents" class="mw-list-item"><a href="/wiki/Portal:Current_events" title="Articles related to current events"><span>Current events</span></a></li><li id="n-randompage" class="mw-list-item"><a href="/wiki/Special:Random" title="Visit a randomly selected article [x]" accesskey="x"><span>Random article</span></a></li><li id="n-aboutsite" class="mw-list-item"><a href="/wiki/Wikipedia:About" title="Learn about Wikipedia and how it works"><span>About Wikipedia</span></a></li><li id="n-contactpage" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us" title="How to contact Wikipedia"><span>Contact us</span></a></li>
		</ul>
		
	</div>
</div>

	
	
<div id="p-interaction" class="vector-menu mw-portlet mw-portlet-interaction"  >
	<div class="vector-menu-heading">
		Contribute
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-help" class="mw-list-item"><a href="/wiki/Help:Contents" title="Guidance on how to use and edit Wikipedia"><span>Help</span></a></li><li id="n-introduction" class="mw-list-item"><a href="/wiki/Help:Introduction" title="Learn how to edit Wikipedia"><span>Learn to edit</span></a></li><li id="n-portal" class="mw-list-item"><a href="/wiki/Wikipedia:Community_portal" title="The hub for editors"><span>Community portal</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" title="A list of recent changes to Wikipedia [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-upload" class="mw-list-item"><a href="/wiki/Wikipedia:File_upload_wizard" title="Add images or other media for use on Wikipedia"><span>Upload file</span></a></li><li id="n-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages"><span>Special pages</span></a></li>
		</ul>
		
	</div>
</div>

</div>

				</div>

	</div>
</div>

		</nav>
			
<a href="/wiki/Main_Page" class="mw-logo">
	<img class="mw-logo-icon" src="/static/images/icons/wikipedia.png" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container skin-invert">
		<img class="mw-logo-wordmark" alt="Wikipedia" src="/static/images/mobile/copyright/wikipedia-wordmark-en.svg" style="width: 7.5em; height: 1.125em;">
		<img class="mw-logo-tagline" alt="The Free Encyclopedia" src="/static/images/mobile/copyright/wikipedia-tagline-en.svg" width="117" height="13" style="width: 7.3125em; height: 0.8125em;">
	</span>
</a>

		</div>
		<div class="vector-header-end">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="/wiki/Special:Search" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only search-toggle" title="Search Wikipedia [f]" accesskey="f"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
	</a>
	<div class="vector-typeahead-search-container">
		<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail cdx-typeahead-search--auto-expand-width">
			<form action="/w/index.php" id="searchform" class="cdx-search-input cdx-search-input--has-end-button">
				<div id="simpleSearch" class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
					<div class="cdx-text-input cdx-text-input--has-start-icon">
						<input
							class="cdx-text-input__input"
							 type="search" name="search" placeholder="Search Wikipedia" aria-label="Search Wikipedia" autocapitalize="sentences" title="Search Wikipedia [f]" accesskey="f" id="searchInput"
							>
						<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
					</div>
					<input type="hidden" name="title" value="Special:Search">
				</div>
				<button class="cdx-button cdx-search-input__end-button">Search</button>
			</form>
		</div>
	</div>
</div>

			<nav class="vector-user-links vector-user-links-wide" aria-label="Personal tools">
	<div class="vector-user-links-main">
	
<div id="p-vector-user-menu-preferences" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-userpage" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	<nav class="vector-appearance-landmark" aria-label="Appearance">
		
<div id="vector-appearance-dropdown" class="vector-dropdown "  title="Change the appearance of the page&#039;s font size, width, and color" >
	<input type="checkbox" id="vector-appearance-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-appearance-dropdown" class="vector-dropdown-checkbox "  aria-label="Appearance"  >
	<label id="vector-appearance-dropdown-label" for="vector-appearance-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-appearance mw-ui-icon-wikimedia-appearance"></span>

<span class="vector-dropdown-label-text">Appearance</span>
	</label>
	<div class="vector-dropdown-content">


			<div id="vector-appearance-unpinned-container" class="vector-unpinned-container">
				
			</div>
		
	</div>
</div>

	</nav>
	
<div id="p-vector-user-menu-notifications" class="vector-menu mw-portlet emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="pt-sitesupport-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw="interface" href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en" class=""><span>Donate</span></a>
</li>
<li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw="interface" href="/w/index.php?title=Special:CreateAccount&amp;returnto=Module%3ALang" title="You are encouraged to create an account and log in; however, it is not mandatory" class=""><span>Create account</span></a>
</li>
<li id="pt-login-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item"><a data-mw="interface" href="/w/index.php?title=Special:UserLogin&amp;returnto=Module%3ALang" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o" class=""><span>Log in</span></a>
</li>

			
		</ul>
		
	</div>
</div>

	</div>
	
<div id="vector-user-links-dropdown" class="vector-dropdown vector-user-menu vector-button-flush-right vector-user-menu-logged-out"  title="Log in and more options" >
	<input type="checkbox" id="vector-user-links-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-user-links-dropdown" class="vector-dropdown-checkbox "  aria-label="Personal tools"  >
	<label id="vector-user-links-dropdown-label" for="vector-user-links-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

<span class="vector-dropdown-label-text">Personal tools</span>
	</label>
	<div class="vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal user-links-collapsible-item"  title="User menu" >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-sitesupport" class="user-links-collapsible-item mw-list-item"><a href="https://donate.wikimedia.org/?wmf_source=donate&amp;wmf_medium=sidebar&amp;wmf_campaign=en.wikipedia.org&amp;uselang=en"><span>Donate</span></a></li><li id="pt-createaccount" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Module%3ALang" title="You are encouraged to create an account and log in; however, it is not mandatory"><span class="vector-icon mw-ui-icon-userAdd mw-ui-icon-wikimedia-userAdd"></span> <span>Create account</span></a></li><li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Module%3ALang" title="You&#039;re encouraged to log in; however, it&#039;s not mandatory. [o]" accesskey="o"><span class="vector-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-user-menu-anon-editor" class="vector-menu mw-portlet mw-portlet-user-menu-anon-editor"  >
	<div class="vector-menu-heading">
		Pages for logged out editors <a href="/wiki/Help:Introduction" aria-label="Learn more about editing"><span>learn more</span></a>
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-anoncontribs" class="mw-list-item"><a href="/wiki/Special:MyContributions" title="A list of edits made from this IP address [y]" accesskey="y"><span>Contributions</span></a></li><li id="pt-anontalk" class="mw-list-item"><a href="/wiki/Special:MyTalk" title="Discussion about edits from this IP address [n]" accesskey="n"><span>Talk</span></a></li>
		</ul>
		
	</div>
</div>

	
	</div>
</div>

</nav>

		</div>
	</header>
</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-sitenotice-container">
			<div id="siteNotice"><!-- CentralNotice --></div>
		</div>
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		<div id="mw-navigation">
			<nav id="mw-panel" class="vector-main-menu-landmark" aria-label="Site">
				<div id="vector-main-menu-pinned-container" class="vector-pinned-container">
				
				</div>
		</nav>
		</div>
	</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="toc-pinned"
	data-pinnable-element-id="vector-toc"
	
	
>
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text"
			class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">(Top)</div>
			</a>
		</li>
		<li id="toc-Data_set"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Data_set">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Data set</span>
			</div>
		</a>
		
		<ul id="toc-Data_set-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Testcases"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Testcases">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Testcases</span>
			</div>
		</a>
		
		<ul id="toc-Testcases-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Tracking_categories"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Tracking_categories">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Tracking categories</span>
			</div>
		</a>
		
		<ul id="toc-Tracking_categories-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-See_also"
		class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#See_also">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>See also</span>
			</div>
		</a>
		
		<ul id="toc-See_also-sublist" class="vector-toc-list">
		</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left"  title="Table of Contents" >
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox "  aria-label="Toggle the table of contents"  >
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-namespace">Module</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">Lang</span></h1>
							
<div id="p-lang-btn" class="vector-dropdown mw-portlet mw-portlet-lang"  >
	<input type="checkbox" id="p-lang-btn-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-lang-btn" class="vector-dropdown-checkbox mw-interlanguage-selector" aria-label="Go to an article in another language. Available in 142 languages"   >
	<label id="p-lang-btn-label" for="p-lang-btn-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive mw-portlet-lang-heading-142" aria-hidden="true"  ><span class="vector-icon mw-ui-icon-language-progressive mw-ui-icon-wikimedia-language-progressive"></span>

<span class="vector-dropdown-label-text">142 languages</span>
	</label>
	<div class="vector-dropdown-content">

		<div class="vector-menu-content">
			
			<ul class="vector-menu-content-list">
				
				<li class="interlanguage-link interwiki-af mw-list-item"><a href="https://af.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Afrikaans" lang="af" hreflang="af" data-title="Module:Lang" data-language-autonym="Afrikaans" data-language-local-name="Afrikaans" class="interlanguage-link-target"><span>Afrikaans</span></a></li><li class="interlanguage-link interwiki-smn mw-list-item"><a href="https://smn.wikipedia.org/wiki/Mooduul:Lang" title="Mooduul:Lang – Inari Sami" lang="smn" hreflang="smn" data-title="Mooduul:Lang" data-language-autonym="Anarâškielâ" data-language-local-name="Inari Sami" class="interlanguage-link-target"><span>Anarâškielâ</span></a></li><li class="interlanguage-link interwiki-ang mw-list-item"><a href="https://ang.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Old English" lang="ang" hreflang="ang" data-title="Module:Lang" data-language-autonym="Ænglisc" data-language-local-name="Old English" class="interlanguage-link-target"><span>Ænglisc</span></a></li><li class="interlanguage-link interwiki-ab mw-list-item"><a href="https://ab.wikipedia.org/wiki/%D0%90%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Lang" title="Амодуль:Lang – Abkhazian" lang="ab" hreflang="ab" data-title="Амодуль:Lang" data-language-autonym="Аԥсшәа" data-language-local-name="Abkhazian" class="interlanguage-link-target"><span>Аԥсшәа</span></a></li><li class="interlanguage-link interwiki-ar mw-list-item"><a href="https://ar.wikipedia.org/wiki/%D9%88%D8%AD%D8%AF%D8%A9:Lang" title="وحدة:Lang – Arabic" lang="ar" hreflang="ar" data-title="وحدة:Lang" data-language-autonym="العربية" data-language-local-name="Arabic" class="interlanguage-link-target"><span>العربية</span></a></li><li class="interlanguage-link interwiki-hyw mw-list-item"><a href="https://hyw.wikipedia.org/wiki/%D5%84%D5%B8%D5%A4%D5%B8%D6%82%D5%AC:Lang" title="Մոդուլ:Lang – Western Armenian" lang="hyw" hreflang="hyw" data-title="Մոդուլ:Lang" data-language-autonym="Արեւմտահայերէն" data-language-local-name="Western Armenian" class="interlanguage-link-target"><span>Արեւմտահայերէն</span></a></li><li class="interlanguage-link interwiki-as mw-list-item"><a href="https://as.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Assamese" lang="as" hreflang="as" data-title="Module:Lang" data-language-autonym="অসমীয়া" data-language-local-name="Assamese" class="interlanguage-link-target"><span>অসমীয়া</span></a></li><li class="interlanguage-link interwiki-ast mw-list-item"><a href="https://ast.wikipedia.org/wiki/M%C3%B3dulu:Lang" title="Módulu:Lang – Asturian" lang="ast" hreflang="ast" data-title="Módulu:Lang" data-language-autonym="Asturianu" data-language-local-name="Asturian" class="interlanguage-link-target"><span>Asturianu</span></a></li><li class="interlanguage-link interwiki-awa mw-list-item"><a href="https://awa.wikipedia.org/wiki/%E0%A4%85%E0%A4%A8%E0%A5%81%E0%A4%96%E0%A4%82%E0%A4%A1:Lang" title="अनुखंड:Lang – Awadhi" lang="awa" hreflang="awa" data-title="अनुखंड:Lang" data-language-autonym="अवधी" data-language-local-name="Awadhi" class="interlanguage-link-target"><span>अवधी</span></a></li><li class="interlanguage-link interwiki-av mw-list-item"><a href="https://av.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Langs" title="Модуль:Langs – Avaric" lang="av" hreflang="av" data-title="Модуль:Langs" data-language-autonym="Авар" data-language-local-name="Avaric" class="interlanguage-link-target"><span>Авар</span></a></li><li class="interlanguage-link interwiki-azb mw-list-item"><a href="https://azb.wikipedia.org/wiki/%D9%85%D8%A7%DA%98%D9%88%D9%84:Lang" title="ماژول:Lang – South Azerbaijani" lang="azb" hreflang="azb" data-title="ماژول:Lang" data-language-autonym="تۆرکجه" data-language-local-name="South Azerbaijani" class="interlanguage-link-target"><span>تۆرکجه</span></a></li><li class="interlanguage-link interwiki-ban mw-list-item"><a href="https://ban.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Balinese" lang="ban" hreflang="ban" data-title="Modul:Lang" data-language-autonym="Basa Bali" data-language-local-name="Balinese" class="interlanguage-link-target"><span>Basa Bali</span></a></li><li class="interlanguage-link interwiki-bn mw-list-item"><a href="https://bn.wikipedia.org/wiki/%E0%A6%AE%E0%A6%A1%E0%A6%BF%E0%A6%89%E0%A6%B2:Lang" title="মডিউল:Lang – Bangla" lang="bn" hreflang="bn" data-title="মডিউল:Lang" data-language-autonym="বাংলা" data-language-local-name="Bangla" class="interlanguage-link-target"><span>বাংলা</span></a></li><li class="interlanguage-link interwiki-bjn mw-list-item"><a href="https://bjn.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Banjar" lang="bjn" hreflang="bjn" data-title="Modul:Lang" data-language-autonym="Banjar" data-language-local-name="Banjar" class="interlanguage-link-target"><span>Banjar</span></a></li><li class="interlanguage-link interwiki-zh-min-nan mw-list-item"><a href="https://zh-min-nan.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Minnan" lang="nan" hreflang="nan" data-title="模組:Lang" data-language-autonym="閩南語 / Bân-lâm-gú" data-language-local-name="Minnan" class="interlanguage-link-target"><span>閩南語 / Bân-lâm-gú</span></a></li><li class="interlanguage-link interwiki-ba mw-list-item"><a href="https://ba.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Lang" title="Модуль:Lang – Bashkir" lang="ba" hreflang="ba" data-title="Модуль:Lang" data-language-autonym="Башҡортса" data-language-local-name="Bashkir" class="interlanguage-link-target"><span>Башҡортса</span></a></li><li class="interlanguage-link interwiki-be-x-old mw-list-item"><a href="https://be-tarask.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:%D0%9C%D0%BE%D0%B2%D0%B0" title="Модуль:Мова – Belarusian (Taraškievica orthography)" lang="be-tarask" hreflang="be-tarask" data-title="Модуль:Мова" data-language-autonym="Беларуская (тарашкевіца)" data-language-local-name="Belarusian (Taraškievica orthography)" class="interlanguage-link-target"><span>Беларуская (тарашкевіца)</span></a></li><li class="interlanguage-link interwiki-bh mw-list-item"><a href="https://bh.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Bhojpuri" lang="bh" hreflang="bh" data-title="Module:Lang" data-language-autonym="भोजपुरी" data-language-local-name="Bhojpuri" class="interlanguage-link-target"><span>भोजपुरी</span></a></li><li class="interlanguage-link interwiki-bcl mw-list-item"><a href="https://bcl.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Central Bikol" lang="bcl" hreflang="bcl" data-title="Module:Lang" data-language-autonym="Bikol Central" data-language-local-name="Central Bikol" class="interlanguage-link-target"><span>Bikol Central</span></a></li><li class="interlanguage-link interwiki-bs mw-list-item"><a href="https://bs.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Bosnian" lang="bs" hreflang="bs" data-title="Modul:Lang" data-language-autonym="Bosanski" data-language-local-name="Bosnian" class="interlanguage-link-target"><span>Bosanski</span></a></li><li class="interlanguage-link interwiki-bxr mw-list-item"><a href="https://bxr.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Lang" title="Модуль:Lang – Russia Buriat" lang="bxr" hreflang="bxr" data-title="Модуль:Lang" data-language-autonym="Буряад" data-language-local-name="Russia Buriat" class="interlanguage-link-target"><span>Буряад</span></a></li><li class="interlanguage-link interwiki-ca mw-list-item"><a href="https://ca.wikipedia.org/wiki/M%C3%B2dul:Lang" title="Mòdul:Lang – Catalan" lang="ca" hreflang="ca" data-title="Mòdul:Lang" data-language-autonym="Català" data-language-local-name="Catalan" class="interlanguage-link-target"><span>Català</span></a></li><li class="interlanguage-link interwiki-ceb mw-list-item"><a href="https://ceb.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Cebuano" lang="ceb" hreflang="ceb" data-title="Module:Lang" data-language-autonym="Cebuano" data-language-local-name="Cebuano" class="interlanguage-link-target"><span>Cebuano</span></a></li><li class="interlanguage-link interwiki-ny mw-list-item"><a href="https://ny.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Nyanja" lang="ny" hreflang="ny" data-title="Module:Lang" data-language-autonym="Chi-Chewa" data-language-local-name="Nyanja" class="interlanguage-link-target"><span>Chi-Chewa</span></a></li><li class="interlanguage-link interwiki-sn mw-list-item"><a href="https://sn.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Shona" lang="sn" hreflang="sn" data-title="Module:Lang" data-language-autonym="ChiShona" data-language-local-name="Shona" class="interlanguage-link-target"><span>ChiShona</span></a></li><li class="interlanguage-link interwiki-co mw-list-item"><a href="https://co.wikipedia.org/wiki/Modulo:Lang" title="Modulo:Lang – Corsican" lang="co" hreflang="co" data-title="Modulo:Lang" data-language-autonym="Corsu" data-language-local-name="Corsican" class="interlanguage-link-target"><span>Corsu</span></a></li><li class="interlanguage-link interwiki-cy mw-list-item"><a href="https://cy.wikipedia.org/wiki/Modiwl:Lang" title="Modiwl:Lang – Welsh" lang="cy" hreflang="cy" data-title="Modiwl:Lang" data-language-autonym="Cymraeg" data-language-local-name="Welsh" class="interlanguage-link-target"><span>Cymraeg</span></a></li><li class="interlanguage-link interwiki-dag mw-list-item"><a href="https://dag.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Dagbani" lang="dag" hreflang="dag" data-title="Module:Lang" data-language-autonym="Dagbanli" data-language-local-name="Dagbani" class="interlanguage-link-target"><span>Dagbanli</span></a></li><li class="interlanguage-link interwiki-da mw-list-item"><a href="https://da.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Danish" lang="da" hreflang="da" data-title="Modul:Lang" data-language-autonym="Dansk" data-language-local-name="Danish" class="interlanguage-link-target"><span>Dansk</span></a></li><li class="interlanguage-link interwiki-ary mw-list-item"><a href="https://ary.wikipedia.org/wiki/%D9%85%D9%88%D8%AF%D9%88%D9%84:Lang" title="مودول:Lang – Moroccan Arabic" lang="ary" hreflang="ary" data-title="مودول:Lang" data-language-autonym="الدارجة" data-language-local-name="Moroccan Arabic" class="interlanguage-link-target"><span>الدارجة</span></a></li><li class="interlanguage-link interwiki-dv mw-list-item"><a href="https://dv.wikipedia.org/wiki/%DE%89%DE%AE%DE%91%DE%A8%DE%87%DE%AA%DE%8D%DE%B0:Lang" title="މޮޑިއުލް:Lang – Divehi" lang="dv" hreflang="dv" data-title="މޮޑިއުލް:Lang" data-language-autonym="ދިވެހިބަސް" data-language-local-name="Divehi" class="interlanguage-link-target"><span>ދިވެހިބަސް</span></a></li><li class="interlanguage-link interwiki-el mw-list-item"><a href="https://el.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Greek" lang="el" hreflang="el" data-title="Module:Lang" data-language-autonym="Ελληνικά" data-language-local-name="Greek" class="interlanguage-link-target"><span>Ελληνικά</span></a></li><li class="interlanguage-link interwiki-es mw-list-item"><a href="https://es.wikipedia.org/wiki/M%C3%B3dulo:Lang" title="Módulo:Lang – Spanish" lang="es" hreflang="es" data-title="Módulo:Lang" data-language-autonym="Español" data-language-local-name="Spanish" class="interlanguage-link-target"><span>Español</span></a></li><li class="interlanguage-link interwiki-fa mw-list-item"><a href="https://fa.wikipedia.org/wiki/%D9%BE%D9%88%D8%AF%D9%85%D8%A7%D9%86:Lang" title="پودمان:Lang – Persian" lang="fa" hreflang="fa" data-title="پودمان:Lang" data-language-autonym="فارسی" data-language-local-name="Persian" class="interlanguage-link-target"><span>فارسی</span></a></li><li class="interlanguage-link interwiki-hif mw-list-item"><a href="https://hif.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Fiji Hindi" lang="hif" hreflang="hif" data-title="Module:Lang" data-language-autonym="Fiji Hindi" data-language-local-name="Fiji Hindi" class="interlanguage-link-target"><span>Fiji Hindi</span></a></li><li class="interlanguage-link interwiki-ff mw-list-item"><a href="https://ff.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Fula" lang="ff" hreflang="ff" data-title="Module:Lang" data-language-autonym="Fulfulde" data-language-local-name="Fula" class="interlanguage-link-target"><span>Fulfulde</span></a></li><li class="interlanguage-link interwiki-ga mw-list-item"><a href="https://ga.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Irish" lang="ga" hreflang="ga" data-title="Module:Lang" data-language-autonym="Gaeilge" data-language-local-name="Irish" class="interlanguage-link-target"><span>Gaeilge</span></a></li><li class="interlanguage-link interwiki-gl mw-list-item"><a href="https://gl.wikipedia.org/wiki/M%C3%B3dulo:Lang" title="Módulo:Lang – Galician" lang="gl" hreflang="gl" data-title="Módulo:Lang" data-language-autonym="Galego" data-language-local-name="Galician" class="interlanguage-link-target"><span>Galego</span></a></li><li class="interlanguage-link interwiki-gan mw-list-item"><a href="https://gan.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Gan" lang="gan" hreflang="gan" data-title="模組:Lang" data-language-autonym="贛語" data-language-local-name="Gan" class="interlanguage-link-target"><span>贛語</span></a></li><li class="interlanguage-link interwiki-glk mw-list-item"><a href="https://glk.wikipedia.org/wiki/%D9%85%D8%A7%D8%AC%DB%8A%D9%84:Lang" title="ماجۊل:Lang – Gilaki" lang="glk" hreflang="glk" data-title="ماجۊل:Lang" data-language-autonym="گیلکی" data-language-local-name="Gilaki" class="interlanguage-link-target"><span>گیلکی</span></a></li><li class="interlanguage-link interwiki-gu mw-list-item"><a href="https://gu.wikipedia.org/wiki/%E0%AA%B5%E0%AA%BF%E0%AA%AD%E0%AA%BE%E0%AA%97:Lang" title="વિભાગ:Lang – Gujarati" lang="gu" hreflang="gu" data-title="વિભાગ:Lang" data-language-autonym="ગુજરાતી" data-language-local-name="Gujarati" class="interlanguage-link-target"><span>ગુજરાતી</span></a></li><li class="interlanguage-link interwiki-gom mw-list-item"><a href="https://gom.wikipedia.org/wiki/%E0%A4%8F%E0%A4%95%E0%A4%95:Lang" title="एकक:Lang – Goan Konkani" lang="gom" hreflang="gom" data-title="एकक:Lang" data-language-autonym="गोंयची कोंकणी / Gõychi Konknni" data-language-local-name="Goan Konkani" class="interlanguage-link-target"><span>गोंयची कोंकणी / Gõychi Konknni</span></a></li><li class="interlanguage-link interwiki-guw mw-list-item"><a href="https://guw.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Gun" lang="guw" hreflang="guw" data-title="Module:Lang" data-language-autonym="Gungbe" data-language-local-name="Gun" class="interlanguage-link-target"><span>Gungbe</span></a></li><li class="interlanguage-link interwiki-hak mw-list-item"><a href="https://hak.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Hakka Chinese" lang="hak" hreflang="hak" data-title="模組:Lang" data-language-autonym="客家語 / Hak-kâ-ngî" data-language-local-name="Hakka Chinese" class="interlanguage-link-target"><span>客家語 / Hak-kâ-ngî</span></a></li><li class="interlanguage-link interwiki-xal mw-list-item"><a href="https://xal.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Lang" title="Модуль:Lang – Kalmyk" lang="xal" hreflang="xal" data-title="Модуль:Lang" data-language-autonym="Хальмг" data-language-local-name="Kalmyk" class="interlanguage-link-target"><span>Хальмг</span></a></li><li class="interlanguage-link interwiki-ko mw-list-item"><a href="https://ko.wikipedia.org/wiki/%EB%AA%A8%EB%93%88:Lang" title="모듈:Lang – Korean" lang="ko" hreflang="ko" data-title="모듈:Lang" data-language-autonym="한국어" data-language-local-name="Korean" class="interlanguage-link-target"><span>한국어</span></a></li><li class="interlanguage-link interwiki-ha mw-list-item"><a href="https://ha.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Hausa" lang="ha" hreflang="ha" data-title="Module:Lang" data-language-autonym="Hausa" data-language-local-name="Hausa" class="interlanguage-link-target"><span>Hausa</span></a></li><li class="interlanguage-link interwiki-hy mw-list-item"><a href="https://hy.wikipedia.org/wiki/%D5%84%D5%B8%D5%A4%D5%B8%D6%82%D5%AC:Lang" title="Մոդուլ:Lang – Armenian" lang="hy" hreflang="hy" data-title="Մոդուլ:Lang" data-language-autonym="Հայերեն" data-language-local-name="Armenian" class="interlanguage-link-target"><span>Հայերեն</span></a></li><li class="interlanguage-link interwiki-hi mw-list-item"><a href="https://hi.wikipedia.org/wiki/%E0%A4%AE%E0%A5%89%E0%A4%A1%E0%A5%8D%E0%A4%AF%E0%A5%82%E0%A4%B2:Lang" title="मॉड्यूल:Lang – Hindi" lang="hi" hreflang="hi" data-title="मॉड्यूल:Lang" data-language-autonym="हिन्दी" data-language-local-name="Hindi" class="interlanguage-link-target"><span>हिन्दी</span></a></li><li class="interlanguage-link interwiki-gor mw-list-item"><a href="https://gor.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Gorontalo" lang="gor" hreflang="gor" data-title="Modul:Lang" data-language-autonym="Bahasa Hulontalo" data-language-local-name="Gorontalo" class="interlanguage-link-target"><span>Bahasa Hulontalo</span></a></li><li class="interlanguage-link interwiki-ilo mw-list-item"><a href="https://ilo.wikipedia.org/wiki/Modulo:Lang" title="Modulo:Lang – Iloko" lang="ilo" hreflang="ilo" data-title="Modulo:Lang" data-language-autonym="Ilokano" data-language-local-name="Iloko" class="interlanguage-link-target"><span>Ilokano</span></a></li><li class="interlanguage-link interwiki-bpy mw-list-item"><a href="https://bpy.wikipedia.org/wiki/%E0%A6%AE%E0%A6%A1%E0%A6%BF%E0%A6%89%E0%A6%B2:Lang" title="মডিউল:Lang – Bishnupriya" lang="bpy" hreflang="bpy" data-title="মডিউল:Lang" data-language-autonym="বিষ্ণুপ্রিয়া মণিপুরী" data-language-local-name="Bishnupriya" class="interlanguage-link-target"><span>বিষ্ণুপ্রিয়া মণিপুরী</span></a></li><li class="interlanguage-link interwiki-id mw-list-item"><a href="https://id.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Indonesian" lang="id" hreflang="id" data-title="Modul:Lang" data-language-autonym="Bahasa Indonesia" data-language-local-name="Indonesian" class="interlanguage-link-target"><span>Bahasa Indonesia</span></a></li><li class="interlanguage-link interwiki-xh mw-list-item"><a href="https://xh.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Xhosa" lang="xh" hreflang="xh" data-title="Module:Lang" data-language-autonym="IsiXhosa" data-language-local-name="Xhosa" class="interlanguage-link-target"><span>IsiXhosa</span></a></li><li class="interlanguage-link interwiki-he mw-list-item"><a href="https://he.wikipedia.org/wiki/%D7%99%D7%97%D7%99%D7%93%D7%94:Lang" title="יחידה:Lang – Hebrew" lang="he" hreflang="he" data-title="יחידה:Lang" data-language-autonym="עברית" data-language-local-name="Hebrew" class="interlanguage-link-target"><span>עברית</span></a></li><li class="interlanguage-link interwiki-jv mw-list-item"><a href="https://jv.wikipedia.org/wiki/Modhul:Lang" title="Modhul:Lang – Javanese" lang="jv" hreflang="jv" data-title="Modhul:Lang" data-language-autonym="Jawa" data-language-local-name="Javanese" class="interlanguage-link-target"><span>Jawa</span></a></li><li class="interlanguage-link interwiki-kbp mw-list-item"><a href="https://kbp.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Kabiye" lang="kbp" hreflang="kbp" data-title="Module:Lang" data-language-autonym="Kabɩyɛ" data-language-local-name="Kabiye" class="interlanguage-link-target"><span>Kabɩyɛ</span></a></li><li class="interlanguage-link interwiki-kn mw-list-item"><a href="https://kn.wikipedia.org/wiki/%E0%B2%AE%E0%B2%BE%E0%B2%A1%E0%B3%8D%E0%B2%AF%E0%B3%82%E0%B2%B2%E0%B3%8D:Lang" title="ಮಾಡ್ಯೂಲ್:Lang – Kannada" lang="kn" hreflang="kn" data-title="ಮಾಡ್ಯೂಲ್:Lang" data-language-autonym="ಕನ್ನಡ" data-language-local-name="Kannada" class="interlanguage-link-target"><span>ಕನ್ನಡ</span></a></li><li class="interlanguage-link interwiki-ka mw-list-item"><a href="https://ka.wikipedia.org/wiki/%E1%83%9B%E1%83%9D%E1%83%93%E1%83%A3%E1%83%9A%E1%83%98:Lang" title="მოდული:Lang – Georgian" lang="ka" hreflang="ka" data-title="მოდული:Lang" data-language-autonym="ქართული" data-language-local-name="Georgian" class="interlanguage-link-target"><span>ქართული</span></a></li><li class="interlanguage-link interwiki-ks mw-list-item"><a href="https://ks.wikipedia.org/wiki/%D9%85%D8%A7%DA%88%DB%8C%D9%88%D9%97%D9%84:Lang" title="ماڈیوٗل:Lang – Kashmiri" lang="ks" hreflang="ks" data-title="ماڈیوٗل:Lang" data-language-autonym="कॉशुर / کٲشُر" data-language-local-name="Kashmiri" class="interlanguage-link-target"><span>कॉशुर / کٲشُر</span></a></li><li class="interlanguage-link interwiki-rn mw-list-item"><a href="https://rn.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Rundi" lang="rn" hreflang="rn" data-title="Module:Lang" data-language-autonym="Ikirundi" data-language-local-name="Rundi" class="interlanguage-link-target"><span>Ikirundi</span></a></li><li class="interlanguage-link interwiki-ku mw-list-item"><a href="https://ku.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Kurdish" lang="ku" hreflang="ku" data-title="Modul:Lang" data-language-autonym="Kurdî" data-language-local-name="Kurdish" class="interlanguage-link-target"><span>Kurdî</span></a></li><li class="interlanguage-link interwiki-lld mw-list-item"><a href="https://lld.wikipedia.org/wiki/Modulo:Lang" title="Modulo:Lang – Ladin" lang="lld" hreflang="lld" data-title="Modulo:Lang" data-language-autonym="Ladin" data-language-local-name="Ladin" class="interlanguage-link-target"><span>Ladin</span></a></li><li class="interlanguage-link interwiki-lad mw-list-item"><a href="https://lad.wikipedia.org/wiki/M%C3%B3dulo:Lang" title="Módulo:Lang – Ladino" lang="lad" hreflang="lad" data-title="Módulo:Lang" data-language-autonym="Ladino" data-language-local-name="Ladino" class="interlanguage-link-target"><span>Ladino</span></a></li><li class="interlanguage-link interwiki-lo mw-list-item"><a href="https://lo.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Lao" lang="lo" hreflang="lo" data-title="Module:Lang" data-language-autonym="ລາວ" data-language-local-name="Lao" class="interlanguage-link-target"><span>ລາວ</span></a></li><li class="interlanguage-link interwiki-la mw-list-item"><a href="https://la.wikipedia.org/wiki/Modulus:Lang" title="Modulus:Lang – Latin" lang="la" hreflang="la" data-title="Modulus:Lang" data-language-autonym="Latina" data-language-local-name="Latin" class="interlanguage-link-target"><span>Latina</span></a></li><li class="interlanguage-link interwiki-lv mw-list-item"><a href="https://lv.wikipedia.org/wiki/Modulis:Lang" title="Modulis:Lang – Latvian" lang="lv" hreflang="lv" data-title="Modulis:Lang" data-language-autonym="Latviešu" data-language-local-name="Latvian" class="interlanguage-link-target"><span>Latviešu</span></a></li><li class="interlanguage-link interwiki-nia mw-list-item"><a href="https://nia.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Nias" lang="nia" hreflang="nia" data-title="Modul:Lang" data-language-autonym="Li Niha" data-language-local-name="Nias" class="interlanguage-link-target"><span>Li Niha</span></a></li><li class="interlanguage-link interwiki-hu mw-list-item"><a href="https://hu.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Hungarian" lang="hu" hreflang="hu" data-title="Modul:Lang" data-language-autonym="Magyar" data-language-local-name="Hungarian" class="interlanguage-link-target"><span>Magyar</span></a></li><li class="interlanguage-link interwiki-mai mw-list-item"><a href="https://mai.wikipedia.org/wiki/%E0%A4%AE%E0%A5%8B%E0%A4%A1%E0%A5%8D%E0%A4%AF%E0%A5%81%E0%A4%B2:Lang" title="मोड्युल:Lang – Maithili" lang="mai" hreflang="mai" data-title="मोड्युल:Lang" data-language-autonym="मैथिली" data-language-local-name="Maithili" class="interlanguage-link-target"><span>मैथिली</span></a></li><li class="interlanguage-link interwiki-mk mw-list-item"><a href="https://mk.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB:Lang" title="Модул:Lang – Macedonian" lang="mk" hreflang="mk" data-title="Модул:Lang" data-language-autonym="Македонски" data-language-local-name="Macedonian" class="interlanguage-link-target"><span>Македонски</span></a></li><li class="interlanguage-link interwiki-ml mw-list-item"><a href="https://ml.wikipedia.org/wiki/%E0%B4%98%E0%B4%9F%E0%B4%95%E0%B4%82:Lang" title="ഘടകം:Lang – Malayalam" lang="ml" hreflang="ml" data-title="ഘടകം:Lang" data-language-autonym="മലയാളം" data-language-local-name="Malayalam" class="interlanguage-link-target"><span>മലയാളം</span></a></li><li class="interlanguage-link interwiki-mt mw-list-item"><a href="https://mt.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Maltese" lang="mt" hreflang="mt" data-title="Module:Lang" data-language-autonym="Malti" data-language-local-name="Maltese" class="interlanguage-link-target"><span>Malti</span></a></li><li class="interlanguage-link interwiki-mi mw-list-item"><a href="https://mi.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Māori" lang="mi" hreflang="mi" data-title="Module:Lang" data-language-autonym="Māori" data-language-local-name="Māori" class="interlanguage-link-target"><span>Māori</span></a></li><li class="interlanguage-link interwiki-mr mw-list-item"><a href="https://mr.wikipedia.org/wiki/%E0%A4%B5%E0%A4%BF%E0%A4%AD%E0%A4%BE%E0%A4%97:Lang" title="विभाग:Lang – Marathi" lang="mr" hreflang="mr" data-title="विभाग:Lang" data-language-autonym="मराठी" data-language-local-name="Marathi" class="interlanguage-link-target"><span>मराठी</span></a></li><li class="interlanguage-link interwiki-xmf mw-list-item"><a href="https://xmf.wikipedia.org/wiki/%E1%83%9B%E1%83%9D%E1%83%93%E1%83%A3%E1%83%9A%E1%83%98:Lang" title="მოდული:Lang – Mingrelian" lang="xmf" hreflang="xmf" data-title="მოდული:Lang" data-language-autonym="მარგალური" data-language-local-name="Mingrelian" class="interlanguage-link-target"><span>მარგალური</span></a></li><li class="interlanguage-link interwiki-arz mw-list-item"><a href="https://arz.wikipedia.org/wiki/%D9%88%D8%AD%D8%AF%D8%A9:Lang" title="وحدة:Lang – Egyptian Arabic" lang="arz" hreflang="arz" data-title="وحدة:Lang" data-language-autonym="مصرى" data-language-local-name="Egyptian Arabic" class="interlanguage-link-target"><span>مصرى</span></a></li><li class="interlanguage-link interwiki-mnw mw-list-item"><a href="https://mnw.wikipedia.org/wiki/%E1%80%99%E1%80%9D%E1%80%BA%E1%80%82%E1%80%BB%E1%80%B0:Lang" title="မဝ်ဂျူ:Lang – Mon" lang="mnw" hreflang="mnw" data-title="မဝ်ဂျူ:Lang" data-language-autonym="ဘာသာမန်" data-language-local-name="Mon" class="interlanguage-link-target"><span>ဘာသာမန်</span></a></li><li class="interlanguage-link interwiki-mzn mw-list-item"><a href="https://mzn.wikipedia.org/wiki/%D9%85%D8%A7%DA%98%D9%88%D9%84:Lang" title="ماژول:Lang – Mazanderani" lang="mzn" hreflang="mzn" data-title="ماژول:Lang" data-language-autonym="مازِرونی" data-language-local-name="Mazanderani" class="interlanguage-link-target"><span>مازِرونی</span></a></li><li class="interlanguage-link interwiki-ms mw-list-item"><a href="https://ms.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Malay" lang="ms" hreflang="ms" data-title="Modul:Lang" data-language-autonym="Bahasa Melayu" data-language-local-name="Malay" class="interlanguage-link-target"><span>Bahasa Melayu</span></a></li><li class="interlanguage-link interwiki-mni mw-list-item"><a href="https://mni.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Manipuri" lang="mni" hreflang="mni" data-title="Module:Lang" data-language-autonym="ꯃꯤꯇꯩ ꯂꯣꯟ" data-language-local-name="Manipuri" class="interlanguage-link-target"><span>ꯃꯤꯇꯩ ꯂꯣꯟ</span></a></li><li class="interlanguage-link interwiki-min mw-list-item"><a href="https://min.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Minangkabau" lang="min" hreflang="min" data-title="Modul:Lang" data-language-autonym="Minangkabau" data-language-local-name="Minangkabau" class="interlanguage-link-target"><span>Minangkabau</span></a></li><li class="interlanguage-link interwiki-cdo mw-list-item"><a href="https://cdo.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Mindong" lang="cdo" hreflang="cdo" data-title="模組:Lang" data-language-autonym="閩東語 / Mìng-dĕ̤ng-ngṳ̄" data-language-local-name="Mindong" class="interlanguage-link-target"><span>閩東語 / Mìng-dĕ̤ng-ngṳ̄</span></a></li><li class="interlanguage-link interwiki-mn mw-list-item"><a href="https://mn.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Mongolian" lang="mn" hreflang="mn" data-title="Module:Lang" data-language-autonym="Монгол" data-language-local-name="Mongolian" class="interlanguage-link-target"><span>Монгол</span></a></li><li class="interlanguage-link interwiki-my mw-list-item"><a href="https://my.wikipedia.org/wiki/%E1%80%99%E1%80%B1%E1%80%AC%E1%80%BA%E1%80%82%E1%80%BB%E1%80%B0%E1%80%B8:Lang" title="မော်ဂျူး:Lang – Burmese" lang="my" hreflang="my" data-title="မော်ဂျူး:Lang" data-language-autonym="မြန်မာဘာသာ" data-language-local-name="Burmese" class="interlanguage-link-target"><span>မြန်မာဘာသာ</span></a></li><li class="interlanguage-link interwiki-pcm mw-list-item"><a href="https://pcm.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Nigerian Pidgin" lang="pcm" hreflang="pcm" data-title="Modul:Lang" data-language-autonym="Naijá" data-language-local-name="Nigerian Pidgin" class="interlanguage-link-target"><span>Naijá</span></a></li><li class="interlanguage-link interwiki-nl mw-list-item"><a href="https://nl.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Dutch" lang="nl" hreflang="nl" data-title="Module:Lang" data-language-autonym="Nederlands" data-language-local-name="Dutch" class="interlanguage-link-target"><span>Nederlands</span></a></li><li class="interlanguage-link interwiki-nds-nl mw-list-item"><a href="https://nds-nl.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Low Saxon" lang="nds-NL" hreflang="nds-NL" data-title="Module:Lang" data-language-autonym="Nedersaksies" data-language-local-name="Low Saxon" class="interlanguage-link-target"><span>Nedersaksies</span></a></li><li class="interlanguage-link interwiki-ne mw-list-item"><a href="https://ne.wikipedia.org/wiki/%E0%A4%AE%E0%A5%8B%E0%A4%A1%E0%A5%8D%E0%A4%AF%E0%A5%81%E0%A4%B2:Lang" title="मोड्युल:Lang – Nepali" lang="ne" hreflang="ne" data-title="मोड्युल:Lang" data-language-autonym="नेपाली" data-language-local-name="Nepali" class="interlanguage-link-target"><span>नेपाली</span></a></li><li class="interlanguage-link interwiki-ja mw-list-item"><a href="https://ja.wikipedia.org/wiki/%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB:Lang" title="モジュール:Lang – Japanese" lang="ja" hreflang="ja" data-title="モジュール:Lang" data-language-autonym="日本語" data-language-local-name="Japanese" class="interlanguage-link-target"><span>日本語</span></a></li><li class="interlanguage-link interwiki-nn mw-list-item"><a href="https://nn.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Norwegian Nynorsk" lang="nn" hreflang="nn" data-title="Modul:Lang" data-language-autonym="Norsk nynorsk" data-language-local-name="Norwegian Nynorsk" class="interlanguage-link-target"><span>Norsk nynorsk</span></a></li><li class="interlanguage-link interwiki-or mw-list-item"><a href="https://or.wikipedia.org/wiki/%E0%AC%AE%E0%AC%A1%E0%AD%8D%E0%AD%9F%E0%AD%81%E0%AC%B2:Lang" title="ମଡ୍ୟୁଲ:Lang – Odia" lang="or" hreflang="or" data-title="ମଡ୍ୟୁଲ:Lang" data-language-autonym="ଓଡ଼ିଆ" data-language-local-name="Odia" class="interlanguage-link-target"><span>ଓଡ଼ିଆ</span></a></li><li class="interlanguage-link interwiki-uz mw-list-item"><a href="https://uz.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Uzbek" lang="uz" hreflang="uz" data-title="Modul:Lang" data-language-autonym="Oʻzbekcha / ўзбекча" data-language-local-name="Uzbek" class="interlanguage-link-target"><span>Oʻzbekcha / ўзбекча</span></a></li><li class="interlanguage-link interwiki-pa mw-list-item"><a href="https://pa.wikipedia.org/wiki/%E0%A8%AE%E0%A9%8C%E0%A8%A1%E0%A8%BF%E0%A8%8A%E0%A8%B2:Lang" title="ਮੌਡਿਊਲ:Lang – Punjabi" lang="pa" hreflang="pa" data-title="ਮੌਡਿਊਲ:Lang" data-language-autonym="ਪੰਜਾਬੀ" data-language-local-name="Punjabi" class="interlanguage-link-target"><span>ਪੰਜਾਬੀ</span></a></li><li class="interlanguage-link interwiki-pnb mw-list-item"><a href="https://pnb.wikipedia.org/wiki/%D9%85%D8%A7%DA%88%DB%8C%D9%88%D9%84:Lang" title="ماڈیول:Lang – Western Punjabi" lang="pnb" hreflang="pnb" data-title="ماڈیول:Lang" data-language-autonym="پنجابی" data-language-local-name="Western Punjabi" class="interlanguage-link-target"><span>پنجابی</span></a></li><li class="interlanguage-link interwiki-blk mw-list-item"><a href="https://blk.wikipedia.org/wiki/%E1%80%99%E1%80%B1%E1%80%AC%E1%80%BA%E1%80%82%E1%80%BB%E1%80%B0%E1%80%B8:Lang" title="မော်ဂျူး:Lang – Pa&#039;O" lang="blk" hreflang="blk" data-title="မော်ဂျူး:Lang" data-language-autonym="ပအိုဝ်ႏဘာႏသာႏ" data-language-local-name="Pa&#039;O" class="interlanguage-link-target"><span>ပအိုဝ်ႏဘာႏသာႏ</span></a></li><li class="interlanguage-link interwiki-ps mw-list-item"><a href="https://ps.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Pashto" lang="ps" hreflang="ps" data-title="Module:Lang" data-language-autonym="پښتو" data-language-local-name="Pashto" class="interlanguage-link-target"><span>پښتو</span></a></li><li class="interlanguage-link interwiki-km mw-list-item"><a href="https://km.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Khmer" lang="km" hreflang="km" data-title="Module:Lang" data-language-autonym="ភាសាខ្មែរ" data-language-local-name="Khmer" class="interlanguage-link-target"><span>ភាសាខ្មែរ</span></a></li><li class="interlanguage-link interwiki-tpi mw-list-item"><a href="https://tpi.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Tok Pisin" lang="tpi" hreflang="tpi" data-title="Module:Lang" data-language-autonym="Tok Pisin" data-language-local-name="Tok Pisin" class="interlanguage-link-target"><span>Tok Pisin</span></a></li><li class="interlanguage-link interwiki-pt mw-list-item"><a href="https://pt.wikipedia.org/wiki/M%C3%B3dulo:Lang" title="Módulo:Lang – Portuguese" lang="pt" hreflang="pt" data-title="Módulo:Lang" data-language-autonym="Português" data-language-local-name="Portuguese" class="interlanguage-link-target"><span>Português</span></a></li><li class="interlanguage-link interwiki-ro mw-list-item"><a href="https://ro.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Romanian" lang="ro" hreflang="ro" data-title="Modul:Lang" data-language-autonym="Română" data-language-local-name="Romanian" class="interlanguage-link-target"><span>Română</span></a></li><li class="interlanguage-link interwiki-szy mw-list-item"><a href="https://szy.wikipedia.org/wiki/bacu-saupu:Lang" title="bacu-saupu:Lang – Sakizaya" lang="szy" hreflang="szy" data-title="bacu-saupu:Lang" data-language-autonym="Sakizaya" data-language-local-name="Sakizaya" class="interlanguage-link-target"><span>Sakizaya</span></a></li><li class="interlanguage-link interwiki-sat mw-list-item"><a href="https://sat.wikipedia.org/wiki/%E1%B1%A2%E1%B1%B3%E1%B1%B0%E1%B1%A9%E1%B1%9E:Lang" title="ᱢᱳᱰᱩᱞ:Lang – Santali" lang="sat" hreflang="sat" data-title="ᱢᱳᱰᱩᱞ:Lang" data-language-autonym="ᱥᱟᱱᱛᱟᱲᱤ" data-language-local-name="Santali" class="interlanguage-link-target"><span>ᱥᱟᱱᱛᱟᱲᱤ</span></a></li><li class="interlanguage-link interwiki-sco mw-list-item"><a href="https://sco.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Scots" lang="sco" hreflang="sco" data-title="Module:Lang" data-language-autonym="Scots" data-language-local-name="Scots" class="interlanguage-link-target"><span>Scots</span></a></li><li class="interlanguage-link interwiki-tn mw-list-item"><a href="https://tn.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Tswana" lang="tn" hreflang="tn" data-title="Module:Lang" data-language-autonym="Setswana" data-language-local-name="Tswana" class="interlanguage-link-target"><span>Setswana</span></a></li><li class="interlanguage-link interwiki-si mw-list-item"><a href="https://si.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Sinhala" lang="si" hreflang="si" data-title="Module:Lang" data-language-autonym="සිංහල" data-language-local-name="Sinhala" class="interlanguage-link-target"><span>සිංහල</span></a></li><li class="interlanguage-link interwiki-simple mw-list-item"><a href="https://simple.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Simple English" lang="en-simple" hreflang="en-simple" data-title="Module:Lang" data-language-autonym="Simple English" data-language-local-name="Simple English" class="interlanguage-link-target"><span>Simple English</span></a></li><li class="interlanguage-link interwiki-sd mw-list-item"><a href="https://sd.wikipedia.org/wiki/%D9%85%D8%A7%DA%8A%D9%8A%D9%88%D9%84:Lang" title="ماڊيول:Lang – Sindhi" lang="sd" hreflang="sd" data-title="ماڊيول:Lang" data-language-autonym="سنڌي" data-language-local-name="Sindhi" class="interlanguage-link-target"><span>سنڌي</span></a></li><li class="interlanguage-link interwiki-ss mw-list-item"><a href="https://ss.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Swati" lang="ss" hreflang="ss" data-title="Module:Lang" data-language-autonym="SiSwati" data-language-local-name="Swati" class="interlanguage-link-target"><span>SiSwati</span></a></li><li class="interlanguage-link interwiki-sl mw-list-item"><a href="https://sl.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Slovenian" lang="sl" hreflang="sl" data-title="Modul:Lang" data-language-autonym="Slovenščina" data-language-local-name="Slovenian" class="interlanguage-link-target"><span>Slovenščina</span></a></li><li class="interlanguage-link interwiki-so mw-list-item"><a href="https://so.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Somali" lang="so" hreflang="so" data-title="Module:Lang" data-language-autonym="Soomaaliga" data-language-local-name="Somali" class="interlanguage-link-target"><span>Soomaaliga</span></a></li><li class="interlanguage-link interwiki-ckb mw-list-item"><a href="https://ckb.wikipedia.org/wiki/%D9%85%DB%86%D8%AF%DB%8C%D9%88%D9%88%D9%84:Lang" title="مۆدیوول:Lang – Central Kurdish" lang="ckb" hreflang="ckb" data-title="مۆدیوول:Lang" data-language-autonym="کوردی" data-language-local-name="Central Kurdish" class="interlanguage-link-target"><span>کوردی</span></a></li><li class="interlanguage-link interwiki-sr mw-list-item"><a href="https://sr.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB:Lang" title="Модул:Lang – Serbian" lang="sr" hreflang="sr" data-title="Модул:Lang" data-language-autonym="Српски / srpski" data-language-local-name="Serbian" class="interlanguage-link-target"><span>Српски / srpski</span></a></li><li class="interlanguage-link interwiki-sh mw-list-item"><a href="https://sh.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Serbo-Croatian" lang="sh" hreflang="sh" data-title="Modul:Lang" data-language-autonym="Srpskohrvatski / српскохрватски" data-language-local-name="Serbo-Croatian" class="interlanguage-link-target"><span>Srpskohrvatski / српскохрватски</span></a></li><li class="interlanguage-link interwiki-su mw-list-item"><a href="https://su.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Sundanese" lang="su" hreflang="su" data-title="Modul:Lang" data-language-autonym="Sunda" data-language-local-name="Sundanese" class="interlanguage-link-target"><span>Sunda</span></a></li><li class="interlanguage-link interwiki-fi mw-list-item"><a href="https://fi.wikipedia.org/wiki/Moduuli:Lang" title="Moduuli:Lang – Finnish" lang="fi" hreflang="fi" data-title="Moduuli:Lang" data-language-autonym="Suomi" data-language-local-name="Finnish" class="interlanguage-link-target"><span>Suomi</span></a></li><li class="interlanguage-link interwiki-sv mw-list-item"><a href="https://sv.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Swedish" lang="sv" hreflang="sv" data-title="Modul:Lang" data-language-autonym="Svenska" data-language-local-name="Swedish" class="interlanguage-link-target"><span>Svenska</span></a></li><li class="interlanguage-link interwiki-tl mw-list-item"><a href="https://tl.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Tagalog" lang="tl" hreflang="tl" data-title="Module:Lang" data-language-autonym="Tagalog" data-language-local-name="Tagalog" class="interlanguage-link-target"><span>Tagalog</span></a></li><li class="interlanguage-link interwiki-ta mw-list-item"><a href="https://ta.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Tamil" lang="ta" hreflang="ta" data-title="Module:Lang" data-language-autonym="தமிழ்" data-language-local-name="Tamil" class="interlanguage-link-target"><span>தமிழ்</span></a></li><li class="interlanguage-link interwiki-kab mw-list-item"><a href="https://kab.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Kabyle" lang="kab" hreflang="kab" data-title="Module:Lang" data-language-autonym="Taqbaylit" data-language-local-name="Kabyle" class="interlanguage-link-target"><span>Taqbaylit</span></a></li><li class="interlanguage-link interwiki-shn mw-list-item"><a href="https://shn.wikipedia.org/wiki/%E1%80%99%E1%80%B1%E1%82%83%E1%82%87%E1%81%B5%E1%80%BB%E1%80%B0%E1%80%B8:Lang" title="မေႃႇၵျူး:Lang – Shan" lang="shn" hreflang="shn" data-title="မေႃႇၵျူး:Lang" data-language-autonym="တႆး" data-language-local-name="Shan" class="interlanguage-link-target"><span>တႆး</span></a></li><li class="interlanguage-link interwiki-te mw-list-item"><a href="https://te.wikipedia.org/wiki/%E0%B0%AE%E0%B0%BE%E0%B0%A1%E0%B1%8D%E0%B0%AF%E0%B1%82%E0%B0%B2%E0%B1%8D:Lang" title="మాడ్యూల్:Lang – Telugu" lang="te" hreflang="te" data-title="మాడ్యూల్:Lang" data-language-autonym="తెలుగు" data-language-local-name="Telugu" class="interlanguage-link-target"><span>తెలుగు</span></a></li><li class="interlanguage-link interwiki-tet mw-list-item"><a href="https://tet.wikipedia.org/wiki/M%C3%B3dulo:Lang" title="Módulo:Lang – Tetum" lang="tet" hreflang="tet" data-title="Módulo:Lang" data-language-autonym="Tetun" data-language-local-name="Tetum" class="interlanguage-link-target"><span>Tetun</span></a></li><li class="interlanguage-link interwiki-th mw-list-item"><a href="https://th.wikipedia.org/wiki/%E0%B8%A1%E0%B8%AD%E0%B8%94%E0%B8%B9%E0%B8%A5:Lang" title="มอดูล:Lang – Thai" lang="th" hreflang="th" data-title="มอดูล:Lang" data-language-autonym="ไทย" data-language-local-name="Thai" class="interlanguage-link-target"><span>ไทย</span></a></li><li class="interlanguage-link interwiki-ti mw-list-item"><a href="https://ti.wikipedia.org/wiki/%E1%88%9E%E1%8B%B5%E1%8B%A9%E1%88%8D:Lang" title="ሞድዩል:Lang – Tigrinya" lang="ti" hreflang="ti" data-title="ሞድዩል:Lang" data-language-autonym="ትግርኛ" data-language-local-name="Tigrinya" class="interlanguage-link-target"><span>ትግርኛ</span></a></li><li class="interlanguage-link interwiki-tcy mw-list-item"><a href="https://tcy.wikipedia.org/wiki/%E0%B2%AE%E0%B3%8B%E0%B2%A1%E0%B3%8D%E0%B2%AF%E0%B3%82%E0%B2%B2%E0%B3%8D:Lang" title="ಮೋಡ್ಯೂಲ್:Lang – Tulu" lang="tcy" hreflang="tcy" data-title="ಮೋಡ್ಯೂಲ್:Lang" data-language-autonym="ತುಳು" data-language-local-name="Tulu" class="interlanguage-link-target"><span>ತುಳು</span></a></li><li class="interlanguage-link interwiki-tr mw-list-item"><a href="https://tr.wikipedia.org/wiki/Mod%C3%BCl:Lisan" title="Modül:Lisan – Turkish" lang="tr" hreflang="tr" data-title="Modül:Lisan" data-language-autonym="Türkçe" data-language-local-name="Turkish" class="interlanguage-link-target"><span>Türkçe</span></a></li><li class="interlanguage-link interwiki-tk mw-list-item"><a href="https://tk.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Turkmen" lang="tk" hreflang="tk" data-title="Module:Lang" data-language-autonym="Türkmençe" data-language-local-name="Turkmen" class="interlanguage-link-target"><span>Türkmençe</span></a></li><li class="interlanguage-link interwiki-kcg mw-list-item"><a href="https://kcg.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Tyap" lang="kcg" hreflang="kcg" data-title="Module:Lang" data-language-autonym="Tyap" data-language-local-name="Tyap" class="interlanguage-link-target"><span>Tyap</span></a></li><li class="interlanguage-link interwiki-uk mw-list-item"><a href="https://uk.wikipedia.org/wiki/%D0%9C%D0%BE%D0%B4%D1%83%D0%BB%D1%8C:Lang" title="Модуль:Lang – Ukrainian" lang="uk" hreflang="uk" data-title="Модуль:Lang" data-language-autonym="Українська" data-language-local-name="Ukrainian" class="interlanguage-link-target"><span>Українська</span></a></li><li class="interlanguage-link interwiki-ur mw-list-item"><a href="https://ur.wikipedia.org/wiki/%D9%85%D8%A7%DA%88%DB%8C%D9%88%D9%84:Lang" title="ماڈیول:Lang – Urdu" lang="ur" hreflang="ur" data-title="ماڈیول:Lang" data-language-autonym="اردو" data-language-local-name="Urdu" class="interlanguage-link-target"><span>اردو</span></a></li><li class="interlanguage-link interwiki-vi mw-list-item"><a href="https://vi.wikipedia.org/wiki/M%C3%B4_%C4%91un:Lang" title="Mô đun:Lang – Vietnamese" lang="vi" hreflang="vi" data-title="Mô đun:Lang" data-language-autonym="Tiếng Việt" data-language-local-name="Vietnamese" class="interlanguage-link-target"><span>Tiếng Việt</span></a></li><li class="interlanguage-link interwiki-zh-classical mw-list-item"><a href="https://zh-classical.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Literary Chinese" lang="lzh" hreflang="lzh" data-title="模組:Lang" data-language-autonym="文言" data-language-local-name="Literary Chinese" class="interlanguage-link-target"><span>文言</span></a></li><li class="interlanguage-link interwiki-war mw-list-item"><a href="https://war.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Waray" lang="war" hreflang="war" data-title="Module:Lang" data-language-autonym="Winaray" data-language-local-name="Waray" class="interlanguage-link-target"><span>Winaray</span></a></li><li class="interlanguage-link interwiki-wuu mw-list-item"><a href="https://wuu.wikipedia.org/wiki/%E6%A8%A1%E5%9D%97:Lang" title="模块:Lang – Wu" lang="wuu" hreflang="wuu" data-title="模块:Lang" data-language-autonym="吴语" data-language-local-name="Wu" class="interlanguage-link-target"><span>吴语</span></a></li><li class="interlanguage-link interwiki-yo mw-list-item"><a href="https://yo.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Yoruba" lang="yo" hreflang="yo" data-title="Module:Lang" data-language-autonym="Yorùbá" data-language-local-name="Yoruba" class="interlanguage-link-target"><span>Yorùbá</span></a></li><li class="interlanguage-link interwiki-zh-yue mw-list-item"><a href="https://zh-yue.wikipedia.org/wiki/%E6%A8%A1%E7%B5%84:Lang" title="模組:Lang – Cantonese" lang="yue" hreflang="yue" data-title="模組:Lang" data-language-autonym="粵語" data-language-local-name="Cantonese" class="interlanguage-link-target"><span>粵語</span></a></li><li class="interlanguage-link interwiki-zh mw-list-item"><a href="https://zh.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Chinese" lang="zh" hreflang="zh" data-title="Module:Lang" data-language-autonym="中文" data-language-local-name="Chinese" class="interlanguage-link-target"><span>中文</span></a></li><li class="interlanguage-link interwiki-iba mw-list-item"><a href="https://iba.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Iban" lang="iba" hreflang="iba" data-title="Modul:Lang" data-language-autonym="Jaku Iban" data-language-local-name="Iban" class="interlanguage-link-target"><span>Jaku Iban</span></a></li><li class="interlanguage-link interwiki-kge mw-list-item"><a href="https://kge.wikipedia.org/wiki/Modul:Lang" title="Modul:Lang – Komering" lang="kge" hreflang="kge" data-title="Modul:Lang" data-language-autonym="Kumoring" data-language-local-name="Komering" class="interlanguage-link-target"><span>Kumoring</span></a></li><li class="interlanguage-link interwiki-tdd mw-list-item"><a href="https://tdd.wikipedia.org/wiki/%E1%A5%9B%E1%A5%A8%E1%A5%9D%E1%A5%B1_%E1%A5%93%E1%A5%A7%E1%A5%B0:Lang" title="ᥛᥨᥝᥱ ᥓᥧᥰ:Lang – Tai Nuea" lang="tdd" hreflang="tdd" data-title="ᥛᥨᥝᥱ ᥓᥧᥰ:Lang" data-language-autonym="ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ" data-language-local-name="Tai Nuea" class="interlanguage-link-target"><span>ᥖᥭᥰ ᥖᥬᥲ ᥑᥨᥒᥰ</span></a></li><li class="interlanguage-link interwiki-zgh mw-list-item"><a href="https://zgh.wikipedia.org/wiki/Module:Lang" title="Module:Lang – Standard Moroccan Tamazight" lang="zgh" hreflang="zgh" data-title="Module:Lang" data-language-autonym="ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ" data-language-local-name="Standard Moroccan Tamazight" class="interlanguage-link-target"><span>ⵜⴰⵎⴰⵣⵉⵖⵜ ⵜⴰⵏⴰⵡⴰⵢⵜ</span></a></li>
			</ul>
			<div class="after-portlet after-portlet-lang"><span class="wb-langlinks-edit wb-langlinks-link"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q42895737#sitelinks-wikipedia" title="Edit interlanguage links" class="wbc-editpage">Edit links</a></span></div>
		</div>

	</div>
</div>
</header>
				<div class="vector-page-toolbar">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-module" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/Module:Lang" title="View the module page [c]" accesskey="c"><span>Module</span></a></li><li id="ca-talk" class="vector-tab-noicon mw-list-item"><a href="/wiki/Module_talk:Lang" rel="discussion" class="mw-redirect" title="Discuss improvements to the content page [t]" accesskey="t"><span>Talk</span></a></li>
		</ul>
		
	</div>
</div>

								
<div id="vector-variants-dropdown" class="vector-dropdown emptyPortlet"  >
	<input type="checkbox" id="vector-variants-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-variants-dropdown" class="vector-dropdown-checkbox " aria-label="Change language variant"   >
	<label id="vector-variants-dropdown-label" for="vector-variants-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">English</span>
	</label>
	<div class="vector-dropdown-content">


					
<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

				
	</div>
</div>

							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views"  >
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="/wiki/Module:Lang"><span>Read</span></a></li><li id="ca-viewsource" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="Page tools">
								
<div id="vector-page-tools-dropdown" class="vector-dropdown vector-page-tools-dropdown"  >
	<input type="checkbox" id="vector-page-tools-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-tools-dropdown" class="vector-dropdown-checkbox "  aria-label="Tools"  >
	<label id="vector-page-tools-dropdown-label" for="vector-page-tools-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"  ><span class="vector-dropdown-label-text">Tools</span>
	</label>
	<div class="vector-dropdown-content">


									<div id="vector-page-tools-unpinned-container" class="vector-unpinned-container">
						
<div id="vector-page-tools" class="vector-page-tools vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-page-tools-pinnable-header vector-pinnable-header-unpinned"
	data-feature-name="page-tools-pinned"
	data-pinnable-element-id="vector-page-tools"
	data-pinned-container-id="vector-page-tools-pinned-container"
	data-unpinned-container-id="vector-page-tools-unpinned-container"
>
	<div class="vector-pinnable-header-label">Tools</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-page-tools.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-page-tools.unpin">hide</button>
</div>

	
<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-has-collapsible-items"  title="More options" >
	<div class="vector-menu-heading">
		Actions
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="/wiki/Module:Lang"><span>Read</span></a></li><li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;action=edit"><span>View source</span></a></li><li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;action=history"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-tb" class="vector-menu mw-portlet mw-portlet-tb"  >
	<div class="vector-menu-heading">
		General
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/Module:Lang" title="List of all English Wikipedia pages containing links to this page [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/Module:Lang" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-upload" class="mw-list-item"><a href="//en.wikipedia.org/wiki/Wikipedia:File_Upload_Wizard" title="Upload files [u]" accesskey="u"><span>Upload file</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;oldid=1271539603" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/w/index.php?title=Module:Lang&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-urlshortener" class="mw-list-item"><a href="/w/index.php?title=Special:UrlShortener&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FModule%3ALang"><span>Get shortened URL</span></a></li><li id="t-urlshortener-qrcode" class="mw-list-item"><a href="/w/index.php?title=Special:QrCode&amp;url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FModule%3ALang"><span>Download QR code</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-electronpdfservice-sidebar-portlet-heading" class="vector-menu mw-portlet mw-portlet-electronpdfservice-sidebar-portlet-heading"  >
	<div class="vector-menu-heading">
		Print/export
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="electron-print_pdf" class="mw-list-item"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=Module%3ALang&amp;action=show-download-screen"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-wikibase-otherprojects" class="vector-menu mw-portlet mw-portlet-wikibase-otherprojects"  >
	<div class="vector-menu-heading">
		In other projects
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li class="wb-otherproject-link wb-otherproject-commons mw-list-item"><a href="https://commons.wikimedia.org/wiki/Module:Lang" hreflang="en"><span>Wikimedia Commons</span></a></li><li class="wb-otherproject-link wb-otherproject-outreach mw-list-item"><a href="https://outreach.wikimedia.org/wiki/Module:Lang" hreflang="en"><span>Wikimedia Outreach</span></a></li><li class="wb-otherproject-link wb-otherproject-wikibooks mw-list-item"><a href="https://en.wikibooks.org/wiki/Module:Lang" hreflang="en"><span>Wikibooks</span></a></li><li class="wb-otherproject-link wb-otherproject-wikiquote mw-list-item"><a href="https://en.wikiquote.org/wiki/Module:Lang" hreflang="en"><span>Wikiquote</span></a></li><li class="wb-otherproject-link wb-otherproject-wikiversity mw-list-item"><a href="https://en.wikiversity.org/wiki/Module:Lang" hreflang="en"><span>Wikiversity</span></a></li><li id="t-wikibase" class="wb-otherproject-link wb-otherproject-wikibase-dataitem mw-list-item"><a href="https://www.wikidata.org/wiki/Special:EntityPage/Q42895737" title="Structured data on this page hosted by Wikidata [g]" accesskey="g"><span>Wikidata item</span></a></li>
		</ul>
		
	</div>
</div>

</div>

									</div>
				
	</div>
</div>

							</nav>
						</div>
					</div>
				</div>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div
	class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned"
	data-feature-name="appearance-pinned"
	data-pinnable-element-id="vector-appearance"
	data-pinned-container-id="vector-appearance-pinned-container"
	data-unpinned-container-id="vector-appearance-unpinned-container"
>
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		<div id="mw-indicator-pp-default" class="mw-indicator"><div class="mw-parser-output"><span typeof="mw:File"><a href="/wiki/Wikipedia:Protection_policy#template" title="This high-risk module is permanently template-protected to prevent vandalism"><img alt="Permanently protected module" src="//upload.wikimedia.org/wikipedia/en/thumb/5/53/Template-protection-shackle.svg/20px-Template-protection-shackle.svg.png" decoding="async" width="20" height="20" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/en/thumb/5/53/Template-protection-shackle.svg/30px-Template-protection-shackle.svg.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/5/53/Template-protection-shackle.svg/40px-Template-protection-shackle.svg.png 2x" data-file-width="512" data-file-height="512" /></a></span></div></div>
		</div>

						<div id="siteSub" class="noprint">From Wikipedia, the free encyclopedia</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><style data-mw-deduplicate="TemplateStyles:r1277038544">.mw-parser-output .documentation,.mw-parser-output .documentation-metadata{border:1px solid var(--border-color-base,#a2a9b1);background-color:#ecfcf4;clear:both}.mw-parser-output .documentation{margin:1em 0 0 0;padding:1em}.mw-parser-output .documentation-metadata{margin:0.2em 0;font-style:italic;padding:0.4em 1em}.mw-parser-output .documentation-startbox{padding-bottom:3px;border-bottom:1px solid var(--border-color-base,#a2a9b1);margin-bottom:1ex}.mw-parser-output .documentation-heading{font-weight:bold;font-size:125%}.mw-parser-output .documentation-clear{clear:both}.mw-parser-output .documentation-toolbar{font-style:normal;font-size:85%}@media screen{html.skin-theme-clientpref-night .mw-parser-output .documentation,html.skin-theme-clientpref-night .mw-parser-output .documentation-metadata{background-color:#0b1e1c}}@media screen and (prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .documentation,html.skin-theme-clientpref-os .mw-parser-output .documentation-metadata{background-color:#0b1e1c}}</style><div class="documentation-container" role="complementary" aria-labelledby="documentation-heading">
<div class="documentation">
<div class="documentation-startbox">
<span class="documentation-heading" id="documentation-heading"><span typeof="mw:File"><span><img alt="" src="//upload.wikimedia.org/wikipedia/commons/thumb/4/43/Test_Template_Info-Icon_-_Version_%282%29.svg/60px-Test_Template_Info-Icon_-_Version_%282%29.svg.png" decoding="async" width="50" height="22" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/4/43/Test_Template_Info-Icon_-_Version_%282%29.svg/120px-Test_Template_Info-Icon_-_Version_%282%29.svg.png 1.5x" data-file-width="1792" data-file-height="800" /></span></span> Module documentation</span><span class="mw-editsection-like plainlinks">&#91;<a href="/wiki/Module:Lang/doc" title="Module:Lang/doc">view</a>&#93; &#91;<a href="/wiki/Special:EditPage/Module:Lang/doc" title="Special:EditPage/Module:Lang/doc">edit</a>&#93; &#91;<a href="/wiki/Special:PageHistory/Module:Lang/doc" title="Special:PageHistory/Module:Lang/doc">history</a>&#93; &#91;<a href="/wiki/Special:Purge/Module:Lang" title="Special:Purge/Module:Lang">purge</a>&#93;</span></div>
<style data-mw-deduplicate="TemplateStyles:r1238436933">.mw-parser-output .ombox{margin:4px 0;border-collapse:collapse;border:1px solid #a2a9b1;background-color:var(--background-color-neutral-subtle,#f8f9fa);box-sizing:border-box;color:var(--color-base,#202122)}.mw-parser-output .ombox.mbox-small{font-size:88%;line-height:1.25em}.mw-parser-output .ombox-speedy{border:2px solid #b32424;background-color:#fee7e6}.mw-parser-output .ombox-delete{border:2px solid #b32424}.mw-parser-output .ombox-content{border:1px solid #f28500}.mw-parser-output .ombox-style{border:1px solid #fc3}.mw-parser-output .ombox-move{border:1px solid #9932cc}.mw-parser-output .ombox-protection{border:2px solid #a2a9b1}.mw-parser-output .ombox .mbox-text{border:none;padding:0.25em 0.9em;width:100%}.mw-parser-output .ombox .mbox-image{border:none;padding:2px 0 2px 0.9em;text-align:center}.mw-parser-output .ombox .mbox-imageright{border:none;padding:2px 0.9em 2px 0;text-align:center}.mw-parser-output .ombox .mbox-empty-cell{border:none;padding:0;width:1px}.mw-parser-output .ombox .mbox-invalid-type{text-align:center}@media(min-width:720px){.mw-parser-output .ombox{margin:4px 10%}.mw-parser-output .ombox.mbox-small{clear:right;float:right;margin:4px 0 4px 1em;width:238px}}body.skin--responsive .mw-parser-output table.ombox img{max-width:none!important}@media screen{html.skin-theme-clientpref-night .mw-parser-output .ombox-speedy{background-color:#310402}}@media screen and (prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .ombox-speedy{background-color:#310402}}</style><table class="plainlinks ombox ombox-content" role="presentation"><tbody><tr><td class="mbox-image"><span typeof="mw:File"><span><img alt="Warning" src="//upload.wikimedia.org/wikipedia/en/thumb/5/5f/Ambox_warning_orange.svg/40px-Ambox_warning_orange.svg.png" decoding="async" width="40" height="34" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/en/thumb/5/5f/Ambox_warning_orange.svg/60px-Ambox_warning_orange.svg.png 1.5x, //upload.wikimedia.org/wikipedia/en/thumb/5/5f/Ambox_warning_orange.svg/120px-Ambox_warning_orange.svg.png 2x" data-file-width="378" data-file-height="326" /></span></span></td><td class="mbox-text"><b>This Lua module is used on <a class="external text" href="https://linkcount.toolforge.org/?project=en.wikipedia.org&amp;page=Module%3ALang#transclusions">approximately&#x20;1,600,000 pages</a></b>.<br /> To avoid major disruption and server load, any changes should be tested in the module's <a href="/wiki/Module:Lang/sandbox" title="Module:Lang/sandbox">/sandbox</a> or <a href="/wiki/Module:Lang/testcases" title="Module:Lang/testcases">/testcases</a> subpages, or in your own <a href="/wiki/Module:Sandbox" title="Module:Sandbox">module sandbox</a>. The tested changes can be added to this page in a single edit. Consider discussing changes on the <a href="/wiki/Module_talk:Lang" class="mw-redirect" title="Module talk:Lang">talk page</a> before implementing them.</td></tr></tbody></table>
<style data-mw-deduplicate="TemplateStyles:r1129693374">.mw-parser-output .hlist dl,.mw-parser-output .hlist ol,.mw-parser-output .hlist ul{margin:0;padding:0}.mw-parser-output .hlist dd,.mw-parser-output .hlist dt,.mw-parser-output .hlist li{margin:0;display:inline}.mw-parser-output .hlist.inline,.mw-parser-output .hlist.inline dl,.mw-parser-output .hlist.inline ol,.mw-parser-output .hlist.inline ul,.mw-parser-output .hlist dl dl,.mw-parser-output .hlist dl ol,.mw-parser-output .hlist dl ul,.mw-parser-output .hlist ol dl,.mw-parser-output .hlist ol ol,.mw-parser-output .hlist ol ul,.mw-parser-output .hlist ul dl,.mw-parser-output .hlist ul ol,.mw-parser-output .hlist ul ul{display:inline}.mw-parser-output .hlist .mw-empty-li{display:none}.mw-parser-output .hlist dt::after{content:": "}.mw-parser-output .hlist dd::after,.mw-parser-output .hlist li::after{content:" · ";font-weight:bold}.mw-parser-output .hlist dd:last-child::after,.mw-parser-output .hlist dt:last-child::after,.mw-parser-output .hlist li:last-child::after{content:none}.mw-parser-output .hlist dd dd:first-child::before,.mw-parser-output .hlist dd dt:first-child::before,.mw-parser-output .hlist dd li:first-child::before,.mw-parser-output .hlist dt dd:first-child::before,.mw-parser-output .hlist dt dt:first-child::before,.mw-parser-output .hlist dt li:first-child::before,.mw-parser-output .hlist li dd:first-child::before,.mw-parser-output .hlist li dt:first-child::before,.mw-parser-output .hlist li li:first-child::before{content:" (";font-weight:normal}.mw-parser-output .hlist dd dd:last-child::after,.mw-parser-output .hlist dd dt:last-child::after,.mw-parser-output .hlist dd li:last-child::after,.mw-parser-output .hlist dt dd:last-child::after,.mw-parser-output .hlist dt dt:last-child::after,.mw-parser-output .hlist dt li:last-child::after,.mw-parser-output .hlist li dd:last-child::after,.mw-parser-output .hlist li dt:last-child::after,.mw-parser-output .hlist li li:last-child::after{content:")";font-weight:normal}.mw-parser-output .hlist ol{counter-reset:listitem}.mw-parser-output .hlist ol>li{counter-increment:listitem}.mw-parser-output .hlist ol>li::before{content:" "counter(listitem)"\a0 "}.mw-parser-output .hlist dd ol>li:first-child::before,.mw-parser-output .hlist dt ol>li:first-child::before,.mw-parser-output .hlist li ol>li:first-child::before{content:" ("counter(listitem)"\a0 "}</style><style data-mw-deduplicate="TemplateStyles:r1126788409">.mw-parser-output .plainlist ol,.mw-parser-output .plainlist ul{line-height:inherit;list-style:none;margin:0;padding:0}.mw-parser-output .plainlist ol li,.mw-parser-output .plainlist ul li{margin-bottom:0}</style><style data-mw-deduplicate="TemplateStyles:r1246091330">.mw-parser-output .sidebar{width:22em;float:right;clear:right;margin:0.5em 0 1em 1em;background:var(--background-color-neutral-subtle,#f8f9fa);border:1px solid var(--border-color-base,#a2a9b1);padding:0.2em;text-align:center;line-height:1.4em;font-size:88%;border-collapse:collapse;display:table}body.skin-minerva .mw-parser-output .sidebar{display:table!important;float:right!important;margin:0.5em 0 1em 1em!important}.mw-parser-output .sidebar-subgroup{width:100%;margin:0;border-spacing:0}.mw-parser-output .sidebar-left{float:left;clear:left;margin:0.5em 1em 1em 0}.mw-parser-output .sidebar-none{float:none;clear:both;margin:0.5em 1em 1em 0}.mw-parser-output .sidebar-outer-title{padding:0 0.4em 0.2em;font-size:125%;line-height:1.2em;font-weight:bold}.mw-parser-output .sidebar-top-image{padding:0.4em}.mw-parser-output .sidebar-top-caption,.mw-parser-output .sidebar-pretitle-with-top-image,.mw-parser-output .sidebar-caption{padding:0.2em 0.4em 0;line-height:1.2em}.mw-parser-output .sidebar-pretitle{padding:0.4em 0.4em 0;line-height:1.2em}.mw-parser-output .sidebar-title,.mw-parser-output .sidebar-title-with-pretitle{padding:0.2em 0.8em;font-size:145%;line-height:1.2em}.mw-parser-output .sidebar-title-with-pretitle{padding:0.1em 0.4em}.mw-parser-output .sidebar-image{padding:0.2em 0.4em 0.4em}.mw-parser-output .sidebar-heading{padding:0.1em 0.4em}.mw-parser-output .sidebar-content{padding:0 0.5em 0.4em}.mw-parser-output .sidebar-content-with-subgroup{padding:0.1em 0.4em 0.2em}.mw-parser-output .sidebar-above,.mw-parser-output .sidebar-below{padding:0.3em 0.8em;font-weight:bold}.mw-parser-output .sidebar-collapse .sidebar-above,.mw-parser-output .sidebar-collapse .sidebar-below{border-top:1px solid #aaa;border-bottom:1px solid #aaa}.mw-parser-output .sidebar-navbar{text-align:right;font-size:115%;padding:0 0.4em 0.4em}.mw-parser-output .sidebar-list-title{padding:0 0.4em;text-align:left;font-weight:bold;line-height:1.6em;font-size:105%}.mw-parser-output .sidebar-list-title-c{padding:0 0.4em;text-align:center;margin:0 3.3em}@media(max-width:640px){body.mediawiki .mw-parser-output .sidebar{width:100%!important;clear:both;float:none!important;margin-left:0!important;margin-right:0!important}}body.skin--responsive .mw-parser-output .sidebar a>img{max-width:none!important}@media screen{html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-list-title,html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle{background:transparent!important}html.skin-theme-clientpref-night .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle a{color:var(--color-progressive)!important}}@media screen and (prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-list-title,html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle{background:transparent!important}html.skin-theme-clientpref-os .mw-parser-output .sidebar:not(.notheme) .sidebar-title-with-pretitle a{color:var(--color-progressive)!important}}@media print{body.ns-0 .mw-parser-output .sidebar{display:none!important}}</style><style data-mw-deduplicate="TemplateStyles:r1271169024">.mw-parser-output .language-templates{width:238px;border-spacing:0;border:1px #abd5f5 solid;color:var(--color-base,#000);padding:2px}.mw-parser-output .language-templates .sidebar-title{background:#d0e5f5;color:#000}.mw-parser-output .language-templates .sidebar-heading{background:#f1f5fc;color:#000}.mw-parser-output .language-templates .sidebar-content{padding:0.25em}.mw-parser-output .language-templates .sidebar-navbar{padding:0 5px}</style><table class="sidebar nomobile nowraplinks language-templates"><tbody><tr><th class="sidebar-title">Language templates</th></tr><tr><th class="sidebar-heading">
Language names (<a href="/wiki/ISO_639" title="ISO 639">ISO 639</a>)</th></tr><tr><td class="sidebar-content plainlist">
<ul><li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:ISO_639_name" title="Template:ISO 639 name">ISO 639 name</a><span class="nowrap">&#125;&#125;</span></li></ul></td>
</tr><tr><th class="sidebar-heading">
Interwiki links</th></tr><tr><td class="sidebar-content plainlist">
<ul><li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Wikt-lang" title="Template:Wikt-lang">Wikt-lang</a><span class="nowrap">&#125;&#125;</span></li>
<li><a href="/wiki/Module:Wikt-lang" title="Module:Wikt-lang">Module:Wikt-lang</a></li>
<li><a href="/wiki/Module:Wikt-lang/data" title="Module:Wikt-lang/data">Module:Wikt-lang/data</a></li>
<li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Interlanguage_link" title="Template:Interlanguage link">Interlanguage link</a><span class="nowrap">&#125;&#125;</span></li></ul></td>
</tr><tr><th class="sidebar-heading">
Foreign-language text</th></tr><tr><td class="sidebar-content plainlist">
<ul><li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Lang" title="Template:Lang">Lang</a><span class="nowrap">&#125;&#125;</span></li>
<li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Langx" title="Template:Langx">Langx</a><span class="nowrap">&#125;&#125;</span></li>
<li><a class="mw-selflink selflink">Module:Lang</a></li>
<li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Transliteration" title="Template:Transliteration">Transliteration</a><span class="nowrap">&#125;&#125;</span></li>
<li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:Title_language" title="Template:Title language">Title language</a><span class="nowrap">&#125;&#125;</span></li></ul></td>
</tr><tr><th class="sidebar-heading">
Other</th></tr><tr><td class="sidebar-content plainlist">
<ul><li><span class="nowrap">&#123;&#123;</span><a href="/wiki/Template:IPA" title="Template:IPA">IPA</a><span class="nowrap">&#125;&#125;</span></li></ul></td>
</tr><tr><td class="sidebar-navbar"><link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1129693374" /><style data-mw-deduplicate="TemplateStyles:r1239400231">.mw-parser-output .navbar{display:inline;font-size:88%;font-weight:normal}.mw-parser-output .navbar-collapse{float:left;text-align:left}.mw-parser-output .navbar-boxtext{word-spacing:0}.mw-parser-output .navbar ul{display:inline-block;white-space:nowrap;line-height:inherit}.mw-parser-output .navbar-brackets::before{margin-right:-0.125em;content:"[ "}.mw-parser-output .navbar-brackets::after{margin-left:-0.125em;content:" ]"}.mw-parser-output .navbar li{word-spacing:-0.125em}.mw-parser-output .navbar a>span,.mw-parser-output .navbar a>abbr{text-decoration:inherit}.mw-parser-output .navbar-mini abbr{font-variant:small-caps;border-bottom:none;text-decoration:none;cursor:inherit}.mw-parser-output .navbar-ct-full{font-size:114%;margin:0 7em}.mw-parser-output .navbar-ct-mini{font-size:114%;margin:0 4em}html.skin-theme-clientpref-night .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}@media(prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}}@media print{.mw-parser-output .navbar{display:none!important}}</style><div class="navbar plainlinks hlist navbar-mini"><ul><li class="nv-view"><a href="/wiki/Template:Language_templates" title="Template:Language templates"><abbr title="View this template">v</abbr></a></li><li class="nv-talk"><a href="/w/index.php?title=Template_talk:Language_templates&amp;action=edit&amp;redlink=1" class="new" title="Template talk:Language templates (page does not exist)"><abbr title="Discuss this template">t</abbr></a></li><li class="nv-edit"><a href="/wiki/Special:EditPage/Template:Language_templates" title="Special:EditPage/Template:Language templates"><abbr title="Edit this template">e</abbr></a></li></ul></div></td></tr></tbody></table>
<link rel="mw-deduplicated-inline-style" href="mw-data:TemplateStyles:r1238436933" /><table class="plainlinks ombox mbox-small ombox-notice" role="presentation"><tbody><tr><td class="mbox-image"><span typeof="mw:File"><span><img alt="" src="//upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Lua-Logo.svg/30px-Lua-Logo.svg.png" decoding="async" width="30" height="30" class="mw-file-element" srcset="//upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Lua-Logo.svg/45px-Lua-Logo.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Lua-Logo.svg/60px-Lua-Logo.svg.png 2x" data-file-width="947" data-file-height="947" /></span></span></td><td class="mbox-text">This module depends on the following other modules:<div><ul><li><a href="/wiki/Module:Arguments" title="Module:Arguments">Module:Arguments</a> (<a href="/wiki/Module:Arguments/sandbox" title="Module:Arguments/sandbox">sandbox</a>)</li><li><a href="/wiki/Module:Lang/configuration" title="Module:Lang/configuration">Module:Lang/configuration</a> (<a href="/wiki/Module:Lang/configuration/sandbox" title="Module:Lang/configuration/sandbox">sandbox</a>)</li><li><a href="/wiki/Module:Lang/data" title="Module:Lang/data">Module:Lang/data</a> (<a href="/wiki/Module:Lang/data/sandbox" title="Module:Lang/data/sandbox">sandbox</a>)</li><li><a href="/wiki/Module:Lang/ISO_639_synonyms" title="Module:Lang/ISO 639 synonyms">Module:Lang/ISO 639 synonyms</a></li><li><a href="/wiki/Module:Lang/tag_from_name" title="Module:Lang/tag from name">Module:Lang/tag from name</a> (<a href="/wiki/Module:Lang/tag_from_name/sandbox" title="Module:Lang/tag from name/sandbox">sandbox</a>)</li><li><a href="/wiki/Module:Unicode_data" title="Module:Unicode data">Module:Unicode data</a> (<a href="/wiki/Module:Unicode_data/sandbox" title="Module:Unicode data/sandbox">sandbox</a>)</li><li><a href="/wiki/Module:Yesno" title="Module:Yesno">Module:Yesno</a> (<a href="/wiki/Module:Yesno/sandbox" title="Module:Yesno/sandbox">sandbox</a>)</li></ul></div></td></tr></tbody></table>
<p>This module exists primarily to provide correct html markup for non–English language text where that text is used in the English Wikipedia. It has a secondary purpose of providing correct visual rendering for this non-English text. The module was developed to consolidate processing for <code>&#123;&#123;<a href="/wiki/Template:Lang" title="Template:Lang">Lang</a>&#125;&#125;</code>, <code>&#123;&#123;<a href="/wiki/Template:Langx" title="Template:Langx">Langx</a>&#125;&#125;</code>, and <code>&#123;&#123;<a href="/wiki/Template:Transliteration" title="Template:Transliteration">Transliteration</a>&#125;&#125;</code> templates into a single source and to use a clearly defined data set extracted from international standards. It provides error checking and reporting to ensure that the html rendered is correct for browsers and screen readers.
</p><p>Other templates that get language name support from this module are:
</p>
<ul><li><code>&#123;&#123;<a href="/wiki/Template:Native_name" title="Template:Native name">Native name</a>&#125;&#125;</code></li></ul>
<meta property="mw:PageProp/toc" />
<div class="mw-heading mw-heading2"><h2 id="Data_set">Data set</h2></div>
<p>The data set is specified in <a href="/wiki/Module:Lang/data" title="Module:Lang/data">Module:Lang/data</a> and its included data modules:
</p>
<ul><li>language tag-and-name data
<ul><li><a href="/wiki/Module:Lang/data/iana_languages" title="Module:Lang/data/iana languages">Module:Lang/data/iana languages</a> – from IANA <a rel="nofollow" class="external text" href="https://www.iana.org/assignments/language-subtag-registry/language-subtag-registry">language-subtag-registry file</a></li></ul></li>
<li>language script data
<ul><li><a href="/wiki/Module:Lang/data/iana_scripts" title="Module:Lang/data/iana scripts">Module:Lang/data/iana scripts</a> – from IANA language-subtag-registry file</li></ul></li>
<li>language region data
<ul><li><a href="/wiki/Module:Lang/data/iana_regions" title="Module:Lang/data/iana regions">Module:Lang/data/iana regions</a> – from IANA language-subtag-registry file</li></ul></li>
<li>language variant data
<ul><li><a href="/wiki/Module:Lang/data/iana_variants" title="Module:Lang/data/iana variants">Module:Lang/data/iana variants</a> – from IANA language-subtag-registry file</li></ul></li>
<li>suppressed-script data
<ul><li><a href="/wiki/Module:Lang/data/iana_suppressed_scripts" title="Module:Lang/data/iana suppressed scripts">Module:Lang/data/iana suppressed scripts</a> – from IANA language-subtag-registry file</li></ul></li></ul>
<p>The data set also includes supplementary data modules:
</p>
<ul><li>override and other non-standard data
<ul><li><a href="/wiki/Module:Lang/ISO_639_synonyms" title="Module:Lang/ISO 639 synonyms">Module:Lang/ISO 639 synonyms</a> – maps three character ISO 639-2, -2T, -3 codes to two character ISO 639-1 codes – from <a rel="nofollow" class="external text" href="https://www.loc.gov/standards/iso639-2/php/English_list.php">Codes for the Representation of Names of Languages</a></li>
<li><a href="/wiki/Module:Lang/tag_from_name" title="Module:Lang/tag from name">Module:Lang/tag from name</a> – reversed language tag-and-name data so that the language name is the key and the language tag is the value</li></ul></li></ul>
<div class="mw-heading mw-heading2"><h2 id="Testcases">Testcases</h2></div>
<ul><li><a href="/wiki/Module:Lang/testcases" title="Module:Lang/testcases">Module:Lang/testcases</a> (<a href="/wiki/Module_talk:Lang/testcases" title="Module talk:Lang/testcases">run</a>)</li>
<li>category_from_tag()
<ul><li><a href="/wiki/Module:Lang/testcases/ISO_639-1_category_from_tag" title="Module:Lang/testcases/ISO 639-1 category from tag">Module:Lang/testcases/ISO 639-1 category from tag</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-1_category_from_tag" title="Module talk:Lang/testcases/ISO 639-1 category from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-1_category_from_tag" title="Module:Lang/testcases/ISO 639-3-1 category from tag">Module:Lang/testcases/ISO 639-3-1 category from tag</a> (A–H) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-1_category_from_tag" title="Module talk:Lang/testcases/ISO 639-3-1 category from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-2_category_from_tag" title="Module:Lang/testcases/ISO 639-3-2 category from tag">Module:Lang/testcases/ISO 639-3-2 category from tag</a> (I–N) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-2_category_from_tag" title="Module talk:Lang/testcases/ISO 639-3-2 category from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-3_category_from_tag" title="Module:Lang/testcases/ISO 639-3-3 category from tag">Module:Lang/testcases/ISO 639-3-3 category from tag</a> (O–Z) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-3_category_from_tag" title="Module talk:Lang/testcases/ISO 639-3-3 category from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639_deprecated_and_override_category_from_tag" title="Module:Lang/testcases/ISO 639 deprecated and override category from tag">Module:Lang/testcases/ISO 639 deprecated and override category from tag</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639_deprecated_and_override_category_from_tag" title="Module talk:Lang/testcases/ISO 639 deprecated and override category from tag">run</a>)</li></ul></li>
<li>name_from_tag()
<ul><li><a href="/wiki/Module:Lang/testcases/ISO_639-1_name_from_tag" title="Module:Lang/testcases/ISO 639-1 name from tag">Module:Lang/testcases/ISO 639-1 name from tag</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-1_name_from_tag" title="Module talk:Lang/testcases/ISO 639-1 name from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-1_name_from_tag" title="Module:Lang/testcases/ISO 639-3-1 name from tag">Module:Lang/testcases/ISO 639-3-1 name from tag</a> (A–H) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-1_name_from_tag" title="Module talk:Lang/testcases/ISO 639-3-1 name from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-2_name_from_tag" title="Module:Lang/testcases/ISO 639-3-2 name from tag">Module:Lang/testcases/ISO 639-3-2 name from tag</a> (I–N) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-2_name_from_tag" title="Module talk:Lang/testcases/ISO 639-3-2 name from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-3_name_from_tag" title="Module:Lang/testcases/ISO 639-3-3 name from tag">Module:Lang/testcases/ISO 639-3-3 name from tag</a> (O–Z) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-3_name_from_tag" title="Module talk:Lang/testcases/ISO 639-3-3 name from tag">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639_deprecated_and_override_name_from_tag" title="Module:Lang/testcases/ISO 639 deprecated and override name from tag">Module:Lang/testcases/ISO 639 deprecated and override name from tag</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639_deprecated_and_override_name_from_tag" title="Module talk:Lang/testcases/ISO 639 deprecated and override name from tag">run</a>)</li></ul></li>
<li>tag_from_name()
<ul><li><a href="/wiki/Module:Lang/testcases/ISO_639-1_tag_from_name" title="Module:Lang/testcases/ISO 639-1 tag from name">Module:Lang/testcases/ISO 639-1 tag from name</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-1_tag_from_name" title="Module talk:Lang/testcases/ISO 639-1 tag from name">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-1_tag_from_name" title="Module:Lang/testcases/ISO 639-3-1 tag from name">Module:Lang/testcases/ISO 639-3-1 tag from name</a> (A–H) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-1_tag_from_name" title="Module talk:Lang/testcases/ISO 639-3-1 tag from name">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-2_tag_from_name" title="Module:Lang/testcases/ISO 639-3-2 tag from name">Module:Lang/testcases/ISO 639-3-2 tag from name</a> (I–N) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-2_tag_from_name" title="Module talk:Lang/testcases/ISO 639-3-2 tag from name">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639-3-3_tag_from_name" title="Module:Lang/testcases/ISO 639-3-3 tag from name">Module:Lang/testcases/ISO 639-3-3 tag from name</a> (O–Z) (<a href="/wiki/Module_talk:Lang/testcases/ISO_639-3-3_tag_from_name" title="Module talk:Lang/testcases/ISO 639-3-3 tag from name">run</a>)</li>
<li><a href="/wiki/Module:Lang/testcases/ISO_639_deprecated_and_override_tag_from_name" title="Module:Lang/testcases/ISO 639 deprecated and override tag from name">Module:Lang/testcases/ISO 639 deprecated and override tag from name</a> (<a href="/wiki/Module_talk:Lang/testcases/ISO_639_deprecated_and_override_tag_from_name" title="Module talk:Lang/testcases/ISO 639 deprecated and override tag from name">run</a>)</li></ul></li></ul>
<div class="mw-heading mw-heading2"><h2 id="Tracking_categories">Tracking categories</h2></div>
<ul><li><a href="/wiki/Category:Lang_and_lang-xx_template_errors" title="Category:Lang and lang-xx template errors">Category:Lang and lang-xx template errors</a>&#160;(78)</li>
<li><a href="/wiki/Category:Transliteration_template_errors" title="Category:Transliteration template errors">Category:Transliteration template errors</a>&#160;(39)</li>
<li><a href="/wiki/Category:Lang_and_lang-xx_code_promoted_to_ISO_639-1" title="Category:Lang and lang-xx code promoted to ISO 639-1">Category:Lang and lang-xx code promoted to ISO 639-1</a>&#160;(31)</li>
<li><a href="/wiki/Category:Lang_and_lang-xx_using_deprecated_ISO_639_codes" title="Category:Lang and lang-xx using deprecated ISO 639 codes">Category:Lang and lang-xx using deprecated ISO 639 codes</a>&#160;(0)</li></ul>
<div class="mw-heading mw-heading2"><h2 id="See_also">See also</h2></div>
<p>MoS on foreign words:
</p>
<ul><li><a href="/wiki/Wikipedia:Manual_of_Style/Text_formatting#Foreign_terms" title="Wikipedia:Manual of Style/Text formatting">Wikipedia:Manual of Style/Text formatting §&#160;Foreign terms</a></li></ul>
<div class="documentation-clear"></div>
</div>
<div role="note" class="documentation-metadata plainlinks">The above <a href="/wiki/Wikipedia:Template_documentation" title="Wikipedia:Template documentation">documentation</a> is <a href="/wiki/Help:Transclusion" title="Help:Transclusion">transcluded</a> from <a href="/wiki/Module:Lang/doc" title="Module:Lang/doc">Module:Lang/doc</a>. <span class="documentation-toolbar">(<a href="/wiki/Special:EditPage/Module:Lang/doc" title="Special:EditPage/Module:Lang/doc">edit</a> &#124; <a href="/wiki/Special:PageHistory/Module:Lang/doc" title="Special:PageHistory/Module:Lang/doc">history</a>)</span><br />Editors can experiment in this module's <a href="/wiki/Module:Lang/sandbox" title="Module:Lang/sandbox">sandbox</a> <span class="documentation-toolbar">(<a href="/wiki/Special:EditPage/Module:Lang/sandbox" title="Special:EditPage/Module:Lang/sandbox">edit</a> &#124; <a class="external text" href="https://en.wikipedia.org/w/index.php?title=Special%3AComparePages&amp;page1=Module%3ALang&amp;page2=Module%3ALang%2Fsandbox">diff</a>)</span> and <a href="/wiki/Module:Lang/testcases" title="Module:Lang/testcases">testcases</a> <span class="documentation-toolbar">(<a href="/wiki/Special:EditPage/Module:Lang/testcases" title="Special:EditPage/Module:Lang/testcases">edit</a> &#124; <a href="/wiki/Module_talk:Lang/testcases" title="Module talk:Lang/testcases">run</a>)</span> pages.<br /> <a href="/wiki/Special:PrefixIndex/Module:Lang/" title="Special:PrefixIndex/Module:Lang/">Subpages of this module</a>.</div></div>
<p><span id="code"></span>
</p><div class="mw-highlight mw-highlight-lang-lua mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos" data-line="1"></span></a><span class="cm">--[=[</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos" data-line="2"></span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos" data-line="3"></span></a><span class="cm">Lua support for the {{lang}}, {{langx}}, {{lang-??}}, and {{transliteration}} templates and replacement of various supporting templates. </span>
</span><span id="L-4"><a href="#L-4"><span class="linenos" data-line="4"></span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos" data-line="5"></span></a><span class="cm">]=]</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos" data-line="6"></span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos" data-line="7"></span></a><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;strict&#39;</span><span class="p">);</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos" data-line="8"></span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos" data-line="9"></span></a><span class="kd">local</span> <span class="n">getArgs</span> <span class="o">=</span> <span class="nb">require</span> <span class="p">(</span><span class="s1">&#39;Module:Arguments&#39;</span><span class="p">).</span><span class="n">getArgs</span><span class="p">;</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos" data-line="10"></span></a><span class="kd">local</span> <span class="n">unicode</span> <span class="o">=</span> <span class="nb">require</span> <span class="p">(</span><span class="s2">&quot;Module:Unicode data&quot;</span><span class="p">);</span>								<span class="c1">-- for is_Latin() and is_rtl()</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos" data-line="11"></span></a><span class="kd">local</span> <span class="n">yesno</span> <span class="o">=</span> <span class="nb">require</span> <span class="p">(</span><span class="s1">&#39;Module:Yesno&#39;</span><span class="p">);</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos" data-line="12"></span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos" data-line="13"></span></a><span class="kd">local</span> <span class="n">lang_data</span> <span class="o">=</span>  <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/data&#39;</span><span class="p">);</span>							<span class="c1">-- language name override and transliteration tool-tip tables</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos" data-line="14"></span></a><span class="kd">local</span> <span class="n">lang_name_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">;</span>								<span class="c1">-- language codes, names, regions, scripts, suppressed scripts</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos" data-line="15"></span></a><span class="kd">local</span> <span class="n">lang_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">lang</span><span class="p">;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos" data-line="16"></span></a><span class="kd">local</span> <span class="n">lang_dep_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">lang_dep</span><span class="p">;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos" data-line="17"></span></a><span class="kd">local</span> <span class="n">script_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">script</span><span class="p">;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos" data-line="18"></span></a><span class="kd">local</span> <span class="n">region_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">region</span><span class="p">;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos" data-line="19"></span></a><span class="kd">local</span> <span class="n">variant_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">variant</span><span class="p">;</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos" data-line="20"></span></a><span class="kd">local</span> <span class="n">suppressed_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">lang_name_table</span><span class="p">.</span><span class="n">suppressed</span><span class="p">;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos" data-line="21"></span></a><span class="kd">local</span> <span class="n">override_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">override</span><span class="p">;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos" data-line="22"></span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos" data-line="23"></span></a><span class="kd">local</span> <span class="n">synonym_table</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/ISO 639 synonyms&#39;</span><span class="p">);</span>				<span class="c1">-- ISO 639-2/639-2T code translation to 639-1 code</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos" data-line="24"></span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos" data-line="25"></span></a><span class="kd">local</span> <span class="n">cfg</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/configuration&#39;</span> <span class="o">..</span> <span class="p">(</span><span class="n">mw</span><span class="p">.</span><span class="n">getCurrentFrame</span><span class="p">():</span><span class="n">getTitle</span><span class="p">():</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;/sandbox&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>	<span class="c1">-- for internationalization</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos" data-line="26"></span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos" data-line="27"></span></a><span class="kd">local</span> <span class="n">is_latn_data</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/data/is latn data&#39;</span><span class="p">);</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos" data-line="28"></span></a><span class="kd">local</span> <span class="n">sizeof_ranges_t</span> <span class="o">=</span> <span class="n">is_latn_data</span><span class="p">.</span><span class="n">sizeof_ranges_t</span><span class="p">;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos" data-line="29"></span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos" data-line="30"></span></a><span class="kd">local</span> <span class="n">namespace</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">getCurrentTitle</span><span class="p">().</span><span class="n">namespace</span><span class="p">;</span>							<span class="c1">-- used for categorization</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos" data-line="31"></span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos" data-line="32"></span></a><span class="kd">local</span> <span class="n">content_lang</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">language</span><span class="p">.</span><span class="n">getContentLanguage</span><span class="p">();</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos" data-line="33"></span></a><span class="kd">local</span> <span class="n">this_wiki_lang_tag</span> <span class="o">=</span> <span class="n">content_lang</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>									<span class="c1">-- get this wiki&#39;s language tag</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos" data-line="34"></span></a><span class="kd">local</span> <span class="n">this_wiki_lang_dir</span> <span class="o">=</span> <span class="n">content_lang</span><span class="p">:</span><span class="n">getDir</span><span class="p">();</span>								<span class="c1">-- get this wiki&#39;s language direction</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos" data-line="35"></span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos" data-line="36"></span></a><span class="kd">local</span> <span class="n">initial_style_state</span><span class="p">;</span>														<span class="c1">-- set by lang_xx_normal() and lang_xx_italic()</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos" data-line="37"></span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos" data-line="38"></span></a><span class="kd">local</span> <span class="n">maint_cats</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- maintenance categories go here</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos" data-line="39"></span></a><span class="kd">local</span> <span class="n">maint_msgs</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- and their messages go here</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos" data-line="40"></span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos" data-line="41"></span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos" data-line="42"></span></a><span class="cm">--[[--------------------------&lt; M A K E _ E R R O R _ S P A N &gt;--------------------------------------------------</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos" data-line="43"></span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos" data-line="44"></span></a><span class="cm">]]</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos" data-line="45"></span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos" data-line="46"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_error_span</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos" data-line="47"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;span style=&quot;color:#d33&quot;&gt;&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="nb">error</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">})</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos" data-line="48"></span></a><span class="kr">end</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos" data-line="49"></span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos" data-line="50"></span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos" data-line="51"></span></a><span class="cm">--[[--------------------------&lt; S U B S T I T U T E &gt;----------------------------------------------------------</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos" data-line="52"></span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos" data-line="53"></span></a><span class="cm">Substitutes $1, $2, etc in &lt;message&gt; with data from &lt;data_t&gt;. Returns plain-text substituted string when</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos" data-line="54"></span></a><span class="cm">&lt;data_t&gt; not nil; returns &lt;message&gt; else.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos" data-line="55"></span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos" data-line="56"></span></a><span class="cm">]]</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos" data-line="57"></span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos" data-line="58"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">substitute</span> <span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data_t</span><span class="p">)</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos" data-line="59"></span></a>	<span class="kr">return</span> <span class="n">data_t</span> <span class="ow">and</span> <span class="n">mw</span><span class="p">.</span><span class="n">message</span><span class="p">.</span><span class="n">newRawMessage</span> <span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">data_t</span><span class="p">):</span><span class="n">plain</span><span class="p">()</span> <span class="ow">or</span> <span class="n">message</span><span class="p">;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos" data-line="60"></span></a><span class="kr">end</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos" data-line="61"></span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos" data-line="62"></span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos" data-line="63"></span></a><span class="cm">--[[--------------------------&lt; M A K E _ E R R O R _ M S G &gt;--------------------------------------------------</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos" data-line="64"></span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos" data-line="65"></span></a><span class="cm">Assembles an error message from template name, message text, help link, and error category.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos" data-line="66"></span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos" data-line="67"></span></a><span class="cm">]]</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos" data-line="68"></span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos" data-line="69"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args_t</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos" data-line="70"></span></a>	<span class="kd">local</span> <span class="n">category</span><span class="p">;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos" data-line="71"></span></a>	<span class="kd">local</span> <span class="n">text</span><span class="p">;</span>																	<span class="c1">-- handle the oddity that is {{langx}}</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos" data-line="72"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span> <span class="o">==</span> <span class="n">template</span> <span class="kr">then</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos" data-line="73"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">args_t</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>										<span class="c1">-- for {{lang-xx}}</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos" data-line="74"></span></a>	<span class="kr">else</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos" data-line="75"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">text</span> <span class="ow">or</span> <span class="n">args_t</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>										<span class="c1">-- for {{lang}}, {{langx}}, and {{transliteration}}</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos" data-line="76"></span></a>	<span class="kr">end</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos" data-line="77"></span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos" data-line="78"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">transliteration</span> <span class="o">==</span> <span class="n">template</span> <span class="kr">then</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos" data-line="79"></span></a>		<span class="n">category</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_error_msg_t</span><span class="p">.</span><span class="n">xlit_err_cat</span><span class="p">;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos" data-line="80"></span></a>	<span class="kr">else</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos" data-line="81"></span></a>		<span class="n">category</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_error_msg_t</span><span class="p">.</span><span class="n">lang_err_cat</span><span class="p">;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos" data-line="82"></span></a>	<span class="kr">end</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos" data-line="83"></span></a>	
</span><span id="L-84"><a href="#L-84"><span class="linenos" data-line="84"></span></a>	<span class="kd">local</span> <span class="n">category_link</span> <span class="o">=</span> <span class="p">((</span><span class="mi">0</span> <span class="o">==</span> <span class="n">namespace</span> <span class="ow">or</span> <span class="mi">10</span> <span class="o">==</span> <span class="n">namespace</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">args_t</span><span class="p">.</span><span class="n">nocat</span><span class="p">)</span> <span class="ow">and</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;[[Category:$1]]&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">category</span><span class="p">})</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos" data-line="85"></span></a>	<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;[$1] &lt;span style=&quot;color:#d33&quot;&gt;$2: {{$3}}: $4 ([[:Category:$5|$6]])&lt;/span&gt;$7&#39;</span><span class="p">,</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos" data-line="86"></span></a>		<span class="p">{</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos" data-line="87"></span></a>		<span class="n">text</span> <span class="ow">or</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_error_msg_t</span><span class="p">.</span><span class="n">undefined</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos" data-line="88"></span></a>		<span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="nb">error</span><span class="p">,</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos" data-line="89"></span></a>		<span class="n">template</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos" data-line="90"></span></a>		<span class="n">msg</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos" data-line="91"></span></a>		<span class="n">category</span><span class="p">,</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos" data-line="92"></span></a>		<span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">help</span><span class="p">,</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos" data-line="93"></span></a>		<span class="n">category_link</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos" data-line="94"></span></a>		<span class="p">})</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos" data-line="95"></span></a><span class="kr">end</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos" data-line="96"></span></a>	
</span><span id="L-97"><a href="#L-97"><span class="linenos" data-line="97"></span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos" data-line="98"></span></a><span class="cm">--[[--------------------------&lt; P A R A M E T E R _ V A L I D A T E &gt;------------------------------------------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos" data-line="99"></span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos" data-line="100"></span></a><span class="cm">]]</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos" data-line="101"></span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos" data-line="102"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">parameter_validate</span> <span class="p">(</span><span class="n">args_t</span><span class="p">,</span> <span class="n">template</span><span class="p">)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos" data-line="103"></span></a>	<span class="kd">local</span> <span class="n">err_msg</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">parameter_validate_t</span><span class="p">.</span><span class="n">invalid_param</span><span class="p">;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos" data-line="104"></span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos" data-line="105"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">lang</span> <span class="o">==</span> <span class="n">template</span> <span class="kr">then</span>									<span class="c1">-- for {{lang}}</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos" data-line="106"></span></a>		<span class="kr">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">_</span> <span class="kr">in</span> <span class="nb">pairs</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos" data-line="107"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">params_lang_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="ow">and</span>					<span class="c1">-- unique {{lang}} parameters</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos" data-line="108"></span></a>				 <span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">common_params_all_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="kr">then</span>			<span class="c1">-- common to all</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos" data-line="109"></span></a>					<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">err_msg</span><span class="p">,</span> <span class="p">{</span><span class="n">param</span><span class="p">});</span>						<span class="c1">-- &lt;param&gt; not found so abandon</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos" data-line="110"></span></a>			<span class="kr">end</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos" data-line="111"></span></a>		<span class="kr">end</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos" data-line="112"></span></a>	<span class="kr">elseif</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">template</span> <span class="kr">then</span>								<span class="c1">-- for {{langx}}</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos" data-line="113"></span></a>		<span class="kr">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">_</span> <span class="kr">in</span> <span class="nb">pairs</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos" data-line="114"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">params_langx_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="ow">and</span>					<span class="c1">-- unique {{langx}} parameters</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos" data-line="115"></span></a>				<span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">params_x_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="ow">and</span>					<span class="c1">-- common to {{langx}} and {{lang-xx}}</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos" data-line="116"></span></a>				<span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">common_params_all_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="kr">then</span>			<span class="c1">-- common to all</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos" data-line="117"></span></a>					<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">err_msg</span><span class="p">,</span> <span class="p">{</span><span class="n">param</span><span class="p">});</span>						<span class="c1">-- &lt;param&gt; not found so abandon</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos" data-line="118"></span></a>			<span class="kr">end</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos" data-line="119"></span></a>		<span class="kr">end</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos" data-line="120"></span></a>	<span class="kr">elseif</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span> <span class="o">==</span> <span class="n">template</span> <span class="kr">then</span>								<span class="c1">-- for {{lang-xx}}</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos" data-line="121"></span></a>		<span class="kr">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">_</span> <span class="kr">in</span> <span class="nb">pairs</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos" data-line="122"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">params_lang_xx_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="ow">and</span>				<span class="c1">-- unique {{lang-xx}} parameters</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos" data-line="123"></span></a>				<span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">params_x_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="ow">and</span>					<span class="c1">-- common to {{langx}} and {{lang-xx}}</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos" data-line="124"></span></a>				<span class="ow">not</span> <span class="n">cfg</span><span class="p">.</span><span class="n">known_params_t</span><span class="p">.</span><span class="n">common_params_all_t</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="kr">then</span>			<span class="c1">-- common to all</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos" data-line="125"></span></a>					<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">err_msg</span><span class="p">,</span> <span class="p">{</span><span class="n">param</span><span class="p">});</span>						<span class="c1">-- &lt;param&gt; not found so abandon</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos" data-line="126"></span></a>			<span class="kr">end</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos" data-line="127"></span></a>		<span class="kr">end</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos" data-line="128"></span></a>	<span class="kr">end</span>		
</span><span id="L-129"><a href="#L-129"><span class="linenos" data-line="129"></span></a><span class="kr">end</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos" data-line="130"></span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos" data-line="131"></span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos" data-line="132"></span></a><span class="cm">--[[--------------------------&lt; I S _ S E T &gt;------------------------------------------------------------------</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos" data-line="133"></span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos" data-line="134"></span></a><span class="cm">Returns true if argument is set; false otherwise. Argument is &#39;set&#39; when it exists (not nil) or when it is not</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos" data-line="135"></span></a><span class="cm">an empty string.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos" data-line="136"></span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos" data-line="137"></span></a><span class="cm">]]</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos" data-line="138"></span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos" data-line="139"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">is_set</span> <span class="p">(</span><span class="n">var</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos" data-line="140"></span></a>	<span class="kr">return</span> <span class="ow">not</span> <span class="p">(</span><span class="n">var</span> <span class="o">==</span> <span class="kc">nil</span> <span class="ow">or</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos" data-line="141"></span></a><span class="kr">end</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos" data-line="142"></span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos" data-line="143"></span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos" data-line="144"></span></a><span class="cm">--[[--------------------------&lt; I N V E R T  _ I T A L I C S &gt;-------------------------------------------------</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos" data-line="145"></span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos" data-line="146"></span></a><span class="cm">This function attempts to invert the italic markup a args.text by adding/removing leading/trailing italic markup</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos" data-line="147"></span></a><span class="cm">in args.text.  Like |italic=unset, |italic=invert disables automatic italic markup.  Individual leading/trailing</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos" data-line="148"></span></a><span class="cm">apostrophes are converted to their html numeric entity equivalent so that the new italic markup doesn&#39;t become</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos" data-line="149"></span></a><span class="cm">bold markup inadvertently.</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos" data-line="150"></span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos" data-line="151"></span></a><span class="cm">Leading and trailing wiki markup is extracted from args.text into separate table elements.  Addition, removal,</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos" data-line="152"></span></a><span class="cm">replacement of wiki markup is handled by a string.gsub() replacement table operating only on these separate elements.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos" data-line="153"></span></a><span class="cm">In the string.gsub() matching pattern, &#39;.*&#39; matches empty string as well as the three expected wiki markup patterns.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos" data-line="154"></span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos" data-line="155"></span></a><span class="cm">This function expects that markup in args.text is complete and correct; if it is not, oddness may result.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos" data-line="156"></span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos" data-line="157"></span></a><span class="cm">]]</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos" data-line="158"></span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos" data-line="159"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">invert_italics</span> <span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos" data-line="160"></span></a>	<span class="kd">local</span> <span class="n">invert_pattern_table</span> <span class="o">=</span> <span class="p">{</span>												<span class="c1">-- leading/trailing markup add/remove/replace patterns</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos" data-line="161"></span></a>		<span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">,</span>															<span class="c1">-- empty string becomes italic markup</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos" data-line="162"></span></a>		<span class="p">[</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>															<span class="c1">-- italic markup becomes empty string</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos" data-line="163"></span></a>		<span class="p">[</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;\&#39;\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">,</span>												<span class="c1">-- bold becomes bold italic</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos" data-line="164"></span></a>		<span class="p">[</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;\&#39;\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;\&#39;</span><span class="s2">&quot;</span><span class="p">,</span>												<span class="c1">-- bold italic become bold</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos" data-line="165"></span></a>		<span class="p">};</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos" data-line="166"></span></a>	<span class="kd">local</span> <span class="n">seg</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos" data-line="167"></span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos" data-line="168"></span></a>	<span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s2">&quot;%f[</span><span class="se">\&#39;</span><span class="s2">]</span><span class="se">\&#39;</span><span class="s2">%f[^</span><span class="se">\&#39;</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="s1">&#39;&amp;#39;&#39;</span><span class="p">);</span>							<span class="c1">-- protect single quote marks from being interpreted as bold markup</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos" data-line="169"></span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos" data-line="170"></span></a>	<span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^(</span><span class="se">\&#39;\&#39;</span><span class="s1">+%f[^</span><span class="se">\&#39;</span><span class="s1">]).+&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>							<span class="c1">-- get leading markup, if any; ignore single quote</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos" data-line="171"></span></a>	<span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;.+(%f[</span><span class="se">\&#39;</span><span class="s1">]</span><span class="se">\&#39;\&#39;</span><span class="s1">+)$&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>							<span class="c1">-- get trailing markup, if any; ignore single quote</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos" data-line="172"></span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos" data-line="173"></span></a>	<span class="kr">if</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="kr">then</span>										<span class="c1">-- extract the &#39;text&#39; </span>
</span><span id="L-174"><a href="#L-174"><span class="linenos" data-line="174"></span></a>		<span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^</span><span class="se">\&#39;\&#39;</span><span class="s1">+%f[^</span><span class="se">\&#39;</span><span class="s1">](.+)%f[</span><span class="se">\&#39;</span><span class="s1">]</span><span class="se">\&#39;\&#39;</span><span class="s1">+$&#39;</span><span class="p">)</span>					<span class="c1">-- from between leading and trailing markup</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos" data-line="175"></span></a>	<span class="kr">elseif</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos" data-line="176"></span></a>		<span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^</span><span class="se">\&#39;\&#39;</span><span class="s1">+%f[^</span><span class="se">\&#39;</span><span class="s1">](.+)&#39;</span><span class="p">)</span>								<span class="c1">-- following leading markup</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos" data-line="177"></span></a>	<span class="kr">elseif</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos" data-line="178"></span></a>		<span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;(.+)%f[</span><span class="se">\&#39;</span><span class="s1">]</span><span class="se">\&#39;\&#39;</span><span class="s1">+$&#39;</span><span class="p">)</span>								<span class="c1">-- preceding trailing markup</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos" data-line="179"></span></a>	<span class="kr">else</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos" data-line="180"></span></a>		<span class="n">seg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>															<span class="c1">-- when there is no markup</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos" data-line="181"></span></a>	<span class="kr">end</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos" data-line="182"></span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos" data-line="183"></span></a>	<span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">invert_pattern_table</span><span class="p">[</span><span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">seg</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>							<span class="c1">-- replace leading markup according to pattern table</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos" data-line="184"></span></a>	<span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">invert_pattern_table</span><span class="p">[</span><span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="ow">or</span> <span class="n">seg</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>							<span class="c1">-- replace leading markup according to pattern table</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos" data-line="185"></span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos" data-line="186"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">seg</span><span class="p">);</span>													<span class="c1">-- put it all back together and done</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos" data-line="187"></span></a><span class="kr">end</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos" data-line="188"></span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos" data-line="189"></span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos" data-line="190"></span></a><span class="cm">--[[--------------------------&lt; V A L I D A T E _ I T A L I C &gt;------------------------------------------------</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos" data-line="191"></span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos" data-line="192"></span></a><span class="cm">Validates |italic= or |italics= assigned values.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos" data-line="193"></span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos" data-line="194"></span></a><span class="cm">When |italic= is set and has an acceptible assigned value, return the matching css font-style property value or,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos" data-line="195"></span></a><span class="cm">for the special case &#39;default&#39;, return nil.</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos" data-line="196"></span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos" data-line="197"></span></a><span class="cm">When |italic= is not set, or has an unacceptible assigned value, return nil and a nil error message.</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos" data-line="198"></span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos" data-line="199"></span></a><span class="cm">When both |italic= and |italics= are set, returns nil and a &#39;conflicting&#39; error message.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos" data-line="200"></span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos" data-line="201"></span></a><span class="cm">The return value nil causes the calling lang, lang_xx, or transl function to set args.italic according to the template&#39;s</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos" data-line="202"></span></a><span class="cm">defined default (&#39;inherit&#39; for {{lang}}, &#39;inherit&#39; or &#39;italic&#39; for {{lang-??}} depending on</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos" data-line="203"></span></a><span class="cm">the individual template&#39;s requirements, &#39;italic&#39; for {{transliteration}}) or to the value appropriate to |script=, if set ({{lang}}</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos" data-line="204"></span></a><span class="cm">and {{lang-??}} only).</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos" data-line="205"></span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos" data-line="206"></span></a><span class="cm">Accepted values and the values that this function returns are are:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos" data-line="207"></span></a><span class="cm">	nil		-	when |italic= absent or not set; returns nil</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos" data-line="208"></span></a><span class="cm">	default	-	for completeness, should rarely if ever be used; returns nil</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos" data-line="209"></span></a><span class="cm">	yes		-	force args.text to be rendered in italic font; returns &#39;italic&#39;</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos" data-line="210"></span></a><span class="cm">	no		-	force args.text to be rendered in normal font; returns &#39;normal&#39;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos" data-line="211"></span></a><span class="cm">	unset	-	disables font control so that font-style applied to text is dictated by markup inside or outside the template; returns &#39;inherit&#39;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos" data-line="212"></span></a><span class="cm">	invert	-	disables font control so that font-style applied to text is dictated by markup outside or inverted inside the template; returns &#39;invert&#39;</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos" data-line="213"></span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos" data-line="214"></span></a><span class="cm">]]</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos" data-line="215"></span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos" data-line="216"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">validate_italic</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos" data-line="217"></span></a>	<span class="kd">local</span> <span class="n">properties</span> <span class="o">=</span> <span class="p">{[</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">negative</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">unset</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">invert</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;invert&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">default</span><span class="p">]</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">};</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos" data-line="218"></span></a>	
</span><span id="L-219"><a href="#L-219"><span class="linenos" data-line="219"></span></a>	<span class="kd">local</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos" data-line="220"></span></a>	<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">arg</span> <span class="kr">in</span> <span class="nb">pairs</span> <span class="p">{</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span> <span class="s1">&#39;italics&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">}</span> <span class="kr">do</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos" data-line="221"></span></a>		<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos" data-line="222"></span></a>			<span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos" data-line="223"></span></a>		<span class="kr">end</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos" data-line="224"></span></a>	<span class="kr">end</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos" data-line="225"></span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos" data-line="226"></span></a>	<span class="kr">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="kr">then</span>															<span class="c1">-- return nil and an error message if more than one is set </span>
</span><span id="L-227"><a href="#L-227"><span class="linenos" data-line="227"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">validate_italic_t</span><span class="p">.</span><span class="n">multi_italic</span><span class="p">;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos" data-line="228"></span></a>	<span class="kr">end</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos" data-line="229"></span></a>	
</span><span id="L-230"><a href="#L-230"><span class="linenos" data-line="230"></span></a>	<span class="kr">return</span> <span class="n">properties</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">italics</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">i</span><span class="p">],</span> <span class="kc">nil</span><span class="p">;</span>				<span class="c1">-- return an appropriate value and a nil error message</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos" data-line="231"></span></a><span class="kr">end</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos" data-line="232"></span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos" data-line="233"></span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos" data-line="234"></span></a><span class="cm">--[=[--------------------------&lt; V A L I D A T E _ C A T _ A R G S &gt;----------------------------------------------------------</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos" data-line="235"></span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos" data-line="236"></span></a><span class="cm">Default behavior of the {{lang}} and {{lang-??}} templates is to add categorization when the templates are used in mainspace.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos" data-line="237"></span></a><span class="cm">This default functionality may be suppressed by setting |nocat=yes or |cat=no.  This function selects one of these two parameters</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos" data-line="238"></span></a><span class="cm">to control categorization.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos" data-line="239"></span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos" data-line="240"></span></a><span class="cm">Because having two parameters with &#39;opposite&#39; names and &#39;opposite&#39; values is confusing, this function accepts only affirmative</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos" data-line="241"></span></a><span class="cm">values for |nocat= and only negative values for |cat=; in both cases the &#39;other&#39; sense (and non-sense) is not accepted and the</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos" data-line="242"></span></a><span class="cm">parameter is treated as if it were not set in the template.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos" data-line="243"></span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos" data-line="244"></span></a><span class="cm">Sets args.nocat to true if categorization is to be turned off; to nil if the default behavior should apply.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos" data-line="245"></span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos" data-line="246"></span></a><span class="cm">Accepted values for |nocat= are the text strings:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos" data-line="247"></span></a><span class="cm">	&#39;yes&#39;, &#39;y&#39;, &#39;true&#39;, &#39;t&#39;, on, &#39;1&#39;		-- [[Module:Yesno]] returns logical true for all of these; false or nil else</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos" data-line="248"></span></a><span class="cm">for |cat=</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos" data-line="249"></span></a><span class="cm">	&#39;no&#39;, &#39;n&#39;, &#39;false&#39;, &#39;f&#39;, &#39;off&#39;, &#39;0&#39;		-- [[Module:Yesno]] returns logical false for all of these; true or nil else</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos" data-line="250"></span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos" data-line="251"></span></a><span class="cm">]=]</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos" data-line="252"></span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos" data-line="253"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">validate_cat_args</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos" data-line="254"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">nocat</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">cat</span><span class="p">)</span> <span class="kr">then</span>										<span class="c1">-- both are nil, so categorize</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos" data-line="255"></span></a>		<span class="kr">return</span><span class="p">;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos" data-line="256"></span></a>	<span class="kr">end</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos" data-line="257"></span></a>	
</span><span id="L-258"><a href="#L-258"><span class="linenos" data-line="258"></span></a>	<span class="kr">if</span> <span class="kc">false</span> <span class="o">==</span> <span class="n">yesno</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">cat</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">true</span> <span class="o">==</span> <span class="n">yesno</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">nocat</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos" data-line="259"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">nocat</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>														<span class="c1">-- set to true when args.nocat is affirmative; nil else (as if the parameter were not set in the template)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos" data-line="260"></span></a>	<span class="kr">else</span>																		<span class="c1">-- args.nocat is the parameter actually used.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos" data-line="261"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">nocat</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos" data-line="262"></span></a>	<span class="kr">end</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos" data-line="263"></span></a><span class="kr">end</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos" data-line="264"></span></a>
</span><span id="L-265"><a href="#L-265"><span class="linenos" data-line="265"></span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos" data-line="266"></span></a><span class="cm">--[[--------------------------&lt; I N _ A R R A Y &gt;--------------------------------------------------------------</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos" data-line="267"></span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos" data-line="268"></span></a><span class="cm">Whether needle is in haystack.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos" data-line="269"></span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos" data-line="270"></span></a><span class="cm">]]</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos" data-line="271"></span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos" data-line="272"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">in_array</span> <span class="p">(</span><span class="n">needle</span><span class="p">,</span> <span class="n">haystack</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos" data-line="273"></span></a>	<span class="kr">if</span> <span class="n">needle</span> <span class="o">==</span> <span class="kc">nil</span> <span class="kr">then</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos" data-line="274"></span></a>		<span class="kr">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos" data-line="275"></span></a>	<span class="kr">end</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos" data-line="276"></span></a>	<span class="kr">for</span> <span class="n">n</span><span class="p">,</span><span class="n">v</span> <span class="kr">in</span> <span class="nb">ipairs</span> <span class="p">(</span><span class="n">haystack</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos" data-line="277"></span></a>		<span class="kr">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">needle</span> <span class="kr">then</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos" data-line="278"></span></a>			<span class="kr">return</span> <span class="n">n</span><span class="p">;</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos" data-line="279"></span></a>		<span class="kr">end</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos" data-line="280"></span></a>	<span class="kr">end</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos" data-line="281"></span></a>	<span class="kr">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos" data-line="282"></span></a><span class="kr">end</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos" data-line="283"></span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos" data-line="284"></span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos" data-line="285"></span></a><span class="cm">--[[--------------------------&lt; F O R M A T _ I E T F _ T A G &gt;------------------------------------------------</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos" data-line="286"></span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos" data-line="287"></span></a><span class="cm">Prettify ietf tags to use recommended subtag formats:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos" data-line="288"></span></a><span class="cm">	code: lower case</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos" data-line="289"></span></a><span class="cm">	script: sentence case</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos" data-line="290"></span></a><span class="cm">	region: upper case</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos" data-line="291"></span></a><span class="cm">	variant: lower case</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos" data-line="292"></span></a><span class="cm">	private: lower case prefixed with -x-</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos" data-line="293"></span></a><span class="cm">	</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos" data-line="294"></span></a><span class="cm">]]</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos" data-line="295"></span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos" data-line="296"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">format_ietf_tag</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">private</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos" data-line="297"></span></a>	<span class="kd">local</span> <span class="n">out</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos" data-line="298"></span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos" data-line="299"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">private</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos" data-line="300"></span></a>		<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">(),</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">private</span><span class="p">:</span><span class="n">lower</span><span class="p">()},</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>		<span class="c1">-- if private, all other tags ignored</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos" data-line="301"></span></a>	<span class="kr">end</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos" data-line="302"></span></a>	
</span><span id="L-303"><a href="#L-303"><span class="linenos" data-line="303"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">());</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos" data-line="304"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos" data-line="305"></span></a>		<span class="n">script</span> <span class="o">=</span> <span class="n">script</span><span class="p">:</span><span class="n">lower</span><span class="p">():</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%a&#39;</span><span class="p">,</span> <span class="nb">string.upper</span><span class="p">);</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos" data-line="306"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">script</span><span class="p">);</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos" data-line="307"></span></a>	<span class="kr">end</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos" data-line="308"></span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos" data-line="309"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">region</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos" data-line="310"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">region</span><span class="p">:</span><span class="n">upper</span><span class="p">());</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos" data-line="311"></span></a>	<span class="kr">end</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos" data-line="312"></span></a>	
</span><span id="L-313"><a href="#L-313"><span class="linenos" data-line="313"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">variant</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos" data-line="314"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">variant</span><span class="p">:</span><span class="n">lower</span><span class="p">());</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos" data-line="315"></span></a>	<span class="kr">end</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos" data-line="316"></span></a>	
</span><span id="L-317"><a href="#L-317"><span class="linenos" data-line="317"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">);</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos" data-line="318"></span></a><span class="kr">end</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos" data-line="319"></span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos" data-line="320"></span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos" data-line="321"></span></a><span class="cm">--[[--------------------------&lt; G E T _ I E T F _ P A R T S &gt;--------------------------------------------------</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos" data-line="322"></span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos" data-line="323"></span></a><span class="cm">Extracts and returns IETF language tag parts:</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos" data-line="324"></span></a><span class="cm">	primary language subtag (required) - 2 or 3 character IANA language code</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos" data-line="325"></span></a><span class="cm">	script subtag - four character IANA script code</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos" data-line="326"></span></a><span class="cm">	region subtag - two-letter or three digit IANA region code</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos" data-line="327"></span></a><span class="cm">	variant subtag - four digit or 5-8 alnum variant code; only one variant subtag supported</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos" data-line="328"></span></a><span class="cm">	private subtag - x- followed by 1-8 alnum private code; only supported with the primary language tag</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos" data-line="329"></span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos" data-line="330"></span></a><span class="cm">in any one of these forms</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos" data-line="331"></span></a><span class="cm">	lang					lang-variant</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos" data-line="332"></span></a><span class="cm">	lang-script				lang-script-variant</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos" data-line="333"></span></a><span class="cm">	lang-region				lang-region-variant</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos" data-line="334"></span></a><span class="cm">	lang-script-region		lang-script-region-variant</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos" data-line="335"></span></a><span class="cm">	lang-x-private	</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos" data-line="336"></span></a><span class="cm">	</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos" data-line="337"></span></a><span class="cm">each of lang, script, region, variant, and private, when used, must be valid.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos" data-line="338"></span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos" data-line="339"></span></a><span class="cm">Languages with both two- and three-character code synonyms are promoted to the two-character synonym because</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos" data-line="340"></span></a><span class="cm">the IANA registry file omits the synonymous three-character code; we cannot depend on browsers understanding</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos" data-line="341"></span></a><span class="cm">the synonymous three-character codes in the lang= attribute.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos" data-line="342"></span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos" data-line="343"></span></a><span class="cm">For {{lang-??}} templates, the parameters |script=, |region=, and |variant= are supported (not supported in {{lang}}</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos" data-line="344"></span></a><span class="cm">because those parameters are superfluous to the IETF subtags in |code=).</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos" data-line="345"></span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos" data-line="346"></span></a><span class="cm">Returns six  values; all lower case.  Valid parts are returned as themselves; omitted parts are returned as empty strings, invalid</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos" data-line="347"></span></a><span class="cm">parts are returned as nil; the sixth returned item is an error message (if an error detected) or nil.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos" data-line="348"></span></a>
</span><span id="L-349"><a href="#L-349"><span class="linenos" data-line="349"></span></a><span class="cm">See http://www.rfc-editor.org/rfc/bcp/bcp47.txt section 2.1.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos" data-line="350"></span></a><span class="cm">	</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos" data-line="351"></span></a><span class="cm">]]</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos" data-line="352"></span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos" data-line="353"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">get_ietf_parts</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">args_script</span><span class="p">,</span> <span class="n">args_region</span><span class="p">,</span> <span class="n">args_variant</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos" data-line="354"></span></a>	<span class="kd">local</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">private</span><span class="p">;</span>								<span class="c1">-- ietf tag parts</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos" data-line="355"></span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos" data-line="356"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos" data-line="357"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">missing_lang_tag</span><span class="p">;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos" data-line="358"></span></a>	<span class="kr">end</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos" data-line="359"></span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos" data-line="360"></span></a>	<span class="kd">local</span> <span class="n">pattern</span> <span class="o">=</span> <span class="p">{</span>															<span class="c1">-- table of tables holding acceptibe ietf tag patterns and short names of the ietf part captured by the pattern</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos" data-line="361"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%a%a)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span> 				<span class="c1">-- 1 -  ll-Ssss-RR-variant (where variant is 4 digits)</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos" data-line="362"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%d%d%d)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>				<span class="c1">-- 2 -  ll-Ssss-DDD-variant (where region is 3 digits; variant is 4 digits)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos" data-line="363"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%a%a)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>		<span class="c1">-- 3 -  ll-Ssss-RR-variant (where variant is 5-8 alnum characters)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos" data-line="364"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%d%d%d)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>	<span class="c1">-- 4 -  ll-Ssss-DDD-variant (where region is 3 digits; variant is 5-8 alnum characters)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos" data-line="365"></span></a>		
</span><span id="L-366"><a href="#L-366"><span class="linenos" data-line="366"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>						<span class="c1">-- 5 -  ll-Ssss-variant (where variant is 4 digits)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos" data-line="367"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>			<span class="c1">-- 6 -  ll-Ssss-variant (where variant is 5-8 alnum characters)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos" data-line="368"></span></a>		
</span><span id="L-369"><a href="#L-369"><span class="linenos" data-line="369"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>							<span class="c1">-- 7 -  ll-RR-variant (where variant is 4 digits)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos" data-line="370"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%d%d%d)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>						<span class="c1">-- 8 -  ll-DDD-variant (where region is 3 digits; variant is 4 digits)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos" data-line="371"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>				<span class="c1">-- 9 -  ll-RR-variant (where variant is 5-8 alnum characters)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos" data-line="372"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%d%d%d)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>				<span class="c1">-- 10 - ll-DDD-variant (where region is 3 digits; variant is 5-8 alnum characters)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos" data-line="373"></span></a>		
</span><span id="L-374"><a href="#L-374"><span class="linenos" data-line="374"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%d%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>										<span class="c1">-- 11 - ll-variant (where variant is 4 digits)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos" data-line="375"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%w%w%w%w%w%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">},</span>							<span class="c1">-- 12 - ll-variant (where variant is 5-8 alnum characters)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos" data-line="376"></span></a>		
</span><span id="L-377"><a href="#L-377"><span class="linenos" data-line="377"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%a%a)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">},</span>							<span class="c1">-- 13 - ll-Ssss-RR</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos" data-line="378"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)%-(%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">},</span>						<span class="c1">-- 14 - ll-Ssss-DDD (region is 3 digits)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos" data-line="379"></span></a>		
</span><span id="L-380"><a href="#L-380"><span class="linenos" data-line="380"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a%a%a)$&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">},</span>										<span class="c1">-- 15 - ll-Ssss</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos" data-line="381"></span></a>		
</span><span id="L-382"><a href="#L-382"><span class="linenos" data-line="382"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%a%a)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">},</span>											<span class="c1">-- 16 - ll-RR</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos" data-line="383"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-(%d%d%d)$&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">},</span>											<span class="c1">-- 17 - ll-DDD (region is 3 digits)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos" data-line="384"></span></a>		
</span><span id="L-385"><a href="#L-385"><span class="linenos" data-line="385"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)$&#39;</span><span class="p">},</span>														<span class="c1">-- 18 - ll</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos" data-line="386"></span></a>		
</span><span id="L-387"><a href="#L-387"><span class="linenos" data-line="387"></span></a>		<span class="p">{</span><span class="s1">&#39;^(%a%a%a?)%-x%-(%w%w?%w?%w?%w?%w?%w?%w?)$&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">},</span>						<span class="c1">-- 19 - ll-x-pppppppp (private is 1-8 alnum characters)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos" data-line="388"></span></a>		<span class="p">}</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos" data-line="389"></span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos" data-line="390"></span></a>	<span class="kd">local</span> <span class="n">t</span> <span class="o">=</span> <span class="p">{};</span>																<span class="c1">-- table of captures; serves as a translator between captured ietf tag parts and named variables</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos" data-line="391"></span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos" data-line="392"></span></a>	<span class="kr">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="kr">in</span> <span class="nb">ipairs</span> <span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="kr">do</span>												<span class="c1">-- spin through the pattern table looking for a match</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos" data-line="393"></span></a>		<span class="kd">local</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span><span class="p">;</span>													<span class="c1">-- captures in the &#39;pattern&#39; from the pattern table go here</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos" data-line="394"></span></a>	
</span><span id="L-395"><a href="#L-395"><span class="linenos" data-line="395"></span></a>		<span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">c4</span> <span class="o">=</span> <span class="n">source</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="n">pattern</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]);</span>							<span class="c1">-- one or more captures set if source matches pattern[i])</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos" data-line="396"></span></a>			<span class="kr">if</span> <span class="n">c1</span> <span class="kr">then</span>															<span class="c1">-- c1 always set on match</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos" data-line="397"></span></a>				<span class="n">code</span> <span class="o">=</span> <span class="n">c1</span><span class="p">;</span>														<span class="c1">-- first capture is always code</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos" data-line="398"></span></a>				<span class="n">t</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos" data-line="399"></span></a>					<span class="p">[</span><span class="n">pattern</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c2</span><span class="p">,</span>								<span class="c1">-- fill the table of captures with the rest of the captures</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos" data-line="400"></span></a>					<span class="p">[</span><span class="n">pattern</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c3</span><span class="p">,</span>								<span class="c1">-- take index names from pattern table and assign sequential captures</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos" data-line="401"></span></a>					<span class="p">[</span><span class="n">pattern</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c4</span><span class="p">,</span>								<span class="c1">-- index name may be nil in pattern[i] table so &quot;or &#39;x&#39;&quot; spoofs a name for this index in this table</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos" data-line="402"></span></a>					<span class="p">};</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos" data-line="403"></span></a>				<span class="n">script</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">s</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>												<span class="c1">-- translate table contents to named variables;</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos" data-line="404"></span></a>				<span class="n">region</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">r</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>												<span class="c1">-- absent table entries are nil so set named ietf parts to empty string for concatenation</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos" data-line="405"></span></a>				<span class="n">variant</span><span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">v</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos" data-line="406"></span></a>				<span class="n">private</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">p</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos" data-line="407"></span></a>				<span class="kr">break</span><span class="p">;</span>															<span class="c1">-- and done</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos" data-line="408"></span></a>			<span class="kr">end</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos" data-line="409"></span></a>	<span class="kr">end</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos" data-line="410"></span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos" data-line="411"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">code</span> <span class="kr">then</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos" data-line="412"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_tag</span><span class="p">,</span> <span class="p">{</span><span class="n">source</span><span class="p">});</span>	<span class="c1">-- don&#39;t know what we got but it is malformed</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos" data-line="413"></span></a>	<span class="kr">end</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos" data-line="414"></span></a>
</span><span id="L-415"><a href="#L-415"><span class="linenos" data-line="415"></span></a>	<span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>														<span class="c1">-- ensure that we use and return lower case version of this</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos" data-line="416"></span></a>	
</span><span id="L-417"><a href="#L-417"><span class="linenos" data-line="417"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">override_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="ow">or</span> <span class="n">lang_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="ow">or</span> <span class="n">synonym_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="ow">or</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">code</span><span class="p">])</span> <span class="kr">then</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos" data-line="418"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_code</span><span class="p">,</span> <span class="p">{</span><span class="n">code</span><span class="p">});</span>		<span class="c1">-- invalid language code, don&#39;t know about the others (don&#39;t care?)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos" data-line="419"></span></a>	<span class="kr">end</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos" data-line="420"></span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos" data-line="421"></span></a>	<span class="kr">if</span> <span class="n">synonym_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>													<span class="c1">-- if 639-2/639-2T code has a 639-1 synonym</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos" data-line="422"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint_cats</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">maint_promo_cat</span><span class="p">,</span> <span class="p">{</span><span class="n">code</span><span class="p">}));</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos" data-line="423"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint_msgs</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">maint_promo_msg</span><span class="p">,</span> <span class="p">{</span><span class="n">code</span><span class="p">,</span> <span class="n">synonym_table</span><span class="p">[</span><span class="n">code</span><span class="p">]}));</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos" data-line="424"></span></a>		<span class="n">code</span> <span class="o">=</span> <span class="n">synonym_table</span><span class="p">[</span><span class="n">code</span><span class="p">];</span>												<span class="c1">-- use the synonym</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos" data-line="425"></span></a>	<span class="kr">end</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos" data-line="426"></span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos" data-line="427"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos" data-line="428"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args_script</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos" data-line="429"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">redundant_scr</span><span class="p">;</span>	<span class="c1">-- both code with script and |script= not allowed</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos" data-line="430"></span></a>		<span class="kr">end</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos" data-line="431"></span></a>	<span class="kr">else</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos" data-line="432"></span></a>		<span class="n">script</span> <span class="o">=</span> <span class="n">args_script</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>												<span class="c1">-- use args.script if provided</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos" data-line="433"></span></a>	<span class="kr">end</span> 
</span><span id="L-434"><a href="#L-434"><span class="linenos" data-line="434"></span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos" data-line="435"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos" data-line="436"></span></a>		<span class="n">script</span> <span class="o">=</span> <span class="n">script</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>												<span class="c1">-- ensure that we use and return lower case version of this</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos" data-line="437"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">script_table</span><span class="p">[</span><span class="n">script</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos" data-line="438"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_scr_code</span><span class="p">,</span> <span class="p">{</span><span class="n">script</span><span class="p">,</span> <span class="n">code</span><span class="p">});</span>	<span class="c1">-- language code ok, invalid script, don&#39;t know about the others (don&#39;t care?)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos" data-line="439"></span></a>		<span class="kr">end</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos" data-line="440"></span></a>	<span class="kr">end</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos" data-line="441"></span></a>	<span class="kr">if</span> <span class="n">suppressed_table</span><span class="p">[</span><span class="n">script</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- ensure that code-script does not use a suppressed script</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos" data-line="442"></span></a>		<span class="kr">if</span> <span class="n">in_array</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">suppressed_table</span><span class="p">[</span><span class="n">script</span><span class="p">])</span> <span class="kr">then</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos" data-line="443"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">script_code</span><span class="p">,</span> <span class="p">{</span><span class="n">script</span><span class="p">,</span> <span class="n">code</span><span class="p">});</span>	<span class="c1">-- language code ok, script is suppressed for this code</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos" data-line="444"></span></a>		<span class="kr">end</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos" data-line="445"></span></a>	<span class="kr">end</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos" data-line="446"></span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos" data-line="447"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">region</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos" data-line="448"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args_region</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos" data-line="449"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">redundant_reg</span><span class="p">;</span>	<span class="c1">-- both code with region and |region= not allowed</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos" data-line="450"></span></a>		<span class="kr">end</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos" data-line="451"></span></a>	<span class="kr">else</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos" data-line="452"></span></a>		<span class="n">region</span> <span class="o">=</span> <span class="n">args_region</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>												<span class="c1">-- use args.region if provided</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos" data-line="453"></span></a>	<span class="kr">end</span> 
</span><span id="L-454"><a href="#L-454"><span class="linenos" data-line="454"></span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos" data-line="455"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">region</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos" data-line="456"></span></a>		<span class="n">region</span> <span class="o">=</span> <span class="n">region</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>												<span class="c1">-- ensure that we use and return lower case version of this</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos" data-line="457"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">region_table</span><span class="p">[</span><span class="n">region</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos" data-line="458"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_reg_code</span><span class="p">,</span> <span class="p">{</span><span class="n">region</span><span class="p">,</span> <span class="n">code</span><span class="p">});</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos" data-line="459"></span></a>		<span class="kr">end</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos" data-line="460"></span></a>	<span class="kr">end</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos" data-line="461"></span></a>	
</span><span id="L-462"><a href="#L-462"><span class="linenos" data-line="462"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">variant</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos" data-line="463"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args_variant</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos" data-line="464"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">redundant_var</span><span class="p">;</span>	<span class="c1">-- both code with variant and |variant= not allowed</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos" data-line="465"></span></a>		<span class="kr">end</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos" data-line="466"></span></a>	<span class="kr">else</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos" data-line="467"></span></a>		<span class="n">variant</span> <span class="o">=</span> <span class="n">args_variant</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>											<span class="c1">-- use args.variant if provided</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos" data-line="468"></span></a>	<span class="kr">end</span> 
</span><span id="L-469"><a href="#L-469"><span class="linenos" data-line="469"></span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos" data-line="470"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">variant</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos" data-line="471"></span></a>		<span class="n">variant</span> <span class="o">=</span> <span class="n">variant</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>												<span class="c1">-- ensure that we use and return lower case version of this</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos" data-line="472"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">]</span> <span class="kr">then</span>										<span class="c1">-- make sure variant is valid</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos" data-line="473"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_var</span><span class="p">,</span> <span class="p">{</span><span class="n">variant</span><span class="p">});</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos" data-line="474"></span></a>		<span class="kr">end</span>																		<span class="c1">-- does this duplicate/replace tests in lang() and lang_xx()?</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos" data-line="475"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>													<span class="c1">-- if script set it must be part of the &#39;prefix&#39;</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos" data-line="476"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">in_array</span> <span class="p">(</span><span class="nb">table.concat</span> <span class="p">({</span><span class="n">code</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">script</span><span class="p">}),</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">][</span><span class="s1">&#39;prefixes&#39;</span><span class="p">])</span> <span class="kr">then</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos" data-line="477"></span></a>				<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_var_code_scr</span><span class="p">,</span> <span class="p">{</span><span class="n">variant</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">});</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos" data-line="478"></span></a>			<span class="kr">end</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos" data-line="479"></span></a>		<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">region</span><span class="p">)</span> <span class="kr">then</span>												<span class="c1">-- if region set, there are some prefixes that require lang code and region (en-CA-newfound)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos" data-line="480"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">in_array</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">][</span><span class="s1">&#39;prefixes&#39;</span><span class="p">])</span> <span class="kr">then</span>		<span class="c1">-- first see if lang code is all that&#39;s required (en-oxendict though en-GB-oxendict is preferred)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos" data-line="481"></span></a>				<span class="kr">if</span> <span class="ow">not</span> <span class="n">in_array</span> <span class="p">(</span><span class="nb">table.concat</span> <span class="p">({</span><span class="n">code</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">region</span><span class="p">}),</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">][</span><span class="s1">&#39;prefixes&#39;</span><span class="p">])</span> <span class="kr">then</span>		<span class="c1">-- now try for lang code and region (en-CA-newfound)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos" data-line="482"></span></a>					<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_var_code_reg</span><span class="p">,</span> <span class="p">{</span><span class="n">variant</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">region</span><span class="p">});</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos" data-line="483"></span></a>				<span class="kr">end</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos" data-line="484"></span></a>			<span class="kr">end</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos" data-line="485"></span></a>		<span class="kr">else</span>																	<span class="c1">-- cheap way to determine if there are prefixes; fonipa and others don&#39;t have prefixes; # operator always returns 0</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos" data-line="486"></span></a>			<span class="kr">if</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">][</span><span class="s1">&#39;prefixes&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">in_array</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">variant_table</span><span class="p">[</span><span class="n">variant</span><span class="p">][</span><span class="s1">&#39;prefixes&#39;</span><span class="p">])</span> <span class="kr">then</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos" data-line="487"></span></a>				<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_var_code</span><span class="p">,</span> <span class="p">{</span><span class="n">variant</span><span class="p">,</span> <span class="n">code</span><span class="p">});</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos" data-line="488"></span></a>			<span class="kr">end</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos" data-line="489"></span></a>		<span class="kr">end</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos" data-line="490"></span></a>	<span class="kr">end</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos" data-line="491"></span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos" data-line="492"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">private</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos" data-line="493"></span></a>		<span class="n">private</span> <span class="o">=</span> <span class="n">private</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>												<span class="c1">-- ensure that we use and return lower case version of this</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos" data-line="494"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">override_table</span><span class="p">[</span><span class="nb">table.concat</span> <span class="p">({</span><span class="n">code</span><span class="p">,</span> <span class="s1">&#39;-x-&#39;</span><span class="p">,</span> <span class="n">private</span><span class="p">})]</span> <span class="kr">then</span>		<span class="c1">-- make sure private tag is valid; note that index </span>
</span><span id="L-495"><a href="#L-495"><span class="linenos" data-line="495"></span></a>			<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">unrecog_pri</span><span class="p">,</span> <span class="p">{</span><span class="n">private</span><span class="p">});</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos" data-line="496"></span></a>		<span class="kr">end</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos" data-line="497"></span></a>	<span class="kr">end</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos" data-line="498"></span></a>	<span class="kr">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">private</span><span class="p">,</span> <span class="kc">nil</span><span class="p">;</span>							<span class="c1">-- return the good bits; make sure that msg is nil</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos" data-line="499"></span></a><span class="kr">end</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos" data-line="500"></span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos" data-line="501"></span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos" data-line="502"></span></a><span class="cm">--[=[-------------------------&lt; M A K E _ W I K I L I N K &gt;----------------------------------------------------</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos" data-line="503"></span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos" data-line="504"></span></a><span class="cm">Makes a wikilink; when both link and display text is provided, returns a wikilink in the form [[L|D]]; if only</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos" data-line="505"></span></a><span class="cm">link is provided, returns a wikilink in the form [[L]]; if neither are provided or link is omitted, returns an</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos" data-line="506"></span></a><span class="cm">empty string.</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos" data-line="507"></span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos" data-line="508"></span></a><span class="cm">]=]</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos" data-line="509"></span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos" data-line="510"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_wikilink</span> <span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos" data-line="511"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">link</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos" data-line="512"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">display</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos" data-line="513"></span></a>			<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;[[&#39;</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">display</span><span class="p">,</span> <span class="s1">&#39;]]&#39;</span><span class="p">});</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos" data-line="514"></span></a>		<span class="kr">else</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos" data-line="515"></span></a>			<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;[[&#39;</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="s1">&#39;]]&#39;</span><span class="p">});</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos" data-line="516"></span></a>		<span class="kr">end</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos" data-line="517"></span></a>	<span class="kr">else</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos" data-line="518"></span></a>		<span class="kr">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos" data-line="519"></span></a>	<span class="kr">end</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos" data-line="520"></span></a><span class="kr">end</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos" data-line="521"></span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos" data-line="522"></span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos" data-line="523"></span></a><span class="cm">--[[--------------------------&lt; D I V _ M A R K U P _ A D D &gt;--------------------------------------------------</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos" data-line="524"></span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos" data-line="525"></span></a><span class="cm">Adds &lt;i&gt; and &lt;/i&gt; tags to list-item text or to implied &lt;p&gt;..&lt;/p&gt; text. Mixed not supported.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos" data-line="526"></span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos" data-line="527"></span></a><span class="cm">]]</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos" data-line="528"></span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos" data-line="529"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">div_markup_add</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos" data-line="530"></span></a>	<span class="kr">if</span> <span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;^</span><span class="se">\n</span><span class="s1">[%*:;#]&#39;</span><span class="p">)</span> <span class="kr">then</span>											<span class="c1">-- look for list markup; list markup must begin at start of text</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos" data-line="531"></span></a>		<span class="kr">if</span> <span class="s1">&#39;italic&#39;</span> <span class="o">==</span> <span class="n">style</span> <span class="kr">then</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos" data-line="532"></span></a>			<span class="kr">return</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;(</span><span class="se">\n</span><span class="s1">[%*:;#]+)([^</span><span class="se">\n</span><span class="s1">]+)&#39;</span><span class="p">,</span> <span class="s1">&#39;%1&lt;i&gt;%2&lt;/i&gt;&#39;</span><span class="p">);</span>			<span class="c1">-- insert italic markup at each list item</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos" data-line="533"></span></a>		<span class="kr">else</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos" data-line="534"></span></a>			<span class="kr">return</span> <span class="n">text</span><span class="p">;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos" data-line="535"></span></a>		<span class="kr">end</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos" data-line="536"></span></a>	<span class="kr">end</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos" data-line="537"></span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos" data-line="538"></span></a>	<span class="kr">if</span> <span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">+&#39;</span><span class="p">)</span> <span class="kr">then</span>													<span class="c1">-- look for any number of \n characters in text</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos" data-line="539"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;([^</span><span class="se">\n</span><span class="s1">])</span><span class="se">\n</span><span class="s1">([^</span><span class="se">\n</span><span class="s1">])&#39;</span><span class="p">,</span> <span class="s1">&#39;%1 %2&#39;</span><span class="p">);</span>							<span class="c1">-- replace single newline characters with a space character which mimics mediawiki</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos" data-line="540"></span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos" data-line="541"></span></a>		<span class="kr">if</span> <span class="s1">&#39;italic&#39;</span> <span class="o">==</span> <span class="n">style</span> <span class="kr">then</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos" data-line="542"></span></a>			<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span><span class="p">(</span><span class="s1">&#39;[^</span><span class="se">\n</span><span class="s1">]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;&lt;i&gt;%1&lt;/i&gt;&lt;/p&gt;&#39;</span><span class="p">);</span>						<span class="c1">-- insert p and italic markup tags at each impled p (two or more consecutive &#39;\n\n&#39; sequences)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos" data-line="543"></span></a>		<span class="kr">else</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos" data-line="544"></span></a>			<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;[^</span><span class="se">\n</span><span class="s1">]+&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;p&gt;%1&lt;/p&gt;&#39;</span><span class="p">);</span>							<span class="c1">-- insert p markup at each impled p</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos" data-line="545"></span></a>			<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>										<span class="c1">-- strip newline characters</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos" data-line="546"></span></a>		<span class="kr">end</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos" data-line="547"></span></a>	<span class="kr">end</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos" data-line="548"></span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos" data-line="549"></span></a>	<span class="kr">return</span> <span class="n">text</span><span class="p">;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos" data-line="550"></span></a><span class="kr">end</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos" data-line="551"></span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos" data-line="552"></span></a>
</span><span id="L-553"><a href="#L-553"><span class="linenos" data-line="553"></span></a><span class="cm">--[[--------------------------&lt; T I T L E _ W R A P P E R _ M A K E &gt;------------------------------------------</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos" data-line="554"></span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos" data-line="555"></span></a><span class="cm">Makes a &lt;span title=&quot;&lt;title text&gt;&quot;&gt;&lt;content_text&gt;&lt;/span&gt; or &lt;div title=&quot;&lt;title text&gt;&quot;&gt;&lt;content_text&gt;&lt;/div&gt; where</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos" data-line="556"></span></a><span class="cm">&lt;title text&gt; is in the tool-tip in the wiki&#39;s local language and &lt;content_text&gt; is non-local-language text in</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos" data-line="557"></span></a><span class="cm">html markup.  This because the lang= attibute applies to the content of its enclosing tag.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos" data-line="558"></span></a>
</span><span id="L-559"><a href="#L-559"><span class="linenos" data-line="559"></span></a><span class="cm">&lt;tag&gt; holds a string &#39;div&#39; or &#39;span&#39; used to choose the correct wrapping tag.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos" data-line="560"></span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos" data-line="561"></span></a><span class="cm">]]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos" data-line="562"></span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos" data-line="563"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">title_wrapper_make</span> <span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="n">content_text</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos" data-line="564"></span></a>	<span class="kd">local</span> <span class="n">wrapper_t</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos" data-line="565"></span></a>	
</span><span id="L-566"><a href="#L-566"><span class="linenos" data-line="566"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">}));</span>						<span class="c1">-- open opening wrapper tag</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos" data-line="567"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="s1">&#39; title=</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">);</span>										<span class="c1">-- begin title attribute</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos" data-line="568"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="n">title_text</span><span class="p">);</span>										<span class="c1">-- add &lt;title_text&gt;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos" data-line="569"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&gt;&#39;</span><span class="p">);</span>											<span class="c1">-- end title attribute and close opening wrapper tag</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos" data-line="570"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="n">content_text</span><span class="p">);</span>										<span class="c1">-- add &lt;content_text&gt;</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos" data-line="571"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;/&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">}));</span>					<span class="c1">-- add closing wrapper tag</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos" data-line="572"></span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos" data-line="573"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">wrapper_t</span><span class="p">);</span>											<span class="c1">-- make a big string and done</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos" data-line="574"></span></a><span class="kr">end</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos" data-line="575"></span></a>
</span><span id="L-576"><a href="#L-576"><span class="linenos" data-line="576"></span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos" data-line="577"></span></a><span class="cm">--[[--------------------------&lt; M A K E _ T E X T _ H T M L &gt;--------------------------------------------------</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos" data-line="578"></span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos" data-line="579"></span></a><span class="cm">Add the html markup to text according to the type of content that it is: &lt;span&gt; or &lt;i&gt; tags for inline content or</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos" data-line="580"></span></a><span class="cm">&lt;div&gt; tags for block content</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos" data-line="581"></span></a>
</span><span id="L-582"><a href="#L-582"><span class="linenos" data-line="582"></span></a><span class="cm">The lang= attribute also applies to the content of the tag where it is placed so this is wrong because &#39;Spanish</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos" data-line="583"></span></a><span class="cm">language text&#39; is English:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos" data-line="584"></span></a><span class="cm">	&lt;i lang=&quot;es&quot; title=&quot;Spanish language text&quot;&gt;casa&lt;/i&gt;</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos" data-line="585"></span></a><span class="cm">should be:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos" data-line="586"></span></a><span class="cm">	&lt;span title=&quot;Spanish language text&quot;&gt;&lt;i lang=&quot;es&quot;&gt;casa&lt;/i&gt;&lt;/span&gt;</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos" data-line="587"></span></a><span class="cm">or for &lt;div&gt;...&lt;/div&gt;:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos" data-line="588"></span></a><span class="cm">	&lt;div title=&quot;Spanish language text&quot;&gt;&lt;div lang=&quot;es&quot;&gt;&lt;spanish-language-text&gt;&lt;/div&gt;&lt;/div&gt;</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos" data-line="589"></span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos" data-line="590"></span></a><span class="cm">]]</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos" data-line="591"></span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos" data-line="592"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_text_html</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">rtl</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">language</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos" data-line="593"></span></a>	<span class="kd">local</span> <span class="n">html_t</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos" data-line="594"></span></a>	<span class="kd">local</span> <span class="n">style_added</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos" data-line="595"></span></a>	<span class="kd">local</span> <span class="n">wrapper_tag</span> <span class="o">=</span> <span class="n">tag</span><span class="p">;</span>													<span class="c1">-- &lt;tag&gt; gets modified so save a copy for use when/if we create a wrapper span or div</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos" data-line="596"></span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos" data-line="597"></span></a>	<span class="kr">if</span> <span class="n">text</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%*&#39;</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos" data-line="598"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="s1">&#39;&amp;#42;&#39;</span><span class="p">);</span>											<span class="c1">-- move proto language text prefix outside of italic markup if any; use numeric entity because plain splat confuses MediaWiki</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos" data-line="599"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>											<span class="c1">-- remove the splat from the text</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos" data-line="600"></span></a>	<span class="kr">end</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos" data-line="601"></span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos" data-line="602"></span></a>	<span class="kr">if</span> <span class="s1">&#39;span&#39;</span> <span class="o">==</span> <span class="n">tag</span> <span class="kr">then</span>														<span class="c1">-- default html tag for inline content</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos" data-line="603"></span></a>		<span class="kr">if</span> <span class="s1">&#39;italic&#39;</span> <span class="o">==</span> <span class="n">style</span> <span class="kr">then</span>												<span class="c1">-- but if italic</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos" data-line="604"></span></a>			<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span><span class="p">;</span>															<span class="c1">-- change to &lt;i&gt; tags</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos" data-line="605"></span></a>		<span class="kr">end</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos" data-line="606"></span></a>	<span class="kr">else</span>																		<span class="c1">-- must be div so go</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos" data-line="607"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">div_markup_add</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">style</span><span class="p">);</span>									<span class="c1">-- handle implied &lt;p&gt;, implied &lt;p&gt; with &lt;i&gt;, and list markup (*;:#) with &lt;i&gt;</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos" data-line="608"></span></a>	<span class="kr">end</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos" data-line="609"></span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos" data-line="610"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">}));</span>							<span class="c1">-- open the &lt;i&gt;, &lt;span&gt;, or &lt;div&gt; html tag</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos" data-line="611"></span></a>	<span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;%-x%-.*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>											<span class="c1">-- strip private use subtag from code tag because meaningless outside of wikipedia</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos" data-line="612"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39; lang=&quot;&#39;</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">}));</span>				<span class="c1">-- add language attribute</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos" data-line="613"></span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos" data-line="614"></span></a>	<span class="kr">if</span> <span class="p">(</span><span class="n">rtl</span> <span class="ow">or</span> <span class="n">unicode</span><span class="p">.</span><span class="n">is_rtl</span><span class="p">(</span><span class="n">text</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;ltr&#39;</span> <span class="o">==</span> <span class="n">this_wiki_lang_dir</span><span class="p">)</span> <span class="kr">then</span>		<span class="c1">-- text is right-to-left on a left-to-right wiki</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos" data-line="615"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="s1">&#39; dir=&quot;rtl&quot;&#39;</span><span class="p">);</span>									<span class="c1">-- add direction attribute for right-to-left languages</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos" data-line="616"></span></a>	<span class="kr">elseif</span> <span class="ow">not</span> <span class="p">(</span><span class="n">rtl</span> <span class="ow">or</span> <span class="n">unicode</span><span class="p">.</span><span class="n">is_rtl</span><span class="p">(</span><span class="n">text</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;rtl&#39;</span> <span class="o">==</span> <span class="n">this_wiki_lang_dir</span><span class="p">)</span> <span class="kr">then</span>	<span class="c1">-- text is left-to-right on a right-to-left wiki</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos" data-line="617"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="s1">&#39; dir=&quot;ltr&quot;&#39;</span><span class="p">);</span>									<span class="c1">-- add direction attribute for left-to-right languages</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos" data-line="618"></span></a>	<span class="kr">end</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos" data-line="619"></span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos" data-line="620"></span></a>	<span class="kr">if</span> <span class="s1">&#39;normal&#39;</span> <span class="o">==</span> <span class="n">style</span> <span class="kr">then</span>													<span class="c1">-- when |italic=no</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos" data-line="621"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="s1">&#39; style=</span><span class="se">\&quot;</span><span class="s1">font-style: normal;&#39;</span><span class="p">);</span>					<span class="c1">-- override external markup, if any</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos" data-line="622"></span></a>		<span class="n">style_added</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">;</span>														<span class="c1">-- remember that style attribute added and is not yet closed</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos" data-line="623"></span></a>	<span class="kr">end</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos" data-line="624"></span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos" data-line="625"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="kr">then</span>														<span class="c1">-- when |size=&lt;something&gt;</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos" data-line="626"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">style_added</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos" data-line="627"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39; font-size: &#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">}));</span>	<span class="c1">-- add when style attribute already inserted</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos" data-line="628"></span></a>		<span class="kr">else</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos" data-line="629"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39; style=</span><span class="se">\&quot;</span><span class="s1">font-size: &#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">}));</span>	<span class="c1">-- create style attribute</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos" data-line="630"></span></a>			<span class="n">style_added</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">;</span>													<span class="c1">-- remember that style attribute added and is not yet closed</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos" data-line="631"></span></a>		<span class="kr">end</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos" data-line="632"></span></a>	<span class="kr">end</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos" data-line="633"></span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos" data-line="634"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="n">style_added</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">}));</span>					<span class="c1">-- close the opening html tag</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos" data-line="635"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="n">text</span><span class="p">);</span>												<span class="c1">-- insert the text</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos" data-line="636"></span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos" data-line="637"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">html_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;/&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">}));</span>						<span class="c1">-- close the &#39;text&#39; &lt;i&gt;, &lt;span&gt;, or &lt;div&gt; html tag</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos" data-line="638"></span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos" data-line="639"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">language</span><span class="p">)</span> <span class="kr">then</span>													<span class="c1">-- create a &lt;title_text&gt; string for the title= attribute in a wrapper span or div</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos" data-line="640"></span></a>		<span class="kd">local</span> <span class="n">title_text</span><span class="p">;</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos" data-line="641"></span></a>			<span class="kr">if</span> <span class="s1">&#39;zxx&#39;</span> <span class="o">==</span> <span class="n">code</span> <span class="kr">then</span>												<span class="c1">-- special case for this tag &#39;no linguistic content&#39;</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos" data-line="642"></span></a>				<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">language</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_text_html_t</span><span class="p">.</span><span class="n">zxx</span><span class="p">});</span>	<span class="c1">-- not a language so don&#39;t use &#39;language&#39; in title text</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos" data-line="643"></span></a>			<span class="kr">elseif</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos" data-line="644"></span></a>				<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">language</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_text_html_t</span><span class="p">.</span><span class="n">collective</span><span class="p">});</span>	<span class="c1">-- for collective languages</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos" data-line="645"></span></a>			<span class="kr">else</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos" data-line="646"></span></a>				<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1-$2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">language</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">make_text_html_t</span><span class="p">.</span><span class="n">individual</span><span class="p">});</span>	<span class="c1">-- for individual languages</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos" data-line="647"></span></a>			<span class="kr">end</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos" data-line="648"></span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos" data-line="649"></span></a>		<span class="kr">return</span> <span class="n">title_wrapper_make</span> <span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">html_t</span><span class="p">),</span> <span class="n">wrapper_tag</span><span class="p">);</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos" data-line="650"></span></a>	<span class="kr">else</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos" data-line="651"></span></a>		<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">html_t</span><span class="p">);</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos" data-line="652"></span></a>	<span class="kr">end</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos" data-line="653"></span></a><span class="kr">end</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos" data-line="654"></span></a>
</span><span id="L-655"><a href="#L-655"><span class="linenos" data-line="655"></span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos" data-line="656"></span></a><span class="cm">--[=[-------------------------&lt; M A K E _ C A T E G O R Y &gt;----------------------------------------------------</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos" data-line="657"></span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos" data-line="658"></span></a><span class="cm">For individual language, &lt;language&gt;, returns:</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos" data-line="659"></span></a><span class="cm">	[[Category:Articles containing &lt;language&gt;-language text]]</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos" data-line="660"></span></a>
</span><span id="L-661"><a href="#L-661"><span class="linenos" data-line="661"></span></a><span class="cm">For English:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos" data-line="662"></span></a><span class="cm">	[[Category:Articles containing explicitly cited English-language text]]</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos" data-line="663"></span></a><span class="cm">	</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos" data-line="664"></span></a><span class="cm">For ISO 639-2 collective languages (and for 639-1 bh):</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos" data-line="665"></span></a><span class="cm">	[[Category:Articles with text in &lt;language&gt; languages]]</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos" data-line="666"></span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos" data-line="667"></span></a><span class="cm">]=]</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos" data-line="668"></span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos" data-line="669"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_category</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">nocat</span><span class="p">,</span> <span class="n">name_get</span><span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos" data-line="670"></span></a>	<span class="kr">if</span> <span class="p">((</span><span class="mi">0</span> <span class="o">~=</span> <span class="n">namespace</span><span class="p">)</span> <span class="ow">or</span> <span class="n">nocat</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name_get</span> <span class="kr">then</span>						<span class="c1">-- only categorize in article space</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos" data-line="671"></span></a>		<span class="kr">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>																<span class="c1">-- return empty string for concatenation</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos" data-line="672"></span></a>	<span class="kr">end</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos" data-line="673"></span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos" data-line="674"></span></a>	<span class="kr">if</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos" data-line="675"></span></a>		<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;[[$1 $2]]&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">collective_cat</span><span class="p">,</span> <span class="n">language_name</span><span class="p">});</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos" data-line="676"></span></a>	<span class="kr">end</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos" data-line="677"></span></a>		
</span><span id="L-678"><a href="#L-678"><span class="linenos" data-line="678"></span></a>	<span class="kr">if</span> <span class="n">this_wiki_lang_tag</span> <span class="o">==</span> <span class="n">code</span> <span class="kr">then</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos" data-line="679"></span></a>		<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;[[$1 $2 $3-$4]]&#39;</span><span class="p">,</span> <span class="p">{</span>									<span class="c1">-- unique category name for the local language</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos" data-line="680"></span></a>			<span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">cat_prefix</span><span class="p">,</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos" data-line="681"></span></a>			<span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">explicit_cat</span><span class="p">,</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos" data-line="682"></span></a>			<span class="n">language_name</span><span class="p">,</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos" data-line="683"></span></a>			<span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">cat_postfix</span><span class="p">,</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos" data-line="684"></span></a>			<span class="p">});</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos" data-line="685"></span></a>	<span class="kr">else</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos" data-line="686"></span></a>		<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;[[$1 $2-$3]]&#39;</span><span class="p">,</span> <span class="p">{</span>									<span class="c1">-- category for individual languages</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos" data-line="687"></span></a>			<span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">cat_prefix</span><span class="p">,</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos" data-line="688"></span></a>			<span class="n">language_name</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos" data-line="689"></span></a>			<span class="n">cfg</span><span class="p">.</span><span class="n">make_category_t</span><span class="p">.</span><span class="n">cat_postfix</span><span class="p">,</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos" data-line="690"></span></a>			<span class="p">});</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos" data-line="691"></span></a>	<span class="kr">end</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos" data-line="692"></span></a><span class="kr">end</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos" data-line="693"></span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos" data-line="694"></span></a>
</span><span id="L-695"><a href="#L-695"><span class="linenos" data-line="695"></span></a><span class="cm">--[[--------------------------&lt; M A K E _ T R A N S L I T &gt;----------------------------------------------------</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos" data-line="696"></span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos" data-line="697"></span></a><span class="cm">Return translit &lt;i lang=xx-Latn&gt;...&lt;/i&gt; where xx is the language code; else return empty string.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos" data-line="698"></span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos" data-line="699"></span></a><span class="cm">The value |script= is not used in {{transliteration}} for this purpose; instead it uses |code.  Because language scripts</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos" data-line="700"></span></a><span class="cm">are listed in the {{transliteration}} switches they are included in the data tables.  The script parameter is introduced</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos" data-line="701"></span></a><span class="cm">at {{Language with name and transliteration}}.  If |script= is set, this function uses it in preference to code.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos" data-line="702"></span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos" data-line="703"></span></a><span class="cm">To avoid confusion, in this module and the templates that use it, the transliteration script parameter is renamed</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos" data-line="704"></span></a><span class="cm">to be |translit-script= (in this function, tscript).</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos" data-line="705"></span></a>
</span><span id="L-706"><a href="#L-706"><span class="linenos" data-line="706"></span></a><span class="cm">This function is used by both lang_xx() and transl()</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos" data-line="707"></span></a><span class="cm">	lang_xx() always provides code, language_name, and translit; may provide tscript; never provides style</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos" data-line="708"></span></a><span class="cm">	transl() always provides language_name, translit, and one of code or tscript, never both; always provides style</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos" data-line="709"></span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos" data-line="710"></span></a><span class="cm">For {{transliteration}}, style only applies when a language code is provided.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos" data-line="711"></span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos" data-line="712"></span></a><span class="cm">]]</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos" data-line="713"></span></a>
</span><span id="L-714"><a href="#L-714"><span class="linenos" data-line="714"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">make_translit</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">translit</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">tscript</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="n">engvar</span><span class="p">)</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos" data-line="715"></span></a>	<span class="kd">local</span> <span class="n">title_t</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">translit_title_table</span><span class="p">;</span>								<span class="c1">-- table of transliteration standards and the language codes and scripts that apply to those standards</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos" data-line="716"></span></a>	<span class="kd">local</span> <span class="n">title_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>														<span class="c1">-- tool tip text for title= attribute</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos" data-line="717"></span></a>	
</span><span id="L-718"><a href="#L-718"><span class="linenos" data-line="718"></span></a>	<span class="n">std</span> <span class="o">=</span> <span class="n">std</span> <span class="ow">and</span> <span class="n">std</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>													<span class="c1">-- lower case for table indexing</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos" data-line="719"></span></a>	
</span><span id="L-720"><a href="#L-720"><span class="linenos" data-line="720"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">tscript</span><span class="p">)</span> <span class="kr">then</span>							<span class="c1">-- when neither standard nor script specified</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos" data-line="721"></span></a>		<span class="n">title_text</span> <span class="o">=</span> <span class="n">language_name</span><span class="p">;</span>												<span class="c1">-- write a generic tool tip</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos" data-line="722"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>		<span class="c1">-- collective language names (plural &#39;languages&#39; is part of the name)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos" data-line="723"></span></a>			<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1-$2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">title_text</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">language</span><span class="p">});</span>	<span class="c1">-- skip this text (individual and macro languages only)</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos" data-line="724"></span></a>		<span class="kr">end</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos" data-line="725"></span></a>		<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">title_text</span><span class="p">,</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">lower</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">engvar_t</span><span class="p">[</span><span class="n">engvar</span><span class="p">][</span><span class="s1">&#39;romanisz_lc&#39;</span><span class="p">])});</span>	<span class="c1">-- finish the tool tip; use romanization when neither script nor standard supplied</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos" data-line="726"></span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos" data-line="727"></span></a>	<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">tscript</span><span class="p">)</span> <span class="kr">then</span>								<span class="c1">-- when both are specified</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos" data-line="728"></span></a>		<span class="kr">if</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">]</span> <span class="kr">then</span>													<span class="c1">-- and if standard is legitimate</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos" data-line="729"></span></a>			<span class="kr">if</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="n">tscript</span><span class="p">]</span> <span class="kr">then</span>										<span class="c1">-- and if script for that standard is legitimate</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos" data-line="730"></span></a>				<span class="kr">if</span> <span class="n">script_table</span><span class="p">[</span><span class="n">tscript</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos" data-line="731"></span></a>					<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1$2 ($3 $4) $5&#39;</span><span class="p">,</span> <span class="p">{</span>				<span class="c1">-- add the appropriate text to the tool tip</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos" data-line="732"></span></a>						<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos" data-line="733"></span></a>						<span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="n">tscript</span><span class="p">:</span><span class="n">lower</span><span class="p">()],</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos" data-line="734"></span></a>						<span class="n">script_table</span><span class="p">[</span><span class="n">tscript</span><span class="p">],</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos" data-line="735"></span></a>						<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">script</span><span class="p">,</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos" data-line="736"></span></a>						<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">,</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos" data-line="737"></span></a>						<span class="p">});</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos" data-line="738"></span></a>				<span class="kr">else</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos" data-line="739"></span></a>					<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_text</span> <span class="o">..</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">];</span>			<span class="c1">-- use the default if script not in std table; TODO: maint cat? error message because script not found for this standard?</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos" data-line="740"></span></a>				<span class="kr">end</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos" data-line="741"></span></a>			<span class="kr">else</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos" data-line="742"></span></a>				<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_text</span> <span class="o">..</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">];</span>				<span class="c1">-- use the default if script not in std table; TODO: maint cat? error message because script not found for this standard?</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos" data-line="743"></span></a>			<span class="kr">end</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos" data-line="744"></span></a>		<span class="kr">else</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos" data-line="745"></span></a>			<span class="kr">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>															<span class="c1">-- invalid standard, setup for error message</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos" data-line="746"></span></a>		<span class="kr">end</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos" data-line="747"></span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos" data-line="748"></span></a>	<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">std</span><span class="p">)</span> <span class="kr">then</span>													<span class="c1">-- translit-script not set, use language code</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos" data-line="749"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">]</span> <span class="kr">then</span> <span class="kr">return</span> <span class="s1">&#39;&#39;</span><span class="p">;</span> <span class="kr">end</span>									<span class="c1">-- invalid standard, setup for error message</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos" data-line="750"></span></a>		
</span><span id="L-751"><a href="#L-751"><span class="linenos" data-line="751"></span></a>		<span class="kr">if</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>												<span class="c1">-- if language code is in the table (transl may not provide a language code)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos" data-line="752"></span></a>			<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1$2 ($3 $4) $5&#39;</span><span class="p">,</span> <span class="p">{</span>						<span class="c1">-- add the appropriate text to the tool tip</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos" data-line="753"></span></a>				<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos" data-line="754"></span></a>				<span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">()],</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos" data-line="755"></span></a>				<span class="n">language_name</span><span class="p">,</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos" data-line="756"></span></a>				<span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">language</span><span class="p">,</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos" data-line="757"></span></a>				<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">,</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos" data-line="758"></span></a>				<span class="p">});</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos" data-line="759"></span></a>		<span class="kr">else</span>																	<span class="c1">-- code doesn&#39;t match</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos" data-line="760"></span></a>			<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_text</span> <span class="o">..</span> <span class="n">title_t</span><span class="p">[</span><span class="n">std</span><span class="p">][</span><span class="s1">&#39;default&#39;</span><span class="p">];</span>					<span class="c1">-- so use the standard&#39;s default</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos" data-line="761"></span></a>		<span class="kr">end</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos" data-line="762"></span></a>
</span><span id="L-763"><a href="#L-763"><span class="linenos" data-line="763"></span></a>	<span class="kr">else</span>																		<span class="c1">-- here if translit-script set but translit-std not set</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos" data-line="764"></span></a>		<span class="kr">if</span> <span class="n">title_t</span><span class="p">[</span><span class="s1">&#39;no_std&#39;</span><span class="p">][</span><span class="n">tscript</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos" data-line="765"></span></a>			<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_text</span> <span class="o">..</span> <span class="n">title_t</span><span class="p">[</span><span class="s1">&#39;no_std&#39;</span><span class="p">][</span><span class="n">tscript</span><span class="p">];</span>				<span class="c1">-- use translit-script if set</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos" data-line="766"></span></a>		<span class="kr">elseif</span> <span class="n">title_t</span><span class="p">[</span><span class="s1">&#39;no_std&#39;</span><span class="p">][</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos" data-line="767"></span></a>			<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_text</span> <span class="o">..</span> <span class="n">title_t</span><span class="p">[</span><span class="s1">&#39;no_std&#39;</span><span class="p">][</span><span class="n">code</span><span class="p">];</span>					<span class="c1">-- use language code</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos" data-line="768"></span></a>		<span class="kr">else</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos" data-line="769"></span></a>			<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">tscript</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos" data-line="770"></span></a>				<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1$2-$3 $4&#39;</span><span class="p">,</span> <span class="p">{</span>						<span class="c1">-- write a script tool tip</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos" data-line="771"></span></a>					<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos" data-line="772"></span></a>					<span class="n">language_name</span><span class="p">,</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos" data-line="773"></span></a>					<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">script</span><span class="p">,</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos" data-line="774"></span></a>					<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">,</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos" data-line="775"></span></a>					<span class="p">});</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos" data-line="776"></span></a>
</span><span id="L-777"><a href="#L-777"><span class="linenos" data-line="777"></span></a>			<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos" data-line="778"></span></a>				<span class="kr">if</span> <span class="ow">not</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>	<span class="c1">-- collective language names (plural &#39;languages&#39; is part of the name)</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos" data-line="779"></span></a>					<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1-$2&#39;</span><span class="p">,</span> <span class="p">{</span>							<span class="c1">-- skip this text (individual and macro languages only)</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos" data-line="780"></span></a>						<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos" data-line="781"></span></a>						<span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">language</span><span class="p">,</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos" data-line="782"></span></a>						<span class="p">});</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos" data-line="783"></span></a>				<span class="kr">end</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos" data-line="784"></span></a>					<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span>							<span class="c1">-- finish the tool tip</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos" data-line="785"></span></a>						<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos" data-line="786"></span></a>						<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">,</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos" data-line="787"></span></a>						<span class="p">});</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos" data-line="788"></span></a>			<span class="kr">else</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos" data-line="789"></span></a>					<span class="n">title_text</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span>							<span class="c1">-- generic tool tip (can we ever get here?)</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos" data-line="790"></span></a>						<span class="n">title_text</span><span class="p">,</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos" data-line="791"></span></a>						<span class="n">cfg</span><span class="p">.</span><span class="n">make_translit_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">,</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos" data-line="792"></span></a>						<span class="p">});</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos" data-line="793"></span></a>			<span class="kr">end</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos" data-line="794"></span></a>		<span class="kr">end</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos" data-line="795"></span></a>	<span class="kr">end</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos" data-line="796"></span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos" data-line="797"></span></a>	<span class="kd">local</span> <span class="n">tag</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos" data-line="798"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">code</span><span class="p">)</span> <span class="kr">then</span>														<span class="c1">-- when a language code is provided (always with {{lang-??}} templates, not always with {{transliteration}})</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos" data-line="799"></span></a>		<span class="n">code</span> <span class="o">=</span> <span class="n">code</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^(%a%a%a?)&#39;</span><span class="p">);</span>										<span class="c1">-- strip all subtags leaving only the language subtag</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos" data-line="800"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">style</span> <span class="kr">then</span>														<span class="c1">-- nil for the default italic style</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos" data-line="801"></span></a>			<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;&lt;i lang=&quot;%s-Latn&quot;&gt;%s&lt;/i&gt;&#39;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos" data-line="802"></span></a>		<span class="kr">else</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos" data-line="803"></span></a>			<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;&lt;span style=&quot;font-style: %s&quot; lang=&quot;%s-Latn&quot;&gt;%s&lt;/span&gt;&#39;</span>		<span class="c1">-- non-standard style, construct a span tag for it</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos" data-line="804"></span></a>			<span class="n">tag</span> <span class="o">=</span> <span class="nb">string.format</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">style</span><span class="p">,</span> <span class="s2">&quot;%s&quot;</span><span class="p">,</span> <span class="s2">&quot;%s&quot;</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos" data-line="805"></span></a>		<span class="kr">end</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos" data-line="806"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="nb">string.format</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="s2">&quot;%s&quot;</span><span class="p">)</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos" data-line="807"></span></a>	<span class="kr">else</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos" data-line="808"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;&lt;span&gt;%s&lt;/span&gt;&#39;</span>													<span class="c1">-- when no language code: no lang= attribute, not italic ({{transliteration}} only)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos" data-line="809"></span></a>	<span class="kr">end</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos" data-line="810"></span></a>	
</span><span id="L-811"><a href="#L-811"><span class="linenos" data-line="811"></span></a>	<span class="n">tag</span> <span class="o">=</span> <span class="nb">string.format</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">translit</span><span class="p">)</span>											<span class="c1">-- add the translit text</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos" data-line="812"></span></a>	<span class="kr">if</span> <span class="s1">&#39;&#39;</span> <span class="o">==</span> <span class="n">title_text</span> <span class="kr">then</span>													<span class="c1">-- when there is no need for a tool-tip</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos" data-line="813"></span></a>		<span class="kr">return</span> <span class="n">tag</span><span class="p">;</span>																<span class="c1">-- done</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos" data-line="814"></span></a>	<span class="kr">else</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos" data-line="815"></span></a>		<span class="n">title_text</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">engvar_sel_t</span><span class="p">.</span><span class="n">gb</span> <span class="o">==</span> <span class="n">engvar</span> <span class="ow">and</span> <span class="n">title_text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;([Rr]omani)z&#39;</span><span class="p">,</span> <span class="s1">&#39;%1s&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">title_text</span><span class="p">;</span>	<span class="c1">-- gb eng when engvar specifies gb eng; us eng else</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos" data-line="816"></span></a>		<span class="kr">return</span> <span class="n">title_wrapper_make</span> <span class="p">(</span><span class="n">title_text</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="s1">&#39;span&#39;</span><span class="p">);</span>					<span class="c1">-- wrap with a tool-tip span and done</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos" data-line="817"></span></a>	<span class="kr">end</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos" data-line="818"></span></a><span class="kr">end</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos" data-line="819"></span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos" data-line="820"></span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos" data-line="821"></span></a><span class="cm">--[[--------------------------&lt; V A L I D A T E _ T E X T &gt;----------------------------------------------------</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos" data-line="822"></span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos" data-line="823"></span></a><span class="cm">This function checks the content of args.text and returns empty string if nothing is amiss else it returns an</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos" data-line="824"></span></a><span class="cm">error message. The tests are for empty or missing text and for improper or disallowed use of apostrophe markup.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos" data-line="825"></span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos" data-line="826"></span></a><span class="cm">Italic rendering is controlled by the |italic= template parameter so italic markup should never appear in args.text</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos" data-line="827"></span></a><span class="cm">either as &#39;&#39;itself&#39;&#39; or as &#39;&#39;&#39;&#39;&#39;bold italic&#39;&#39;&#39;&#39;&#39; unless |italic=unset or |italic=invert.</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos" data-line="828"></span></a>
</span><span id="L-829"><a href="#L-829"><span class="linenos" data-line="829"></span></a><span class="cm">]]</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos" data-line="830"></span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos" data-line="831"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">validate_text</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos" data-line="832"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos" data-line="833"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">validate_text_t</span><span class="p">.</span><span class="n">no_text</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos" data-line="834"></span></a>	<span class="kr">end</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos" data-line="835"></span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos" data-line="836"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s2">&quot;%f[</span><span class="se">\&#39;</span><span class="s2">]</span><span class="se">\&#39;\&#39;\&#39;\&#39;</span><span class="s2">%f[^</span><span class="se">\&#39;</span><span class="s2">]&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;\&#39;\&#39;\&#39;\&#39;</span><span class="s2">[</span><span class="se">\&#39;</span><span class="s2">]+&quot;</span><span class="p">)</span> <span class="kr">then</span>	<span class="c1">-- because we&#39;re looking, look for 4 appostrophes or 6+ appostrophes</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos" data-line="837"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">validate_text_t</span><span class="p">.</span><span class="n">malformed_markup</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos" data-line="838"></span></a>	<span class="kr">end</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos" data-line="839"></span></a>
</span><span id="L-840"><a href="#L-840"><span class="linenos" data-line="840"></span></a>	<span class="kd">local</span> <span class="n">style</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">;</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos" data-line="841"></span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos" data-line="842"></span></a>	<span class="kr">if</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">unset</span> <span class="o">~=</span> <span class="n">style</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">invert</span> <span class="o">~=</span><span class="n">style</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos" data-line="843"></span></a>		<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s2">&quot;%f[</span><span class="se">\&#39;</span><span class="s2">]</span><span class="se">\&#39;\&#39;</span><span class="s2">%f[^</span><span class="se">\&#39;</span><span class="s2">]&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s2">&quot;%f[</span><span class="se">\&#39;</span><span class="s2">]</span><span class="se">\&#39;\&#39;\&#39;\&#39;\&#39;</span><span class="s2">%f[^</span><span class="se">\&#39;</span><span class="s2">]&quot;</span><span class="p">)</span> <span class="kr">then</span>	<span class="c1">-- italic but not bold, or bold italic</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos" data-line="844"></span></a>			<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">validate_text_t</span><span class="p">.</span><span class="n">italic_markup</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos" data-line="845"></span></a>		<span class="kr">end</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos" data-line="846"></span></a>	<span class="kr">end</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos" data-line="847"></span></a><span class="kr">end</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos" data-line="848"></span></a>
</span><span id="L-849"><a href="#L-849"><span class="linenos" data-line="849"></span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos" data-line="850"></span></a><span class="cm">--[[--------------------------&lt; R E N D E R _ M A I N T &gt;------------------------------------------------------</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos" data-line="851"></span></a>
</span><span id="L-852"><a href="#L-852"><span class="linenos" data-line="852"></span></a><span class="cm">Render mainenance messages and categories.</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos" data-line="853"></span></a>
</span><span id="L-854"><a href="#L-854"><span class="linenos" data-line="854"></span></a><span class="cm">]]</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos" data-line="855"></span></a>
</span><span id="L-856"><a href="#L-856"><span class="linenos" data-line="856"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">render_maint</span> <span class="p">(</span><span class="n">nocat</span><span class="p">)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos" data-line="857"></span></a>	<span class="kd">local</span> <span class="n">maint</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos" data-line="858"></span></a>	
</span><span id="L-859"><a href="#L-859"><span class="linenos" data-line="859"></span></a>	<span class="kr">if</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="o">#</span><span class="n">maint_msgs</span> <span class="kr">then</span>														<span class="c1">-- when there are maintenance messages</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos" data-line="860"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&lt;span class=&quot;lang-comment&quot; style=&quot;font-style: normal; display: none; color: #33aa33; margin-left: 0.3em;&quot;&gt;&#39;</span><span class="p">}));</span>	<span class="c1">-- opening &lt;span&gt; tag</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos" data-line="861"></span></a>		<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">msg</span> <span class="kr">in</span> <span class="nb">ipairs</span> <span class="p">(</span><span class="n">maint_msgs</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos" data-line="862"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="n">msg</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">}));</span>					<span class="c1">-- add message strings</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos" data-line="863"></span></a>		<span class="kr">end</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos" data-line="864"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint</span><span class="p">,</span> <span class="s1">&#39;&lt;/span&gt;&#39;</span><span class="p">);</span>										<span class="c1">-- close the span</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos" data-line="865"></span></a>	<span class="kr">end</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos" data-line="866"></span></a>	
</span><span id="L-867"><a href="#L-867"><span class="linenos" data-line="867"></span></a>	<span class="kr">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="o">#</span><span class="n">maint_cats</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="mi">0</span> <span class="o">==</span> <span class="n">namespace</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nocat</span> <span class="kr">then</span>				<span class="c1">-- when there are maintenance categories; article namespace only</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos" data-line="868"></span></a>		<span class="kr">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">cat</span> <span class="kr">in</span> <span class="nb">ipairs</span> <span class="p">(</span><span class="n">maint_cats</span><span class="p">)</span> <span class="kr">do</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos" data-line="869"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;[[Category:&#39;</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="s1">&#39;]]&#39;</span><span class="p">}));</span>	<span class="c1">-- format and add the categories</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos" data-line="870"></span></a>		<span class="kr">end</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos" data-line="871"></span></a>	<span class="kr">end</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos" data-line="872"></span></a>	
</span><span id="L-873"><a href="#L-873"><span class="linenos" data-line="873"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">maint</span><span class="p">);</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos" data-line="874"></span></a><span class="kr">end</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos" data-line="875"></span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos" data-line="876"></span></a>
</span><span id="L-877"><a href="#L-877"><span class="linenos" data-line="877"></span></a><span class="cm">--[[--------------------------&lt; P R O T O _ P R E F I X &gt;------------------------------------------------------</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos" data-line="878"></span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos" data-line="879"></span></a><span class="cm">For proto languages, text is prefixed with a splat. We do that here as a flag for make_text_html() so that a splat</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos" data-line="880"></span></a><span class="cm">will be rendered outside of italic markup (if used). If the first character in text here is already a splat, we</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos" data-line="881"></span></a><span class="cm">do nothing.</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos" data-line="882"></span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos" data-line="883"></span></a><span class="cm">proto_param is boolean or nil; true adds splat prefix regardless of language name; false removes and inhibits</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos" data-line="884"></span></a><span class="cm">regardless of language name; nil does nothing; presumes that the value in text is correct but removes extra splac.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos" data-line="885"></span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos" data-line="886"></span></a><span class="cm">]]</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos" data-line="887"></span></a>
</span><span id="L-888"><a href="#L-888"><span class="linenos" data-line="888"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">proto_prefix</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">proto_param</span><span class="p">)</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos" data-line="889"></span></a>	<span class="kr">if</span> <span class="kc">false</span> <span class="o">==</span> <span class="n">proto_param</span> <span class="kr">then</span>												<span class="c1">-- when forced by |proto=no</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos" data-line="890"></span></a>		<span class="kr">return</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%**&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>											<span class="c1">-- return text without splat prefix regardless of language name or existing splat prefix in text</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos" data-line="891"></span></a>	<span class="kr">elseif</span> <span class="p">(</span><span class="n">language_name</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;^Proto%-&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="kc">true</span> <span class="o">==</span> <span class="n">proto_param</span><span class="p">))</span> <span class="kr">then</span>		<span class="c1">-- language is a proto or forced by |proto=yes</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos" data-line="892"></span></a>		<span class="kr">return</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%**&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">);</span>											<span class="c1">-- prefix proto-language text with a splat; also removes duplicate prefixing splats</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos" data-line="893"></span></a>	<span class="kr">end</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos" data-line="894"></span></a>	
</span><span id="L-895"><a href="#L-895"><span class="linenos" data-line="895"></span></a>	<span class="kr">return</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%*+&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">);</span>												<span class="c1">-- return text unmolested except multiple splats reduced to one splat</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos" data-line="896"></span></a><span class="kr">end</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos" data-line="897"></span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos" data-line="898"></span></a>
</span><span id="L-899"><a href="#L-899"><span class="linenos" data-line="899"></span></a><span class="cm">--[[--------------------------&lt; H A S _ P O E M _ T A G &gt;------------------------------------------------------</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos" data-line="900"></span></a>
</span><span id="L-901"><a href="#L-901"><span class="linenos" data-line="901"></span></a><span class="cm">Looks for a poem strip marker in text; returns true when found; false else.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos" data-line="902"></span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos" data-line="903"></span></a><span class="cm">Auto-italic detection disabled when text has poem stripmarker because it is not possible for this code to know</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos" data-line="904"></span></a><span class="cm">the content that will replace the stripmarker.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos" data-line="905"></span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos" data-line="906"></span></a><span class="cm">]]</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos" data-line="907"></span></a>
</span><span id="L-908"><a href="#L-908"><span class="linenos" data-line="908"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">has_poem_tag</span> <span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos" data-line="909"></span></a>	<span class="kr">return</span> <span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\127</span><span class="s1">[^</span><span class="se">\127</span><span class="s1">]*UNIQ%-%-poem%-[%a%d]+%-QINU[^</span><span class="se">\127</span><span class="s1">]*</span><span class="se">\127</span><span class="s1">&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="kc">true</span> <span class="ow">or</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos" data-line="910"></span></a><span class="kr">end</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos" data-line="911"></span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos" data-line="912"></span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos" data-line="913"></span></a><span class="cm">--[[--------------------------&lt; H T M L _ T A G _ S E L E C T &gt;------------------------------------------------</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos" data-line="914"></span></a>
</span><span id="L-915"><a href="#L-915"><span class="linenos" data-line="915"></span></a><span class="cm">Inspects content of and selectively trims text.  Returns text and the name of an appropriate html tag for text.</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos" data-line="916"></span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos" data-line="917"></span></a><span class="cm">If text contains:</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos" data-line="918"></span></a><span class="cm">	\n\n	text has implied &lt;p&gt;..&lt;/p&gt; tags - trim leading and trailing whitespace and return </span>
</span><span id="L-919"><a href="#L-919"><span class="linenos" data-line="919"></span></a><span class="cm">If text begins with list markup:</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos" data-line="920"></span></a><span class="cm">	\n*		unordered</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos" data-line="921"></span></a><span class="cm">	\n;		definition</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos" data-line="922"></span></a><span class="cm">	\n:		definition</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos" data-line="923"></span></a><span class="cm">	\n#		ordered</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos" data-line="924"></span></a><span class="cm">trim all leading whitespace except  \n and trim all trailing whitespace</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos" data-line="925"></span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos" data-line="926"></span></a><span class="cm">If text contains &lt;poem&gt;...&lt;/poem&gt; stripmarker, return text unmodified and choose &lt;div&gt;..&lt;/div&gt; tags because </span>
</span><span id="L-927"><a href="#L-927"><span class="linenos" data-line="927"></span></a><span class="cm">the stripmarker is replaced with text wrapped in &lt;div&gt;..&lt;/div&gt; tags.</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos" data-line="928"></span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos" data-line="929"></span></a><span class="cm">If the text contains any actual &lt;div&gt;...&lt;/div&gt; tags, then it&#39;s again returned unmodified and &lt;div&gt;...&lt;/div&gt;</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos" data-line="930"></span></a><span class="cm">tags are used to wrap it, to prevent div/span inversion.</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos" data-line="931"></span></a>
</span><span id="L-932"><a href="#L-932"><span class="linenos" data-line="932"></span></a><span class="cm">]]</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos" data-line="933"></span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos" data-line="934"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">html_tag_select</span> <span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos" data-line="935"></span></a>	<span class="kd">local</span> <span class="n">tag</span><span class="p">;</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos" data-line="936"></span></a>	
</span><span id="L-937"><a href="#L-937"><span class="linenos" data-line="937"></span></a>	<span class="kr">if</span> <span class="n">has_poem_tag</span> <span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="kr">then</span>													<span class="c1">-- contains poem stripmarker (we can&#39;t know the content of that)</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos" data-line="938"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span>															<span class="c1">-- poem replacement is in div tags so lang must use div tags</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos" data-line="939"></span></a>	<span class="kr">elseif</span> <span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;&lt;div&#39;</span><span class="p">)</span> <span class="kr">then</span>												<span class="c1">-- reductive; if the text contains a div tag, we must use div tags</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos" data-line="940"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos" data-line="941"></span></a>	<span class="kr">elseif</span> <span class="n">mw</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">trim</span> <span class="p">(</span><span class="n">text</span><span class="p">):</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">+&#39;</span><span class="p">)</span> <span class="kr">then</span>								<span class="c1">-- contains implied p tags</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos" data-line="942"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">trim</span> <span class="p">(</span><span class="n">text</span><span class="p">);</span>												<span class="c1">-- trim leading and trailing whitespace characters</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos" data-line="943"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span>															<span class="c1">-- must be div because span may not contain p tags (added later by MediaWiki); poem replacement is in div tags</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos" data-line="944"></span></a>	<span class="kr">elseif</span> <span class="n">text</span><span class="p">:</span><span class="n">find</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">[%*:;%#]&#39;</span><span class="p">)</span> <span class="kr">then</span>										<span class="c1">-- if text has list markup</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos" data-line="945"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^[</span><span class="se">\t\r\f</span><span class="s1"> ]*&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;%s*$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>					<span class="c1">-- trim all whitespace except leading newline character &#39;\n&#39;</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos" data-line="946"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span>															<span class="c1">-- must be div because span may not contain ul, dd, dl, ol tags (added later by MediaWiki)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos" data-line="947"></span></a>	<span class="kr">else</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos" data-line="948"></span></a>		<span class="n">text</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">trim</span> <span class="p">(</span><span class="n">text</span><span class="p">);</span>												<span class="c1">-- plain text</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos" data-line="949"></span></a>		<span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;span&#39;</span><span class="p">;</span>															<span class="c1">-- so span is fine</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos" data-line="950"></span></a>	<span class="kr">end</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos" data-line="951"></span></a>	
</span><span id="L-952"><a href="#L-952"><span class="linenos" data-line="952"></span></a>	<span class="kr">return</span> <span class="n">text</span><span class="p">,</span> <span class="n">tag</span><span class="p">;</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos" data-line="953"></span></a><span class="kr">end</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos" data-line="954"></span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos" data-line="955"></span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos" data-line="956"></span></a><span class="cm">--[[--------------------------&lt; V A L I D A T E _ P R O T O &gt;--------------------------------------------------</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos" data-line="957"></span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos" data-line="958"></span></a><span class="cm">Validates value assigned to |proto=; permitted values are yes and no; yes returns as true, no returns as false,</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos" data-line="959"></span></a><span class="cm">empty string (or parameter omitted) returns as nil; any other value returns nil with &lt;proto_param&gt; as second</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos" data-line="960"></span></a><span class="cm">return value for use in error message.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos" data-line="961"></span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos" data-line="962"></span></a><span class="cm">]]</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos" data-line="963"></span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos" data-line="964"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">validate_proto</span> <span class="p">(</span><span class="n">proto_param</span><span class="p">)</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos" data-line="965"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span> <span class="o">==</span> <span class="n">proto_param</span> <span class="kr">then</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos" data-line="966"></span></a>		<span class="kr">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos" data-line="967"></span></a>	<span class="kr">elseif</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">negative</span> <span class="o">==</span> <span class="n">proto_param</span> <span class="kr">then</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos" data-line="968"></span></a>		<span class="kr">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos" data-line="969"></span></a>	<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">proto_param</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos" data-line="970"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">proto_param</span><span class="p">;</span>												<span class="c1">-- |proto= something other than &#39;yes&#39; or &#39;no&#39;</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos" data-line="971"></span></a>	<span class="kr">else</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos" data-line="972"></span></a>		<span class="kr">return</span> <span class="kc">nil</span><span class="p">;</span>																<span class="c1">-- missing or empty</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos" data-line="973"></span></a>	<span class="kr">end</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos" data-line="974"></span></a><span class="kr">end</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos" data-line="975"></span></a>
</span><span id="L-976"><a href="#L-976"><span class="linenos" data-line="976"></span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos" data-line="977"></span></a><span class="cm">--[[--------------------------&lt; L A N G U A G E _ N A M E _ G E T &gt;--------------------------------------------</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos" data-line="978"></span></a>
</span><span id="L-979"><a href="#L-979"><span class="linenos" data-line="979"></span></a><span class="cm">Common function to return language name from the data set according to IETF tag.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos" data-line="980"></span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos" data-line="981"></span></a><span class="cm">Returns language name if found in data tables; nil else.</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos" data-line="982"></span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos" data-line="983"></span></a><span class="cm">]]</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos" data-line="984"></span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos" data-line="985"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">language_name_get</span> <span class="p">(</span><span class="n">ietf</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">cat</span><span class="p">)</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos" data-line="986"></span></a>	<span class="n">ietf</span> <span class="o">=</span> <span class="n">ietf</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>														<span class="c1">-- ietf:lower() because format_ietf_tag() returns mixed case</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos" data-line="987"></span></a>	
</span><span id="L-988"><a href="#L-988"><span class="linenos" data-line="988"></span></a>	<span class="kd">local</span> <span class="n">name</span><span class="p">;</span>																	<span class="c1">-- remains nil if not found</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos" data-line="989"></span></a>	
</span><span id="L-990"><a href="#L-990"><span class="linenos" data-line="990"></span></a>	<span class="kr">if</span> <span class="n">override_table</span><span class="p">[</span><span class="n">ietf</span><span class="p">]</span> <span class="kr">then</span>												<span class="c1">-- look for whole IETF tag in override table</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos" data-line="991"></span></a>		<span class="n">name</span> <span class="o">=</span> <span class="n">override_table</span><span class="p">[</span><span class="n">ietf</span><span class="p">];</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos" data-line="992"></span></a>	<span class="kr">elseif</span> <span class="n">override_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- not there so try basic language tag</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos" data-line="993"></span></a>		<span class="n">name</span> <span class="o">=</span> <span class="n">override_table</span><span class="p">[</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos" data-line="994"></span></a>	<span class="kr">elseif</span> <span class="n">lang_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>												<span class="c1">-- shift to iana active tag/name table</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos" data-line="995"></span></a>		<span class="n">name</span> <span class="o">=</span> <span class="n">lang_table</span><span class="p">[</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos" data-line="996"></span></a>	<span class="kr">elseif</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- try the iana deprecated tag/name table</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos" data-line="997"></span></a>		<span class="n">name</span> <span class="o">=</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos" data-line="998"></span></a>	<span class="kr">end</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos" data-line="999"></span></a>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos" data-line="1000"></span></a>	<span class="kr">if</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="ow">and</span> <span class="n">cat</span> <span class="kr">then</span>										<span class="c1">-- because deprecated code may have been overridden to en.wiki preferred name</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos" data-line="1001"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint_cats</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">language_name_get_t</span><span class="p">.</span><span class="n">deprecated_cat</span><span class="p">,</span> <span class="p">{</span><span class="n">code</span><span class="p">}));</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos" data-line="1002"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">maint_msgs</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">language_name_get_t</span><span class="p">.</span><span class="n">deprecated_msg</span><span class="p">,</span> <span class="p">{</span><span class="n">code</span><span class="p">}));</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos" data-line="1003"></span></a>	<span class="kr">end</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos" data-line="1004"></span></a>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos" data-line="1005"></span></a>	<span class="kr">return</span> <span class="n">name</span><span class="p">;</span>																<span class="c1">-- name from data tables or nil</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos" data-line="1006"></span></a><span class="kr">end</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos" data-line="1007"></span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos" data-line="1008"></span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos" data-line="1009"></span></a><span class="cm">--[[--------------------------&lt; T E X T _ S C R I P T _ M A T C H _ T E S T &gt;----------------------------------</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos" data-line="1010"></span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos" data-line="1011"></span></a><span class="cm">IETF script subtag should match the script of the &lt;text&gt;.  This module does not attempt to know all scripts and</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos" data-line="1012"></span></a><span class="cm">what they look like.  It does know what Latn script looks like so when &lt;text&gt; is written using other than the Latn</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos" data-line="1013"></span></a><span class="cm">script, the IETF script subtag, if present, should not be Latn.</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos" data-line="1014"></span></a>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos" data-line="1015"></span></a><span class="cm">Conversely, when &lt;text&gt; is written using the Latn script, the IETF script subtag, if present, should be Latn.</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos" data-line="1016"></span></a>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos" data-line="1017"></span></a><span class="cm">For the purposes of this test, Latf (Fraktur) and Latg (Gaelic) are considered to be equivalent to Latn because</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos" data-line="1018"></span></a><span class="cm">unicode treats these two scripts as font-specific variants of Latn.</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos" data-line="1019"></span></a>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos" data-line="1020"></span></a><span class="cm">Returns an error message when mismatch detected; nil else.</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos" data-line="1021"></span></a>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos" data-line="1022"></span></a><span class="cm">]]</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos" data-line="1023"></span></a>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos" data-line="1024"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">text_script_match_test</span> <span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos" data-line="1025"></span></a>	<span class="kd">local</span> <span class="n">scripts_t</span> <span class="o">=</span> <span class="p">{[</span><span class="s1">&#39;latf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;latg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;latn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">};</span>		<span class="c1">-- unicode &#39;latn&#39; scripts; &#39;latf&#39; and &#39;latg&#39; are font variants so there are no Fraktur or Gaelic codepoints</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos" data-line="1026"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>														<span class="c1">-- don&#39;t bother with the rest of this if &lt;script&gt; is nil or empty string</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos" data-line="1027"></span></a>		<span class="n">script</span> <span class="o">=</span> <span class="n">script</span><span class="p">:</span><span class="n">lower</span><span class="p">();</span>												<span class="c1">-- lower case to index into &lt;scripts_t&gt;</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos" data-line="1028"></span></a>		<span class="kr">if</span> <span class="n">is_latn_text</span> <span class="kr">then</span>													<span class="c1">-- when text is wholly Latn script</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos" data-line="1029"></span></a>			<span class="kr">if</span> <span class="ow">not</span> <span class="n">scripts_t</span><span class="p">[</span><span class="n">script</span><span class="p">]</span> <span class="kr">then</span>										<span class="c1">-- but a non-Latn script is specified</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos" data-line="1030"></span></a>				<span class="kr">return</span> <span class="n">cfg</span><span class="p">.</span><span class="n">text_script_match_test_t</span><span class="p">.</span><span class="n">latn_txt_mismatch</span><span class="p">;</span>			<span class="c1">-- emit an error message</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos" data-line="1031"></span></a>			<span class="kr">end</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos" data-line="1032"></span></a>		<span class="kr">else</span>																	<span class="c1">-- when text is not wholly Latn script</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos" data-line="1033"></span></a>			<span class="kr">if</span> <span class="n">scripts_t</span><span class="p">[</span><span class="n">script</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- but a Latn script is specified</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos" data-line="1034"></span></a>				<span class="kr">return</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">text_script_match_test_t</span><span class="p">.</span><span class="n">latn_scr_mismatch</span><span class="p">,</span> <span class="p">{</span><span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">});</span>	<span class="c1">-- emit an error message with position of first offending character</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos" data-line="1035"></span></a>			<span class="kr">end</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos" data-line="1036"></span></a>		<span class="kr">end</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos" data-line="1037"></span></a>	<span class="kr">end</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos" data-line="1038"></span></a><span class="kr">end</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos" data-line="1039"></span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos" data-line="1040"></span></a>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos" data-line="1041"></span></a><span class="cm">--[[--------------------------&lt; B I N A R Y _ S E A R C H &gt;---------------------------------------------------</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos" data-line="1042"></span></a>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos" data-line="1043"></span></a><span class="cm">conducts a binary search of &lt;ranges_t&gt; for a sub-range that holds &lt;target&gt;.</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos" data-line="1044"></span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos" data-line="1045"></span></a><span class="cm">returns boolean true if a sub-range holding &lt;target&gt; is found; boolean false else.</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos" data-line="1046"></span></a>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos" data-line="1047"></span></a><span class="cm">]]</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos" data-line="1048"></span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos" data-line="1049"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">binary_search</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">ranges_t</span><span class="p">)</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos" data-line="1050"></span></a>	<span class="kd">local</span> <span class="n">idx_bot</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>															<span class="c1">-- initialize to index of first key</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos" data-line="1051"></span></a>	<span class="kd">local</span> <span class="n">idx_top</span> <span class="o">=</span> <span class="n">sizeof_ranges_t</span><span class="p">;</span>											<span class="c1">-- initialize to index of last key (number of keys)</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos" data-line="1052"></span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos" data-line="1053"></span></a>	<span class="kr">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">&lt;</span> <span class="n">ranges_t</span><span class="p">[</span><span class="n">idx_bot</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="n">ranges_t</span><span class="p">[</span><span class="n">idx_top</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>	<span class="c1">-- invalid; target out of range</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos" data-line="1054"></span></a>		<span class="kr">return</span><span class="p">;</span>																	<span class="c1">-- abandon</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos" data-line="1055"></span></a>	<span class="kr">end</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos" data-line="1056"></span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos" data-line="1057"></span></a>	<span class="kd">local</span> <span class="n">idx_mid</span><span class="p">;</span>																<span class="c1">-- calculated index of range midway between top index and bottom index</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos" data-line="1058"></span></a>	<span class="kd">local</span> <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>															<span class="c1">-- flag to tell us when we&#39;ve evaluated last (highest) range in &lt;ranges_t&gt;</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos" data-line="1059"></span></a>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos" data-line="1060"></span></a>	<span class="kr">while</span> <span class="mi">1</span> <span class="kr">do</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos" data-line="1061"></span></a>		<span class="n">idx_mid</span> <span class="o">=</span> <span class="nb">math.ceil</span> <span class="p">((</span><span class="n">idx_bot</span> <span class="o">+</span> <span class="n">idx_top</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>							<span class="c1">-- get the mid-point in the &lt;ranges_t&gt; sequence</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos" data-line="1062"></span></a>		<span class="kr">if</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;=</span> <span class="n">ranges_t</span><span class="p">[</span><span class="n">idx_mid</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">target</span> <span class="o">&lt;=</span> <span class="n">ranges_t</span><span class="p">[</span><span class="n">idx_mid</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>		<span class="c1">-- indexed range low value &lt;= target &lt;= indexed range high value</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos" data-line="1063"></span></a>			<span class="kr">return</span> <span class="kc">true</span><span class="p">;</span>														<span class="c1">-- we found the range that holds the &lt;target&gt; character; return true</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos" data-line="1064"></span></a>		
</span><span id="L-1065"><a href="#L-1065"><span class="linenos" data-line="1065"></span></a>		<span class="kr">elseif</span> <span class="p">(</span><span class="n">target</span> <span class="o">&gt;</span> <span class="n">ranges_t</span><span class="p">[</span><span class="n">idx_mid</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>								<span class="c1">-- is &lt;target&gt; &gt; indexed range high value?</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos" data-line="1066"></span></a>			<span class="n">idx_bot</span> <span class="o">=</span> <span class="n">idx_mid</span><span class="p">;</span>													<span class="c1">-- adjust &lt;idx_bot&gt; up</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos" data-line="1067"></span></a>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos" data-line="1068"></span></a>		<span class="kr">else</span>																	<span class="c1">-- here when &lt;target&gt; less than indexed range low value</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos" data-line="1069"></span></a>			<span class="n">idx_top</span> <span class="o">=</span> <span class="n">idx_mid</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>												<span class="c1">-- adjust &lt;idx_top&gt; down</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos" data-line="1070"></span></a>		<span class="kr">end</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos" data-line="1071"></span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos" data-line="1072"></span></a>		<span class="kr">if</span> <span class="n">flag</span> <span class="kr">then</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos" data-line="1073"></span></a>			<span class="kr">break</span><span class="p">;</span>																<span class="c1">-- here when we just evaluated the last range and &lt;target&gt; not found</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos" data-line="1074"></span></a>		<span class="kr">end</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos" data-line="1075"></span></a>	
</span><span id="L-1076"><a href="#L-1076"><span class="linenos" data-line="1076"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">flag</span> <span class="ow">and</span> <span class="p">(</span><span class="n">idx_bot</span> <span class="o">==</span> <span class="n">idx_top</span><span class="p">)</span> <span class="kr">then</span>								<span class="c1">-- set true just before we evaluate the last (highest) range in &lt;ranges_t&gt;</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos" data-line="1077"></span></a>			<span class="n">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos" data-line="1078"></span></a>		<span class="kr">end</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos" data-line="1079"></span></a>	<span class="kr">end</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos" data-line="1080"></span></a><span class="kr">end</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos" data-line="1081"></span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos" data-line="1082"></span></a>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos" data-line="1083"></span></a><span class="cm">--[[--------------------------&lt; I S _ L A T I N &gt;--------------------------------------------------------------</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos" data-line="1084"></span></a>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos" data-line="1085"></span></a><span class="cm">compare &lt;text&gt; as codepoints to lists of known codepoints accepted as Latn script</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos" data-line="1086"></span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos" data-line="1087"></span></a><span class="cm">returns boolean true and modified &lt;text&gt; when &lt;text&gt; is wrapped in accept-as-written markup</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos" data-line="1088"></span></a>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos" data-line="1089"></span></a><span class="cm">returns boolean true and &lt;text&gt; when codepoint is known</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos" data-line="1090"></span></a>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos" data-line="1091"></span></a><span class="cm">returns boolean false, &lt;text&gt;, non-Latn codepoint position in &lt;text&gt; (left to right), and the codepoint character</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos" data-line="1092"></span></a><span class="cm">	when codepoint is not known</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos" data-line="1093"></span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos" data-line="1094"></span></a><span class="cm">TODO: when text has accept-as-written markup, return a non-boolean value to indicate that &lt;text&gt; is not wholly</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos" data-line="1095"></span></a><span class="cm">	latn script?  Use that return value to create non-Latn html lang= attribute because &lt;text&gt; isn&#39;t really</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos" data-line="1096"></span></a><span class="cm">	latn so lang=und (undetermined)? or instead, omit the -Latn subtag? (without -latn need to force |italic=yes)</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos" data-line="1097"></span></a>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos" data-line="1098"></span></a><span class="cm">]]</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos" data-line="1099"></span></a>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos" data-line="1100"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">is_latin</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos" data-line="1101"></span></a>	<span class="kd">local</span> <span class="n">count</span><span class="p">;</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos" data-line="1102"></span></a>	<span class="n">text</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">text</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;^%(%((.+)%)%)$&#39;</span><span class="p">,</span> <span class="s1">&#39;%1&#39;</span><span class="p">);</span>							<span class="c1">-- remove accept-as-written markup if present</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos" data-line="1103"></span></a>	<span class="kr">if</span> <span class="mi">0</span> <span class="o">~=</span> <span class="n">count</span> <span class="kr">then</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos" data-line="1104"></span></a>		<span class="kr">return</span> <span class="kc">true</span><span class="p">,</span> <span class="n">text</span><span class="p">;</span>														<span class="c1">-- markup present so assume that &lt;text&gt; is Latn-script</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos" data-line="1105"></span></a>	<span class="kr">end</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos" data-line="1106"></span></a>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos" data-line="1107"></span></a>	<span class="kd">local</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>																<span class="c1">-- position counter for error messaging</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos" data-line="1108"></span></a>	<span class="kr">for</span> <span class="n">codepoint</span> <span class="kr">in</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">gcodepoint</span> <span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="kr">do</span>							<span class="c1">-- fetch each code point</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos" data-line="1109"></span></a>		<span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>															<span class="c1">-- bump the position counter</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos" data-line="1110"></span></a>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos" data-line="1111"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">is_latn_data</span><span class="p">.</span><span class="n">singles_t</span><span class="p">[</span><span class="n">codepoint</span><span class="p">]</span> <span class="ow">and</span>							<span class="c1">-- codepoint not found in the singles list?</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos" data-line="1112"></span></a>			<span class="ow">not</span> <span class="n">binary_search</span> <span class="p">(</span><span class="n">codepoint</span><span class="p">,</span> <span class="n">is_latn_data</span><span class="p">.</span><span class="n">ranges_t</span><span class="p">)</span> <span class="ow">and</span>			<span class="c1">-- codepoint not a member of a listed range?</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos" data-line="1113"></span></a>			<span class="ow">not</span> <span class="p">(</span><span class="n">tag</span> <span class="ow">and</span> <span class="n">is_latn_data</span><span class="p">.</span><span class="n">specials_t</span><span class="p">[</span><span class="n">codepoint</span><span class="p">]</span> <span class="ow">and</span> <span class="n">is_latn_data</span><span class="p">.</span><span class="n">specials_t</span><span class="p">[</span><span class="n">codepoint</span><span class="p">][</span><span class="n">tag</span><span class="p">])</span> <span class="kr">then</span>	<span class="c1">-- not a language-specific codepoint?</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos" data-line="1114"></span></a>				<span class="kr">return</span> <span class="kc">false</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">char</span> <span class="p">(</span><span class="n">codepoint</span><span class="p">);</span>			<span class="c1">-- codepoint not known; return false with codepoint position and character representation</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos" data-line="1115"></span></a>		<span class="kr">end</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos" data-line="1116"></span></a>	<span class="kr">end</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos" data-line="1117"></span></a>	<span class="kr">return</span> <span class="kc">true</span><span class="p">,</span> <span class="n">text</span><span class="p">;</span>															<span class="c1">-- is known; return &lt;text&gt;</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos" data-line="1118"></span></a><span class="kr">end</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos" data-line="1119"></span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos" data-line="1120"></span></a>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos" data-line="1121"></span></a><span class="cm">--[[--------------------------&lt; _ L A N G &gt;--------------------------------------------------------------------</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos" data-line="1122"></span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos" data-line="1123"></span></a><span class="cm">Entry point for {{lang}}.</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos" data-line="1124"></span></a>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos" data-line="1125"></span></a><span class="cm">There should be no reason to set parameters in the {{lang}} {{#invoke:}}</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos" data-line="1126"></span></a><span class="cm">	&lt;includeonly&gt;{{#invoke:lang|lang}}&lt;/includeonly&gt;</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos" data-line="1127"></span></a>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos" data-line="1128"></span></a><span class="cm">Parameters are received from the template&#39;s frame (parent frame).</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos" data-line="1129"></span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos" data-line="1130"></span></a><span class="cm">]]</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos" data-line="1131"></span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos" data-line="1132"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_lang</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos" data-line="1133"></span></a>	<span class="kd">local</span> <span class="n">out</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos" data-line="1134"></span></a>	<span class="kd">local</span> <span class="n">language_name</span><span class="p">;</span>														<span class="c1">-- used to make category names</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos" data-line="1135"></span></a>	<span class="kd">local</span> <span class="n">category_name</span><span class="p">;</span>														<span class="c1">-- same as language_name except that it retains any parenthetical disambiguators (if any) from the data set</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos" data-line="1136"></span></a>	<span class="kd">local</span> <span class="n">subtags</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- IETF subtags script, region, variant, and private</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos" data-line="1137"></span></a>	<span class="kd">local</span> <span class="n">code</span><span class="p">;</span>																	<span class="c1">-- the language code</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos" data-line="1138"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>																	<span class="c1">-- for error messages</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos" data-line="1139"></span></a>	<span class="kd">local</span> <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;span&#39;</span><span class="p">;</span>															<span class="c1">-- initial value for make_text_html()</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos" data-line="1140"></span></a>	<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">template</span> <span class="ow">or</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">lang</span><span class="p">;</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos" data-line="1141"></span></a>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos" data-line="1142"></span></a>	<span class="n">maint_cats</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- initialize because when this module required into another module, these only declared once so only initialzed once</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos" data-line="1143"></span></a>	<span class="n">maint_msgs</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos" data-line="1144"></span></a>	
</span><span id="L-1145"><a href="#L-1145"><span class="linenos" data-line="1145"></span></a>	<span class="n">validate_cat_args</span> <span class="p">(</span><span class="n">args</span><span class="p">);</span>													<span class="c1">-- determine if categorization should be suppressed</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos" data-line="1146"></span></a>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos" data-line="1147"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="kr">then</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos" data-line="1148"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param_types</span><span class="p">.</span><span class="n">code</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos" data-line="1149"></span></a>	<span class="kr">else</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos" data-line="1150"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>										<span class="c1">-- prefer args.code</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos" data-line="1151"></span></a>	<span class="kr">end</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos" data-line="1152"></span></a>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos" data-line="1153"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="kr">then</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos" data-line="1154"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param_types</span><span class="p">.</span><span class="n">text</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos" data-line="1155"></span></a>	<span class="kr">else</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos" data-line="1156"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>										<span class="c1">-- prefer args.text</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos" data-line="1157"></span></a>	<span class="kr">end</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos" data-line="1158"></span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos" data-line="1159"></span></a>	<span class="n">msg</span> <span class="o">=</span> <span class="n">validate_text</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>										<span class="c1">-- ensure that |text= is set</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos" data-line="1160"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kr">then</span>														<span class="c1">-- msg is an already-formatted error message</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos" data-line="1161"></span></a>		<span class="kr">return</span> <span class="n">msg</span><span class="p">;</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos" data-line="1162"></span></a>	<span class="kr">end</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos" data-line="1163"></span></a>	
</span><span id="L-1164"><a href="#L-1164"><span class="linenos" data-line="1164"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">html_tag_select</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">);</span>								<span class="c1">-- inspects text; returns appropriate html tag with text trimmed accordingly</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos" data-line="1165"></span></a>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos" data-line="1166"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">==</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span><span class="p">;</span>							<span class="c1">-- convert to boolean: &#39;yes&#39; -&gt; true, other values -&gt; false</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos" data-line="1167"></span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos" data-line="1168"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">validate_proto</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">);</span>								<span class="c1">-- return boolean, or nil, or nil and error message flag</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos" data-line="1169"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos" data-line="1170"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">invalid_proto</span><span class="p">,</span> <span class="p">{</span><span class="n">msg</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos" data-line="1171"></span></a>	<span class="kr">end</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos" data-line="1172"></span></a>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos" data-line="1173"></span></a>	<span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">get_ietf_parts</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">);</span>	<span class="c1">-- |script=, |region=, |variant= not supported because they should be part of args.code ({{{1}}} in {{lang}})</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos" data-line="1174"></span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos" data-line="1175"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos" data-line="1176"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos" data-line="1177"></span></a>	<span class="kr">end</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos" data-line="1178"></span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos" data-line="1179"></span></a>	<span class="kd">local</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">;</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos" data-line="1180"></span></a>	<span class="n">is_latn_text</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span> <span class="n">is_latin</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>		<span class="c1">-- make a boolean</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos" data-line="1181"></span></a>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos" data-line="1182"></span></a>	<span class="n">msg</span> <span class="o">=</span> <span class="n">text_script_match_test</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos" data-line="1183"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>																	<span class="c1">-- if an error detected then there is an error message</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos" data-line="1184"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos" data-line="1185"></span></a>	<span class="kr">end</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos" data-line="1186"></span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos" data-line="1187"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">validate_italic</span> <span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos" data-line="1188"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos" data-line="1189"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos" data-line="1190"></span></a>	<span class="kr">end</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos" data-line="1191"></span></a>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos" data-line="1192"></span></a>	<span class="kr">if</span> <span class="kc">nil</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="kr">then</span>													<span class="c1">-- nil when |italic= absent or not set or |italic=default; args.italic controls</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos" data-line="1193"></span></a>		<span class="kr">if</span> <span class="p">(</span><span class="s1">&#39;latn&#39;</span> <span class="o">==</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="ow">or</span>								 		<span class="c1">-- script is latn</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos" data-line="1194"></span></a>			<span class="p">(</span><span class="n">this_wiki_lang_tag</span> <span class="o">~=</span> <span class="n">code</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_poem_tag</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_latn_text</span><span class="p">)</span> <span class="kr">then</span> <span class="c1">-- text not this wiki&#39;s language, no script specified and not in poem markup but is wholly latn script (auto-italics)</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos" data-line="1195"></span></a>				<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">;</span>											<span class="c1">-- DEFAULT for {{lang}} templates is upright; but if latn script set for font-style:italic</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos" data-line="1196"></span></a>		<span class="kr">else</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos" data-line="1197"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">;</span>											<span class="c1">-- italic not set; script not latn; inherit current style</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos" data-line="1198"></span></a>		<span class="kr">end</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos" data-line="1199"></span></a>	<span class="kr">end</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos" data-line="1200"></span></a>	
</span><span id="L-1201"><a href="#L-1201"><span class="linenos" data-line="1201"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>												<span class="c1">-- if script set, override rtl setting</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos" data-line="1202"></span></a>		<span class="kr">if</span> <span class="n">in_array</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">rtl_scripts</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos" data-line="1203"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>													<span class="c1">-- script is an rtl script</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos" data-line="1204"></span></a>		<span class="kr">else</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos" data-line="1205"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>													<span class="c1">-- script is not an rtl script</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos" data-line="1206"></span></a>		<span class="kr">end</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos" data-line="1207"></span></a>	<span class="kr">end</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos" data-line="1208"></span></a>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos" data-line="1209"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">format_ietf_tag</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">);</span>	<span class="c1">-- format to recommended subtag styles</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos" data-line="1210"></span></a>	<span class="n">language_name</span> <span class="o">=</span> <span class="n">language_name_get</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>					<span class="c1">-- get language name; try ietf tag first, then code w/o variant then code w/ variant</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos" data-line="1211"></span></a>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos" data-line="1212"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">invert</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="ow">and</span> <span class="s1">&#39;span&#39;</span> <span class="o">==</span> <span class="n">tag</span> <span class="kr">then</span>				<span class="c1">-- invert only supported for in-line content</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos" data-line="1213"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">invert_italics</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos" data-line="1214"></span></a>	<span class="kr">end</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos" data-line="1215"></span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos" data-line="1216"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">proto_prefix</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">);</span>			<span class="c1">-- prefix proto-language text with a splat</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos" data-line="1217"></span></a>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos" data-line="1218"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_text_html</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">rtl</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="n">language_name</span><span class="p">));</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos" data-line="1219"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_category</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">nocat</span><span class="p">));</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos" data-line="1220"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">render_maint</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">nocat</span><span class="p">));</span>								<span class="c1">-- maintenance messages and categories</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos" data-line="1221"></span></a>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos" data-line="1222"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">out</span><span class="p">);</span>													<span class="c1">-- put it all together and done</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos" data-line="1223"></span></a><span class="kr">end</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos" data-line="1224"></span></a>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos" data-line="1225"></span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos" data-line="1226"></span></a><span class="cm">--[[--------------------------&lt; L A N G &gt;----------------------------------------------------------------------</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos" data-line="1227"></span></a>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos" data-line="1228"></span></a><span class="cm">Entry point for {{lang}}.</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos" data-line="1229"></span></a>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos" data-line="1230"></span></a><span class="cm">There should be no reason to set parameters in the {{lang}} {{#invoke:}}</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos" data-line="1231"></span></a><span class="cm">	&lt;includeonly&gt;{{#invoke:lang|lang}}&lt;/includeonly&gt;</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos" data-line="1232"></span></a>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos" data-line="1233"></span></a><span class="cm">Parameters are received from the template&#39;s frame (parent frame).</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos" data-line="1234"></span></a>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos" data-line="1235"></span></a><span class="cm">]]</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos" data-line="1236"></span></a>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos" data-line="1237"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">lang</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos" data-line="1238"></span></a>	<span class="kd">local</span> <span class="n">args_t</span> <span class="o">=</span> <span class="n">getArgs</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">{</span>											<span class="c1">-- this code so that we can detect and handle wiki list markup in text</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos" data-line="1239"></span></a>		<span class="n">valueFunc</span> <span class="o">=</span> <span class="kr">function</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos" data-line="1240"></span></a>			<span class="kr">if</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">key</span> <span class="ow">or</span> <span class="s1">&#39;text&#39;</span> <span class="o">==</span> <span class="n">key</span> <span class="kr">then</span>									<span class="c1">-- the &#39;text&#39; parameter; do not trim wite space</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos" data-line="1241"></span></a>				<span class="kr">return</span> <span class="n">value</span><span class="p">;</span>													<span class="c1">-- return untrimmed &#39;text&#39;</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos" data-line="1242"></span></a>			<span class="kr">elseif</span> <span class="n">value</span> <span class="kr">then</span>													<span class="c1">-- all other values: if the value is not nil</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos" data-line="1243"></span></a>				<span class="n">value</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">trim</span> <span class="p">(</span><span class="n">value</span><span class="p">);</span>									<span class="c1">-- trim whitespace</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos" data-line="1244"></span></a>				<span class="kr">if</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">value</span> <span class="kr">then</span>												<span class="c1">-- empty string when value was only whitespace</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos" data-line="1245"></span></a>					<span class="kr">return</span> <span class="n">value</span><span class="p">;</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos" data-line="1246"></span></a>				<span class="kr">end</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos" data-line="1247"></span></a>			<span class="kr">end</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos" data-line="1248"></span></a>			<span class="kr">return</span> <span class="kc">nil</span><span class="p">;</span>															<span class="c1">-- value was empty or contained only whitespace</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos" data-line="1249"></span></a>		<span class="kr">end</span>																		<span class="c1">-- end of valueFunc</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos" data-line="1250"></span></a>		<span class="p">});</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos" data-line="1251"></span></a>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos" data-line="1252"></span></a>	<span class="n">args_t</span><span class="p">.</span><span class="n">fn</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>															<span class="c1">-- unset because not supported but this function might have been called by {{lang|fn=lang|...}}</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos" data-line="1253"></span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos" data-line="1254"></span></a>	<span class="kd">local</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">parameter_validate</span> <span class="p">(</span><span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">lang</span><span class="p">);</span>				<span class="c1">-- verify that all supplied parameters are supported by {{lang-??}}</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos" data-line="1255"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos" data-line="1256"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">lang</span><span class="p">);</span>				<span class="c1">-- when template has unsupported params, abandon with error message</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos" data-line="1257"></span></a>	<span class="kr">end</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos" data-line="1258"></span></a>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos" data-line="1259"></span></a>	<span class="kr">return</span> <span class="n">_lang</span> <span class="p">(</span><span class="n">args_t</span><span class="p">);</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos" data-line="1260"></span></a><span class="kr">end</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos" data-line="1261"></span></a>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos" data-line="1262"></span></a>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos" data-line="1263"></span></a><span class="cm">--[[--------------------------&lt; T R A N S L A T I O N _ M A K E &gt;----------------------------------------------</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos" data-line="1264"></span></a>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos" data-line="1265"></span></a><span class="cm">Stand-alone function to create literal translation of main text.</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos" data-line="1266"></span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos" data-line="1267"></span></a><span class="cm">Also used by {{lang-x2}}.</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos" data-line="1268"></span></a>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos" data-line="1269"></span></a><span class="cm">]]</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos" data-line="1270"></span></a>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos" data-line="1271"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">translation_make</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos" data-line="1272"></span></a>	<span class="kd">local</span> <span class="n">translation_t</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;, &#39;</span><span class="p">};</span>												<span class="c1">-- initialize output</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos" data-line="1273"></span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos" data-line="1274"></span></a>	<span class="kr">if</span> <span class="s1">&#39;none&#39;</span> <span class="o">~=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">label</span> <span class="kr">then</span>												<span class="c1">-- if we want a label</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos" data-line="1275"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">,</span> <span class="s1">&#39;&lt;small&gt;&#39;</span><span class="p">);</span>								<span class="c1">-- open the &lt;small&gt; html tag</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos" data-line="1276"></span></a>		<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">negative</span> <span class="o">==</span> <span class="n">args_t</span><span class="p">.</span><span class="n">link</span> <span class="kr">then</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos" data-line="1277"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;&lt;abbr title=&quot;$1&quot;&gt;$2&lt;/abbr&gt;&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">translation_make_t</span><span class="p">.</span><span class="n">lit_xlation</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">translation_make_t</span><span class="p">.</span><span class="n">lit_abbr</span><span class="p">}));</span>	<span class="c1">-- unlinked form</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos" data-line="1278"></span></a>		<span class="kr">else</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos" data-line="1279"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">translation_make_t</span><span class="p">.</span><span class="n">lit_xlation</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">translation_make_t</span><span class="p">.</span><span class="n">lit_abbr</span><span class="p">));</span>	<span class="c1">-- linked form</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos" data-line="1280"></span></a>		<span class="kr">end</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos" data-line="1281"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">,</span> <span class="s2">&quot;&amp;thinsp;&lt;/small&gt;&quot;</span><span class="p">);</span>						<span class="c1">-- close the &lt;small&gt; html tag</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos" data-line="1282"></span></a>	<span class="kr">end</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos" data-line="1283"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;&amp;#39;&#39;</span><span class="p">,</span> <span class="n">args_t</span><span class="p">.</span><span class="n">translation</span><span class="p">,</span> <span class="s1">&#39;&amp;#39;&#39;</span><span class="p">}));</span>	<span class="c1">-- use html entities to avoid wiki markup confusion</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos" data-line="1284"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">translation_t</span><span class="p">);</span>										<span class="c1">-- make a big string and done</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos" data-line="1285"></span></a><span class="kr">end</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos" data-line="1286"></span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos" data-line="1287"></span></a>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos" data-line="1288"></span></a><span class="cm">--[[--------------------------&lt; _ L A N G _ X X &gt;--------------------------------------------------------------</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos" data-line="1289"></span></a>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos" data-line="1290"></span></a><span class="cm">For the {{lang-??}} templates, the only parameter required to be set in the template is the language code.  All</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos" data-line="1291"></span></a><span class="cm">other parameters can, usually should, be written in the template call.  For {{lang-??}} templates for languages</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos" data-line="1292"></span></a><span class="cm">that can have multiple writing systems, it may be appropriate to set |script= as well.</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos" data-line="1293"></span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos" data-line="1294"></span></a><span class="cm">For each {{lang-??}} template choose the appropriate entry-point function so that this function knows the default</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos" data-line="1295"></span></a><span class="cm">styling that should be applied to text.</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos" data-line="1296"></span></a>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos" data-line="1297"></span></a><span class="cm">For normal, upright style:</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos" data-line="1298"></span></a><span class="cm">	&lt;includeonly&gt;{{#invoke:lang|lang_xx_inherit|code=xx}}&lt;/includeonly&gt;</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos" data-line="1299"></span></a><span class="cm">For italic style:</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos" data-line="1300"></span></a><span class="cm">	&lt;includeonly&gt;{{#invoke:lang|lang_xx_italic|code=xx}}&lt;/includeonly&gt;</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos" data-line="1301"></span></a>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos" data-line="1302"></span></a><span class="cm">All other parameters should be received from the template&#39;s frame (parent frame)</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos" data-line="1303"></span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos" data-line="1304"></span></a><span class="cm">Supported parameters are:</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos" data-line="1305"></span></a><span class="cm">	|code = (required) the IANA language code</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos" data-line="1306"></span></a><span class="cm">	|script = IANA script code; especially for use with languages that use multiple writing systems</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos" data-line="1307"></span></a><span class="cm">	|region = IANA region code</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos" data-line="1308"></span></a><span class="cm">	|variant = IANA variant code</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos" data-line="1309"></span></a><span class="cm">	|text = (required) the displayed text in language specified by code</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos" data-line="1310"></span></a><span class="cm">	|link = boolean false (&#39;no&#39;) does not link code-spcified language name to associated language article</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos" data-line="1311"></span></a><span class="cm">	|rtl = boolean true (&#39;yes&#39;) identifies the language specified by code as a right-to-left language</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos" data-line="1312"></span></a><span class="cm">	|nocat = boolean true (&#39;yes&#39;) inhibits normal categorization; error categories are not affected</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos" data-line="1313"></span></a><span class="cm">	|cat = boolian false (&#39;no&#39;) opposite form of |nocat=</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos" data-line="1314"></span></a><span class="cm">	|italic = boolean true (&#39;yes&#39;) renders displayed text in italic font; boolean false (&#39;no&#39;) renders displayed text in normal font; not set renders according to initial_style_state</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos" data-line="1315"></span></a><span class="cm">	|lit = text that is a literal translation of text</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos" data-line="1316"></span></a><span class="cm">	|label = &#39;none&#39; to suppress all labeling (language name, &#39;translit.&#39;, &#39;lit.&#39;)</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos" data-line="1317"></span></a><span class="cm">				any other text replaces language-name label - automatic wikilinking disabled</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos" data-line="1318"></span></a><span class="cm">	</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos" data-line="1319"></span></a><span class="cm">	for those {{lang-??}} templates that support transliteration (those templates where |text= is not entirely latn script):</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos" data-line="1320"></span></a><span class="cm">	|translit = text that is a transliteration of text</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos" data-line="1321"></span></a><span class="cm">	|translit-std = the standard that applies to the transliteration</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos" data-line="1322"></span></a><span class="cm">	|translit-script = ISO 15924 script name; falls back to code</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos" data-line="1323"></span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos" data-line="1324"></span></a><span class="cm">For {{lang-??}}, the positional parameters are:</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos" data-line="1325"></span></a><span class="cm">	{{{1}}}	text</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos" data-line="1326"></span></a><span class="cm">	{{{2}}}	transliterated text</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos" data-line="1327"></span></a><span class="cm">	{{{3}}}	literal translation text</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos" data-line="1328"></span></a><span class="cm">no other positional parameters are allowed</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos" data-line="1329"></span></a>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos" data-line="1330"></span></a><span class="cm">]]</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos" data-line="1331"></span></a>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos" data-line="1332"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_lang_xx</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">base_template</span><span class="p">)</span>									<span class="c1">-- base_template will be either of &#39;Langx&#39; or &#39;Lang-xx&#39;</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos" data-line="1333"></span></a>	<span class="kd">local</span> <span class="n">out</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos" data-line="1334"></span></a>	<span class="kd">local</span> <span class="n">language_name</span><span class="p">;</span>														<span class="c1">-- used to make display text, article links</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos" data-line="1335"></span></a>	<span class="kd">local</span> <span class="n">category_name</span><span class="p">;</span>														<span class="c1">-- same as language_name except that it retains any parenthetical disambiguators (if any) from the data set</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos" data-line="1336"></span></a>	<span class="kd">local</span> <span class="n">subtags</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- IETF subtags script, region, and variant</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos" data-line="1337"></span></a>	<span class="kd">local</span> <span class="n">code</span><span class="p">;</span>																	<span class="c1">-- the language code</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos" data-line="1338"></span></a>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos" data-line="1339"></span></a>	<span class="kd">local</span> <span class="n">translit_script_name</span><span class="p">;</span>													<span class="c1">-- name associated with IANA (ISO 15924) script code</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos" data-line="1340"></span></a>	<span class="kd">local</span> <span class="n">translit</span><span class="p">;</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos" data-line="1341"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>																	<span class="c1">-- for error messages</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos" data-line="1342"></span></a>	<span class="kd">local</span> <span class="n">tag</span> <span class="o">=</span> <span class="s1">&#39;span&#39;</span><span class="p">;</span>															<span class="c1">-- initial value for make_text_html()</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos" data-line="1343"></span></a>	<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">template</span> <span class="ow">or</span> <span class="n">base_template</span><span class="p">;</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos" data-line="1344"></span></a>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos" data-line="1345"></span></a>	<span class="n">maint_cats</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- initialize because when this module required into another module, these only declared once so only initialzed once</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos" data-line="1346"></span></a>	<span class="n">maint_msgs</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos" data-line="1347"></span></a>	
</span><span id="L-1348"><a href="#L-1348"><span class="linenos" data-line="1348"></span></a>	<span class="kd">local</span> <span class="n">text_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">base_template</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">2</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">;</span>		<span class="c1">-- for {{langx}} &#39;text&#39; positional parameter is &#39;2&#39;</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos" data-line="1349"></span></a>	<span class="kd">local</span> <span class="n">translit_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">base_template</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">3</span> <span class="ow">or</span> <span class="mi">2</span><span class="p">;</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos" data-line="1350"></span></a>	<span class="kd">local</span> <span class="n">xlate_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">base_template</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">4</span> <span class="ow">or</span> <span class="mi">3</span><span class="p">;</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos" data-line="1351"></span></a>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos" data-line="1352"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="n">text_idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="kr">then</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos" data-line="1353"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param</span><span class="p">,</span> <span class="p">{</span><span class="n">translit_idx</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param_types</span><span class="p">.</span><span class="n">text</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos" data-line="1354"></span></a>	<span class="kr">else</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos" data-line="1355"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">text_idx</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">;</span>								<span class="c1">-- prefer positional &#39;text&#39; parameter</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos" data-line="1356"></span></a>	<span class="kr">end</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos" data-line="1357"></span></a>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos" data-line="1358"></span></a>	<span class="n">msg</span> <span class="o">=</span> <span class="n">validate_text</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>										<span class="c1">-- ensure that |text= is set, does not contain italic markup and is protected from improper bolding</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos" data-line="1359"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos" data-line="1360"></span></a>		<span class="kr">return</span> <span class="n">msg</span><span class="p">;</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos" data-line="1361"></span></a>	<span class="kr">end</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos" data-line="1362"></span></a>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos" data-line="1363"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">html_tag_select</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">);</span>								<span class="c1">-- inspects text; returns appropriate html tag with text trimmed accordingly</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos" data-line="1364"></span></a>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos" data-line="1365"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="n">translit_idx</span><span class="p">]</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">translit</span> <span class="kr">then</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos" data-line="1366"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param</span><span class="p">,</span> <span class="p">{</span><span class="n">translit_idx</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">conflict_n_param_types</span><span class="p">.</span><span class="n">translit</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos" data-line="1367"></span></a>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos" data-line="1368"></span></a>	<span class="kr">else</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos" data-line="1369"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">translit</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">translit_idx</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">translit</span>						<span class="c1">-- prefer positional &#39;translit&#39; parameter</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos" data-line="1370"></span></a>	<span class="kr">end</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos" data-line="1371"></span></a>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos" data-line="1372"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">engvar</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">engvar_sel_t</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">]</span> <span class="ow">or</span> <span class="n">cfg</span><span class="p">.</span><span class="n">default_engvar</span><span class="p">;</span>			<span class="c1">-- |engvar= when valid; cfg.default_engvar else</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos" data-line="1373"></span></a>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos" data-line="1374"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="n">xlate_idx</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">translation</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">lit</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos" data-line="1375"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">conflict_n_lit</span><span class="p">,</span> <span class="p">{</span><span class="n">translit_idx</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos" data-line="1376"></span></a>	<span class="kr">elseif</span> <span class="n">args</span><span class="p">.</span><span class="n">translation</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">lit</span> <span class="kr">then</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos" data-line="1377"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">conflict_lit</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos" data-line="1378"></span></a>	<span class="kr">else</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos" data-line="1379"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">translation</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">xlate_idx</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">translation</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">lit</span><span class="p">;</span>		<span class="c1">-- prefer positional &#39;translation&#39; parameter</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos" data-line="1380"></span></a>	<span class="kr">end</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos" data-line="1381"></span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos" data-line="1382"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">links</span> <span class="ow">and</span> <span class="n">args</span><span class="p">.</span><span class="n">link</span> <span class="kr">then</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos" data-line="1383"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">conflict_link</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos" data-line="1384"></span></a>	<span class="kr">else</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos" data-line="1385"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">link</span> <span class="ow">or</span> <span class="n">args</span><span class="p">.</span><span class="n">links</span><span class="p">;</span>									<span class="c1">-- prefer args.link</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos" data-line="1386"></span></a>	<span class="kr">end</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos" data-line="1387"></span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos" data-line="1388"></span></a>	<span class="n">validate_cat_args</span> <span class="p">(</span><span class="n">args</span><span class="p">);</span>													<span class="c1">-- determine if categorization should be suppressed</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos" data-line="1389"></span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos" data-line="1390"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">==</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span><span class="p">;</span>							<span class="c1">-- convert to boolean: &#39;yes&#39; -&gt; true, other values -&gt; false</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos" data-line="1391"></span></a>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos" data-line="1392"></span></a>	<span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">get_ietf_parts</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">variant</span><span class="p">);</span>	<span class="c1">-- private omitted because private</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos" data-line="1393"></span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos" data-line="1394"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>																	<span class="c1">-- if an error detected then there is an error message</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos" data-line="1395"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos" data-line="1396"></span></a>	<span class="kr">end</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos" data-line="1397"></span></a>	
</span><span id="L-1398"><a href="#L-1398"><span class="linenos" data-line="1398"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">translit</span> <span class="kr">then</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos" data-line="1399"></span></a>		<span class="kd">local</span> <span class="n">latn</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">;</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos" data-line="1400"></span></a>		<span class="n">latn</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">translit</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span> <span class="o">=</span> <span class="n">is_latin</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">translit</span><span class="p">,</span> <span class="p">((</span><span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">code</span> <span class="o">..</span> <span class="s1">&#39;-x-&#39;</span> <span class="o">..</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">))</span> <span class="ow">or</span> <span class="n">code</span><span class="p">);</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos" data-line="1401"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">latn</span> <span class="kr">then</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos" data-line="1402"></span></a>			<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">translit_nonlatn</span><span class="p">,</span> <span class="p">{</span><span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos" data-line="1403"></span></a>		<span class="kr">end</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos" data-line="1404"></span></a>	<span class="kr">end</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos" data-line="1405"></span></a>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos" data-line="1406"></span></a>	<span class="kd">local</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span> <span class="o">=</span> <span class="n">is_latin</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>			<span class="c1">-- make a boolean</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos" data-line="1407"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="p">;</span>															<span class="c1">-- may have been modified (accept-as-written markup removed)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos" data-line="1408"></span></a>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos" data-line="1409"></span></a>	<span class="n">msg</span> <span class="o">=</span> <span class="n">text_script_match_test</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">)</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos" data-line="1410"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>																	<span class="c1">-- if an error detected then there is an error message</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos" data-line="1411"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos" data-line="1412"></span></a>	<span class="kr">end</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos" data-line="1413"></span></a>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos" data-line="1414"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">validate_italic</span> <span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos" data-line="1415"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos" data-line="1416"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos" data-line="1417"></span></a>	<span class="kr">end</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos" data-line="1418"></span></a>																				
</span><span id="L-1419"><a href="#L-1419"><span class="linenos" data-line="1419"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">base_template</span> <span class="kr">then</span>								<span class="c1">-- auto-italics  for {{langx}} templates; adapted from {{lang}} (no support for poem tag) </span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos" data-line="1420"></span></a>		<span class="kr">if</span> <span class="kc">nil</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="kr">then</span>												<span class="c1">-- nil when |italic= absent or not set or |italic=default; args.italic controls</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos" data-line="1421"></span></a>			<span class="kr">if</span> <span class="p">(</span><span class="s1">&#39;latn&#39;</span> <span class="o">==</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="ow">or</span>								 	<span class="c1">-- script is latn</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos" data-line="1422"></span></a>				<span class="p">(</span><span class="n">this_wiki_lang_tag</span> <span class="o">~=</span> <span class="n">code</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_latn_text</span><span class="p">)</span> <span class="kr">then</span> <span class="c1">-- text is not this wiki&#39;s language, no script specified and is wholly latn script (auto-italics)</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos" data-line="1423"></span></a>					<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">;</span>										<span class="c1">-- set font-style:italic</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos" data-line="1424"></span></a>			<span class="kr">else</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos" data-line="1425"></span></a>				<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">;</span>										<span class="c1">-- italic not set; script not latn; inherit current style</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos" data-line="1426"></span></a>			<span class="kr">end</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos" data-line="1427"></span></a>		<span class="kr">end</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos" data-line="1428"></span></a>	
</span><span id="L-1429"><a href="#L-1429"><span class="linenos" data-line="1429"></span></a>	<span class="kr">else</span>																		<span class="c1">-- {{lang-xx}} does not do auto italics; retained for those wikis that don&#39;t support {{langx}}</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos" data-line="1430"></span></a>		<span class="kr">if</span> <span class="kc">nil</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="kr">then</span>												<span class="c1">-- args.italic controls</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos" data-line="1431"></span></a>			<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos" data-line="1432"></span></a>				<span class="kr">if</span> <span class="s1">&#39;latn&#39;</span> <span class="o">==</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span> <span class="kr">then</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos" data-line="1433"></span></a>					<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">;</span>										<span class="c1">-- |script=Latn; set for font-style:italic</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos" data-line="1434"></span></a>				<span class="kr">else</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos" data-line="1435"></span></a>					<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="n">initial_style_state</span><span class="p">;</span>							<span class="c1">-- italic not set; script is not latn; set for font-style:&lt;initial_style_state&gt;</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos" data-line="1436"></span></a>				<span class="kr">end</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos" data-line="1437"></span></a>			<span class="kr">else</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos" data-line="1438"></span></a>				<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="n">initial_style_state</span><span class="p">;</span>								<span class="c1">-- here when |italic= and |script= not set; set for font-style:&lt;initial_style_state&gt;</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos" data-line="1439"></span></a>			<span class="kr">end</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos" data-line="1440"></span></a>		<span class="kr">end</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos" data-line="1441"></span></a>	<span class="kr">end</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos" data-line="1442"></span></a>	
</span><span id="L-1443"><a href="#L-1443"><span class="linenos" data-line="1443"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">)</span> <span class="kr">then</span>												<span class="c1">-- if script set override rtl setting</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos" data-line="1444"></span></a>		<span class="kr">if</span> <span class="n">in_array</span> <span class="p">(</span><span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">rtl_scripts</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos" data-line="1445"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>													<span class="c1">-- script is an rtl script</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos" data-line="1446"></span></a>		<span class="kr">else</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos" data-line="1447"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>													<span class="c1">-- script is not an rtl script</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos" data-line="1448"></span></a>		<span class="kr">end</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos" data-line="1449"></span></a>	<span class="kr">end</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos" data-line="1450"></span></a>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos" data-line="1451"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">validate_proto</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">);</span>								<span class="c1">-- return boolean, or nil, or nil and error message flag</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos" data-line="1452"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos" data-line="1453"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_t</span><span class="p">.</span><span class="n">invalid_proto</span><span class="p">,</span> <span class="p">{</span><span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos" data-line="1454"></span></a>	<span class="kr">end</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos" data-line="1455"></span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos" data-line="1456"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">format_ietf_tag</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">);</span>	<span class="c1">-- format to recommended subtag styles</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos" data-line="1457"></span></a>	<span class="n">language_name</span> <span class="o">=</span> <span class="n">language_name_get</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>					<span class="c1">-- get language name; try ietf tag first, then code w/o variant then code w/ variant</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos" data-line="1458"></span></a>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos" data-line="1459"></span></a>	<span class="n">category_name</span> <span class="o">=</span> <span class="n">language_name</span><span class="p">;</span>												<span class="c1">-- category names retain IANA parenthetical diambiguators (if any)</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos" data-line="1460"></span></a>	<span class="n">language_name</span> <span class="o">=</span> <span class="n">language_name</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;%s+%b()&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>							<span class="c1">-- remove IANA parenthetical disambiguators or qualifiers from names that have them</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos" data-line="1461"></span></a>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos" data-line="1462"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">label</span> <span class="kr">then</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos" data-line="1463"></span></a>		<span class="kr">if</span> <span class="s1">&#39;none&#39;</span> <span class="o">~=</span> <span class="n">args</span><span class="p">.</span><span class="n">label</span> <span class="kr">then</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos" data-line="1464"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="n">args</span><span class="p">.</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">}));</span>				<span class="c1">-- custom label</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos" data-line="1465"></span></a>		<span class="kr">end</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos" data-line="1466"></span></a>	<span class="kr">else</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos" data-line="1467"></span></a>		<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">negative</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">link</span> <span class="kr">then</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos" data-line="1468"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">language_name</span><span class="p">);</span>									<span class="c1">-- language name without wikilink</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos" data-line="1469"></span></a>		<span class="kr">else</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos" data-line="1470"></span></a>			<span class="kr">if</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos" data-line="1471"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">language_name</span><span class="p">));</span>				<span class="c1">-- collective language name uses simple wikilink</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos" data-line="1472"></span></a>			<span class="kr">elseif</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">()]</span> <span class="kr">then</span>				<span class="c1">-- is ietf tag in article name over ride?</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos" data-line="1473"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">:</span><span class="n">lower</span><span class="p">()],</span> <span class="n">language_name</span><span class="p">));</span>	<span class="c1">-- language name with wikilink from override data</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos" data-line="1474"></span></a>			<span class="kr">elseif</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>							<span class="c1">-- is language tag in article override</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos" data-line="1475"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">code</span><span class="p">],</span> <span class="n">language_name</span><span class="p">));</span>	<span class="c1">-- language name with wikilink from override data</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos" data-line="1476"></span></a>			<span class="kr">else</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos" data-line="1477"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">language_name</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">language</span><span class="p">}),</span> <span class="n">language_name</span><span class="p">));</span>	<span class="c1">-- language name with wikilink</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos" data-line="1478"></span></a>			<span class="kr">end</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos" data-line="1479"></span></a>		<span class="kr">end</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos" data-line="1480"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">);</span>												<span class="c1">-- separator</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos" data-line="1481"></span></a>	<span class="kr">end</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos" data-line="1482"></span></a>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos" data-line="1483"></span></a>	<span class="kr">if</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">invert</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="kr">then</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos" data-line="1484"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">invert_italics</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos" data-line="1485"></span></a>	<span class="kr">end</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos" data-line="1486"></span></a>	
</span><span id="L-1487"><a href="#L-1487"><span class="linenos" data-line="1487"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">proto_prefix</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">proto</span><span class="p">);</span>			<span class="c1">-- prefix proto-language text with a splat</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos" data-line="1488"></span></a>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos" data-line="1489"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_text_html</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">rtl</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;none&#39;</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">label</span><span class="p">)</span> <span class="ow">and</span> <span class="n">language_name</span> <span class="ow">or</span> <span class="kc">nil</span><span class="p">))</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos" data-line="1490"></span></a>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos" data-line="1491"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">translit</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_latn_text</span> <span class="kr">then</span>							<span class="c1">-- transliteration; not supported when args.text is wholly latn text (this is an imperfect test)</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos" data-line="1492"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="p">);</span>												<span class="c1">-- comma to separate text from translit</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos" data-line="1493"></span></a>		<span class="kr">if</span> <span class="s1">&#39;none&#39;</span> <span class="o">~=</span> <span class="n">args</span><span class="p">.</span><span class="n">label</span> <span class="kr">then</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos" data-line="1494"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s1">&#39;&lt;small&gt;&#39;</span><span class="p">);</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos" data-line="1495"></span></a>			<span class="kr">if</span> <span class="n">script_table</span><span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;translit-script&#39;</span><span class="p">]]</span> <span class="kr">then</span>						<span class="c1">-- when |translit-script= is set, try to use the script&#39;s name</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos" data-line="1496"></span></a>				<span class="n">translit_script_name</span> <span class="o">=</span> <span class="n">script_table</span><span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;translit-script&#39;</span><span class="p">]];</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos" data-line="1497"></span></a>			<span class="kr">else</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos" data-line="1498"></span></a>				<span class="n">translit_script_name</span> <span class="o">=</span> <span class="n">language_name</span><span class="p">;</span>							<span class="c1">-- fall back on language name</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos" data-line="1499"></span></a>			<span class="kr">end</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos" data-line="1500"></span></a>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos" data-line="1501"></span></a>			<span class="kd">local</span> <span class="n">translit_title_obj</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">title</span><span class="p">.</span><span class="n">makeTitle</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,{</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">romanization</span><span class="p">,</span> <span class="n">translit_script_name</span><span class="p">}));</span>		<span class="c1">-- make a title object; no engvar, article titles use US spelling</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos" data-line="1502"></span></a>			<span class="kr">if</span> <span class="n">translit_title_obj</span><span class="p">.</span><span class="n">exists</span> <span class="ow">and</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">negative</span> <span class="o">~=</span> <span class="n">args</span><span class="p">.</span><span class="n">link</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos" data-line="1503"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">romanization</span><span class="p">,</span> <span class="n">translit_script_name</span> <span class="ow">or</span> <span class="n">language_name</span><span class="p">}),</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos" data-line="1504"></span></a>					<span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">engvar_t</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">][</span><span class="s1">&#39;romanisz_pt&#39;</span><span class="p">]}))</span> <span class="o">..</span> <span class="s1">&#39;:&#39;</span><span class="p">);</span>	<span class="c1">-- make a wikilink if there is an article to link to; engvar the display text</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos" data-line="1505"></span></a>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos" data-line="1506"></span></a>			<span class="kr">else</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos" data-line="1507"></span></a>				<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1:&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">engvar_t</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">][</span><span class="s1">&#39;romanisz_pt&#39;</span><span class="p">]}));</span>	<span class="c1">-- else plain text per engvar</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos" data-line="1508"></span></a>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos" data-line="1509"></span></a>			<span class="kr">end</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos" data-line="1510"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s1">&#39;&amp;nbsp;&lt;/small&gt;&#39;</span><span class="p">);</span>								<span class="c1">-- close the small tag</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos" data-line="1511"></span></a>		<span class="kr">end</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos" data-line="1512"></span></a>		
</span><span id="L-1513"><a href="#L-1513"><span class="linenos" data-line="1513"></span></a>		<span class="n">translit</span> <span class="o">=</span> <span class="n">make_translit</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">translit</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;translit-std&#39;</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;translit-script&#39;</span><span class="p">],</span> <span class="kc">nil</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">)</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos" data-line="1514"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">translit</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos" data-line="1515"></span></a>			<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">translit</span><span class="p">);</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos" data-line="1516"></span></a>		<span class="kr">else</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos" data-line="1517"></span></a>			<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1: $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">invalid_xlit_std</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;translit-std&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;[missing]&#39;</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos" data-line="1518"></span></a>		<span class="kr">end</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos" data-line="1519"></span></a>	
</span><span id="L-1520"><a href="#L-1520"><span class="linenos" data-line="1520"></span></a>	<span class="kr">elseif</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">translit</span><span class="p">)</span> <span class="ow">and</span> <span class="n">is_latn_text</span> <span class="kr">then</span>							<span class="c1">-- when creating a transliteration of Latn script &lt;text&gt;</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos" data-line="1521"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">xlit_of_latn</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>		<span class="c1">-- emit error message and abandon</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos" data-line="1522"></span></a>	<span class="kr">end</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos" data-line="1523"></span></a>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos" data-line="1524"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">translation</span><span class="p">)</span> <span class="kr">then</span>											<span class="c1">-- translation (not supported in {{lang}})</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos" data-line="1525"></span></a>		<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">translation_make</span> <span class="p">(</span><span class="n">args</span><span class="p">));</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos" data-line="1526"></span></a>	<span class="kr">end</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos" data-line="1527"></span></a>	
</span><span id="L-1528"><a href="#L-1528"><span class="linenos" data-line="1528"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">make_category</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">nocat</span><span class="p">));</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos" data-line="1529"></span></a>	<span class="nb">table.insert</span> <span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">render_maint</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">nocat</span><span class="p">));</span>								<span class="c1">-- maintenance messages and categories</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos" data-line="1530"></span></a>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos" data-line="1531"></span></a>	<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">(</span><span class="n">out</span><span class="p">);</span>													<span class="c1">-- put it all together and done</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos" data-line="1532"></span></a><span class="kr">end</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos" data-line="1533"></span></a>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos" data-line="1534"></span></a>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos" data-line="1535"></span></a><span class="cm">--[[--------------------------&lt; L A N G _ X X _ A R G S _ G E T &gt;----------------------------------------------</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos" data-line="1536"></span></a>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos" data-line="1537"></span></a><span class="cm">Common function to get args table from {{lang-??}} templates.</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos" data-line="1538"></span></a>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos" data-line="1539"></span></a><span class="cm">Returns table of args.</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos" data-line="1540"></span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos" data-line="1541"></span></a><span class="cm">Text positional parameters are not trimmed here but are selectively trimmed at html_tag_select().</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos" data-line="1542"></span></a>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos" data-line="1543"></span></a><span class="cm">]]</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos" data-line="1544"></span></a>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos" data-line="1545"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">lang_xx_args_get</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">base_template</span><span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos" data-line="1546"></span></a>	<span class="kd">local</span> <span class="n">args_t</span> <span class="o">=</span> <span class="n">getArgs</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos" data-line="1547"></span></a>		<span class="p">{</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos" data-line="1548"></span></a>		<span class="n">parentFirst</span><span class="o">=</span> <span class="kc">true</span><span class="p">,</span>														<span class="c1">-- parameters in the template override parameters set in the {{#invoke:}}</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos" data-line="1549"></span></a>		<span class="n">valueFunc</span> <span class="o">=</span> <span class="kr">function</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos" data-line="1550"></span></a>			<span class="kr">if</span> <span class="p">((</span><span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span> <span class="o">==</span> <span class="n">base_template</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">2</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">key</span> <span class="kr">then</span>	<span class="c1">-- the &#39;text&#39; positional parameter; 1 for {{lang-??}}, 2 for {{langx}}; do not trim wite space</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos" data-line="1551"></span></a>				<span class="kr">return</span> <span class="n">value</span><span class="p">;</span>													<span class="c1">-- return untrimmed &#39;text&#39; positional parameter</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos" data-line="1552"></span></a>			<span class="kr">elseif</span> <span class="n">value</span> <span class="kr">then</span>													<span class="c1">-- all other values: if the value is not nil</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos" data-line="1553"></span></a>				<span class="n">value</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">trim</span> <span class="p">(</span><span class="n">value</span><span class="p">);</span>									<span class="c1">-- trim whitespace</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos" data-line="1554"></span></a>				<span class="kr">if</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">value</span> <span class="kr">then</span>												<span class="c1">-- empty string when value was only whitespace</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos" data-line="1555"></span></a>					<span class="kr">return</span> <span class="n">value</span><span class="p">;</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos" data-line="1556"></span></a>				<span class="kr">end</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos" data-line="1557"></span></a>			<span class="kr">end</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos" data-line="1558"></span></a>			<span class="kr">return</span> <span class="kc">nil</span><span class="p">;</span>															<span class="c1">-- value was empty or contained only whitespace</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos" data-line="1559"></span></a>		<span class="kr">end</span>																		<span class="c1">-- end of valueFunc</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos" data-line="1560"></span></a>	<span class="p">});</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos" data-line="1561"></span></a>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos" data-line="1562"></span></a>	<span class="kr">return</span> <span class="n">args_t</span><span class="p">;</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos" data-line="1563"></span></a><span class="kr">end</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos" data-line="1564"></span></a>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos" data-line="1565"></span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos" data-line="1566"></span></a><span class="cm">--[[--------------------------&lt; L A N G _ X X _ I T A L I C &gt;--------------------------------------------------</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos" data-line="1567"></span></a>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos" data-line="1568"></span></a><span class="cm">Entry point for those {{lang-??}} templates that call lang_xx_italic(). Sets the initial style state to italic.</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos" data-line="1569"></span></a>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos" data-line="1570"></span></a><span class="cm">]]</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos" data-line="1571"></span></a>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos" data-line="1572"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">lang_xx_italic</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos" data-line="1573"></span></a>	<span class="kd">local</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lang_xx_args_get</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos" data-line="1574"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">fn</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>																<span class="c1">-- unset because not supported but this function might have been called by {{lang|fn=lang_xx_italic|...}}</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos" data-line="1575"></span></a>	
</span><span id="L-1576"><a href="#L-1576"><span class="linenos" data-line="1576"></span></a>	<span class="kd">local</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">parameter_validate</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>				<span class="c1">-- verify that all supplied parameters are supported by {{lang-??}}</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos" data-line="1577"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos" data-line="1578"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>				<span class="c1">-- when template has unsupported params, abandon with error message</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos" data-line="1579"></span></a>	<span class="kr">end</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos" data-line="1580"></span></a>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos" data-line="1581"></span></a>	<span class="n">initial_style_state</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">;</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos" data-line="1582"></span></a>	<span class="kr">return</span> <span class="n">_lang_xx</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">)</span> <span class="o">..</span> <span class="s1">&#39;[[Category:Pages using Lang-xx templates]]&#39;</span><span class="p">;</span>	<span class="c1">-- temporary category</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos" data-line="1583"></span></a><span class="kr">end</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos" data-line="1584"></span></a>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos" data-line="1585"></span></a>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos" data-line="1586"></span></a><span class="cm">--[[--------------------------&lt; _ L A N G _ X X _ I T A L I C &gt;------------------------------------------------</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos" data-line="1587"></span></a>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos" data-line="1588"></span></a><span class="cm">Entry point from another module. Sets the initial style state to italic.</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos" data-line="1589"></span></a>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos" data-line="1590"></span></a><span class="cm">]]</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos" data-line="1591"></span></a>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos" data-line="1592"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_lang_xx_italic</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos" data-line="1593"></span></a>	<span class="n">initial_style_state</span> <span class="o">=</span> <span class="s1">&#39;italic&#39;</span><span class="p">;</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos" data-line="1594"></span></a>	<span class="kr">return</span> <span class="n">_lang_xx</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos" data-line="1595"></span></a><span class="kr">end</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos" data-line="1596"></span></a>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos" data-line="1597"></span></a>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos" data-line="1598"></span></a><span class="cm">--[[--------------------------&lt; L A N G _ X X _ I N H E R I T &gt;------------------------------------------------</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos" data-line="1599"></span></a>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos" data-line="1600"></span></a><span class="cm">Entry point for those {{lang-??}} templates that call lang_xx_inherit(). Sets the initial style state to inherit.</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos" data-line="1601"></span></a>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos" data-line="1602"></span></a><span class="cm">]]</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos" data-line="1603"></span></a>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos" data-line="1604"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">lang_xx_inherit</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos" data-line="1605"></span></a>	<span class="kd">local</span> <span class="n">args</span> <span class="o">=</span> <span class="n">lang_xx_args_get</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos" data-line="1606"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">fn</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>																<span class="c1">-- unset because not supported but this function might have been called by {{lang|fn=lang_xx_inherit|...}}</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos" data-line="1607"></span></a>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos" data-line="1608"></span></a>	<span class="kd">local</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">parameter_validate</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>				<span class="c1">-- verify that all supplied parameters are supported by {{lang-??}}</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos" data-line="1609"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos" data-line="1610"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>				<span class="c1">-- when template has unsupported params, abandon with error message</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos" data-line="1611"></span></a>	<span class="kr">end</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos" data-line="1612"></span></a>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos" data-line="1613"></span></a>	<span class="n">initial_style_state</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">;</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos" data-line="1614"></span></a>	<span class="kr">return</span> <span class="n">_lang_xx</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">)</span> <span class="o">..</span> <span class="s1">&#39;[[Category:Pages using Lang-xx templates]]&#39;</span><span class="p">;</span>	<span class="c1">-- temporary category</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos" data-line="1615"></span></a><span class="kr">end</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos" data-line="1616"></span></a>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos" data-line="1617"></span></a>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos" data-line="1618"></span></a><span class="cm">--[[--------------------------&lt; _ L A N G _ X X _ I N H E R I T &gt;----------------------------------------------</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos" data-line="1619"></span></a>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos" data-line="1620"></span></a><span class="cm">Entry point from another module. Sets the initial style state to inherit.</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos" data-line="1621"></span></a>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos" data-line="1622"></span></a><span class="cm">]]</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos" data-line="1623"></span></a>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos" data-line="1624"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_lang_xx_inherit</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos" data-line="1625"></span></a>	<span class="n">initial_style_state</span> <span class="o">=</span> <span class="s1">&#39;inherit&#39;</span><span class="p">;</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos" data-line="1626"></span></a>	<span class="kr">return</span> <span class="n">_lang_xx</span> <span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langxx</span><span class="p">);</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos" data-line="1627"></span></a><span class="kr">end</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos" data-line="1628"></span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos" data-line="1629"></span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos" data-line="1630"></span></a><span class="cm">--[[--------------------------&lt; _ L A N G X &gt;------------------------------------------------------------------</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos" data-line="1631"></span></a>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos" data-line="1632"></span></a><span class="cm">Entry point from another module.</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos" data-line="1633"></span></a>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos" data-line="1634"></span></a><span class="cm">]]</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos" data-line="1635"></span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos" data-line="1636"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_langx</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos" data-line="1637"></span></a>	<span class="kd">local</span> <span class="n">langx_data</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/langx&#39;</span><span class="p">);</span>						<span class="c1">-- get necessary data </span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos" data-line="1638"></span></a>	<span class="kd">local</span> <span class="n">rtl_t</span> <span class="o">=</span> <span class="n">langx_data</span><span class="p">.</span><span class="n">rtl_t</span><span class="p">;</span>												<span class="c1">-- get list of language tags for languages that are rendered right-to-left</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos" data-line="1639"></span></a>	<span class="kd">local</span> <span class="n">link_t</span> <span class="o">=</span> <span class="n">langx_data</span><span class="p">.</span><span class="n">link_t</span><span class="p">;</span>											<span class="c1">-- get list of language tags for {{lang-??}} templates that set |link=&lt;something&gt;</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos" data-line="1640"></span></a>	<span class="kd">local</span> <span class="n">size_t</span> <span class="o">=</span> <span class="n">langx_data</span><span class="p">.</span><span class="n">size_t</span><span class="p">;</span>											<span class="c1">-- get list of language tags for {{lang-??}} templates that set |size=&lt;something&gt;</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos" data-line="1641"></span></a>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos" data-line="1642"></span></a>	<span class="kd">local</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">parameter_validate</span> <span class="p">(</span><span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span><span class="p">);</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos" data-line="1643"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos" data-line="1644"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span><span class="p">);</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos" data-line="1645"></span></a>	<span class="kr">end</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos" data-line="1646"></span></a>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos" data-line="1647"></span></a>	<span class="n">args_t</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">args_t</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>										<span class="c1">-- get the language tag; must be {{{1}}} or |code=</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos" data-line="1648"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">args_t</span><span class="p">.</span><span class="n">code</span> <span class="kr">then</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos" data-line="1649"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">get_ietf_parts_t</span><span class="p">.</span><span class="n">missing_lang_tag</span><span class="p">,</span> <span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span><span class="p">);</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos" data-line="1650"></span></a>	<span class="kr">end</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos" data-line="1651"></span></a>	
</span><span id="L-1652"><a href="#L-1652"><span class="linenos" data-line="1652"></span></a>	<span class="n">args_t</span><span class="p">.</span><span class="n">rtl</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">rtl</span> <span class="ow">or</span> <span class="p">(</span><span class="n">rtl_t</span><span class="p">[</span><span class="n">args_t</span><span class="p">.</span><span class="n">code</span><span class="p">]</span> <span class="ow">and</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span><span class="p">);</span>	<span class="c1">-- prefer |rtl= in template call, use rtl_t else</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos" data-line="1653"></span></a>	<span class="n">args_t</span><span class="p">.</span><span class="n">link</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">link</span> <span class="ow">or</span> <span class="n">link_t</span><span class="p">[</span><span class="n">args_t</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>							<span class="c1">-- prefer |link= in template call, use link_t felse</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos" data-line="1654"></span></a>	<span class="n">args_t</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">size</span> <span class="ow">or</span> <span class="n">size_t</span><span class="p">[</span><span class="n">args_t</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>							<span class="c1">-- prefer |size= in template call, use size_t else</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos" data-line="1655"></span></a>	
</span><span id="L-1656"><a href="#L-1656"><span class="linenos" data-line="1656"></span></a>	<span class="n">args_t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>															<span class="c1">-- unset to mimic {{lang-??}} templates which set |code=xx</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos" data-line="1657"></span></a>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos" data-line="1658"></span></a>	<span class="kd">local</span> <span class="n">lang_subtag</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>											<span class="c1">-- use only the base language subtag for unsupported tag test; some args_t.code are modified by |script= etc</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos" data-line="1659"></span></a>	<span class="kr">return</span> <span class="n">_lang_xx</span> <span class="p">(</span><span class="n">args_t</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span><span class="p">);</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos" data-line="1660"></span></a><span class="kr">end</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos" data-line="1661"></span></a>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos" data-line="1662"></span></a>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos" data-line="1663"></span></a><span class="cm">--[[--------------------------&lt; L A N G X &gt;--------------------------------------------------------------------</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos" data-line="1664"></span></a>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos" data-line="1665"></span></a><span class="cm">Entry point for {{langx}}.</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos" data-line="1666"></span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos" data-line="1667"></span></a><span class="cm">this function calls _lang_xx() to render non-English text. The {{lang-??}} templates have three positional paramters</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos" data-line="1668"></span></a><span class="cm">but {{langx}} has four:</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos" data-line="1669"></span></a>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos" data-line="1670"></span></a><span class="cm">				|  1	|  2		|  3		|  4	</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos" data-line="1671"></span></a><span class="cm">	{{lang-xx	|&lt;text&gt;	|&lt;transl&gt;	|&lt;xlate&gt;			}}</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos" data-line="1672"></span></a><span class="cm">	{{langx		|&lt;tag&gt;	|&lt;text&gt;		|&lt;transl&gt;	|&lt;xlate&gt;	}}</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos" data-line="1673"></span></a>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos" data-line="1674"></span></a><span class="cm">The calls to lang_xx_args_get() and _lang_xx() use &#39;Langx&#39; as a flag for those functions to select the proper</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos" data-line="1675"></span></a><span class="cm">positional parameters.</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos" data-line="1676"></span></a>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos" data-line="1677"></span></a><span class="cm">{{lang-??}} depends on the calling template to select &#39;inherit&#39; or &#39;italic&#39; to establish the default rendering.</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos" data-line="1678"></span></a>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos" data-line="1679"></span></a><span class="cm">{{langx}} can&#39;t do that.  The initial version of {{langx}} relied on a list of language tags (inherit_t in ~/langx)</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos" data-line="1680"></span></a><span class="cm">scraped from those {{lang-??}} templates that call lang_xx_inherit() to render text in upright font. Langx now</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos" data-line="1681"></span></a><span class="cm">uses auto-italics code adapted from {{lang}} (doesn&#39;t support poem tags).</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos" data-line="1682"></span></a>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos" data-line="1683"></span></a><span class="cm">]]</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos" data-line="1684"></span></a>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos" data-line="1685"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">langx</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos" data-line="1686"></span></a>	<span class="kd">local</span> <span class="n">args_t</span> <span class="o">=</span> <span class="n">lang_xx_args_get</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">langx</span><span class="p">);</span>				<span class="c1">-- get the arguments; &#39;Langx&#39; is the &lt;base_template&gt; used to decide which positional param is &#39;text&#39;, &#39;translit&#39;, &#39;lit&#39;</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos" data-line="1687"></span></a>	
</span><span id="L-1688"><a href="#L-1688"><span class="linenos" data-line="1688"></span></a>	<span class="kr">return</span> <span class="n">_langx</span> <span class="p">(</span><span class="n">args_t</span><span class="p">);</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos" data-line="1689"></span></a><span class="kr">end</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos" data-line="1690"></span></a>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos" data-line="1691"></span></a>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos" data-line="1692"></span></a><span class="cm">--[[--------------------------&lt; _ I S _ I E T F _ T A G &gt;------------------------------------------------------</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos" data-line="1693"></span></a>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos" data-line="1694"></span></a><span class="cm">Returns true when a language name associated with IETF language tag exists; nil else.  IETF language tag must be valid.</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos" data-line="1695"></span></a>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos" data-line="1696"></span></a><span class="cm">All code combinations supported by {{lang}} and the {{lang-??}} templates are supported by this function.</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos" data-line="1697"></span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos" data-line="1698"></span></a><span class="cm">Module entry point from another module.</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos" data-line="1699"></span></a>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos" data-line="1700"></span></a><span class="cm">]]</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos" data-line="1701"></span></a>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos" data-line="1702"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_is_ietf_tag</span> <span class="p">(</span><span class="n">tag</span><span class="p">)</span>												<span class="c1">-- entry point when this module is require()d into another</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos" data-line="1703"></span></a>	<span class="kd">local</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">err</span><span class="p">;</span>													<span class="c1">-- code, script, region, variant, private, error message</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos" data-line="1704"></span></a>	<span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">get_ietf_parts</span> <span class="p">(</span><span class="n">tag</span><span class="p">);</span>									<span class="c1">-- disassemble tag into constituent part and validate</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos" data-line="1705"></span></a>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos" data-line="1706"></span></a>	<span class="kr">return</span> <span class="p">((</span><span class="n">c</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">err</span><span class="p">)</span> <span class="ow">and</span> <span class="kc">true</span><span class="p">)</span> <span class="ow">or</span> <span class="kc">nil</span><span class="p">;</span>									<span class="c1">-- return true when code portion has a value without error message; nil else</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos" data-line="1707"></span></a><span class="kr">end</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos" data-line="1708"></span></a>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos" data-line="1709"></span></a>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos" data-line="1710"></span></a><span class="cm">--[[--------------------------&lt; I S _ I E T F _ T A G &gt;--------------------------------------------------------</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos" data-line="1711"></span></a>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos" data-line="1712"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos" data-line="1713"></span></a>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos" data-line="1714"></span></a><span class="cm">]]</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos" data-line="1715"></span></a>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos" data-line="1716"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">is_ietf_tag</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos" data-line="1717"></span></a>	<span class="kr">return</span> <span class="n">_is_ietf_tag</span> <span class="p">(</span><span class="n">getArgs</span> <span class="p">(</span><span class="n">frame</span><span class="p">)[</span><span class="mi">1</span><span class="p">]);</span>									<span class="c1">-- args[1] is the ietf language tag to be tested; also get parent frame</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos" data-line="1718"></span></a><span class="kr">end</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos" data-line="1719"></span></a>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos" data-line="1720"></span></a>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos" data-line="1721"></span></a><span class="cm">--[[--------------------------&lt; I S _ I E T F _ T A G _ F R A M E &gt;--------------------------------------------</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos" data-line="1722"></span></a>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos" data-line="1723"></span></a><span class="cm">Module entry point from an {{#invoke:}}; same as is_ietf_tag() except does not get parameters from the parent</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos" data-line="1724"></span></a><span class="cm">(template) frame.  This function not useful when called by {{lang|fn=is_ietf_tag_frame|&lt;tag&gt;}} because &lt;tag&gt;</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos" data-line="1725"></span></a><span class="cm">is in the parent frame.</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos" data-line="1726"></span></a>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos" data-line="1727"></span></a><span class="cm">]]</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos" data-line="1728"></span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos" data-line="1729"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">is_ietf_tag_frame</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos" data-line="1730"></span></a>	<span class="kr">return</span> <span class="n">_is_ietf_tag</span> <span class="p">(</span><span class="n">getArgs</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="p">{</span><span class="n">frameOnly</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,})[</span><span class="mi">1</span><span class="p">]);</span>				<span class="c1">-- args[1] is the ietf language tag to be tested; do not get parent frame</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos" data-line="1731"></span></a><span class="kr">end</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos" data-line="1732"></span></a>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos" data-line="1733"></span></a>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos" data-line="1734"></span></a><span class="cm">--[[--------------------------&lt; _ N A M E _ F R O M _ T A G &gt;--------------------------------------------------</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos" data-line="1735"></span></a>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos" data-line="1736"></span></a><span class="cm">Returns language name associated with IETF language tag if valid; error message else.</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos" data-line="1737"></span></a>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos" data-line="1738"></span></a><span class="cm">All code combinations supported by {{lang}} and the {{lang-??}} templates are supported by this function.</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos" data-line="1739"></span></a>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos" data-line="1740"></span></a><span class="cm">Set invoke&#39;s |link= parameter to yes to get wikilinked version of the language name.</span>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos" data-line="1741"></span></a>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos" data-line="1742"></span></a><span class="cm">Module entry point from another module.</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos" data-line="1743"></span></a>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos" data-line="1744"></span></a><span class="cm">]]</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos" data-line="1745"></span></a>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos" data-line="1746"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_name_from_tag</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos" data-line="1747"></span></a>	<span class="kd">local</span> <span class="n">subtags</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- IETF subtags script, region, variant, and private</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos" data-line="1748"></span></a>	<span class="kd">local</span> <span class="n">raw_code</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>													<span class="c1">-- save a copy of the input IETF subtag</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos" data-line="1749"></span></a>	<span class="kd">local</span> <span class="n">link</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span> <span class="o">==</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;link&#39;</span><span class="p">];</span>					<span class="c1">-- make a boolean</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos" data-line="1750"></span></a>	<span class="kd">local</span> <span class="n">label</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">label</span><span class="p">;</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos" data-line="1751"></span></a>	<span class="kd">local</span> <span class="n">code</span><span class="p">;</span>																	<span class="c1">-- the language code</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos" data-line="1752"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>																	<span class="c1">-- gets an error message if IETF language tag is malformed or invalid</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos" data-line="1753"></span></a>	<span class="kd">local</span> <span class="n">language_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos" data-line="1754"></span></a>	
</span><span id="L-1755"><a href="#L-1755"><span class="linenos" data-line="1755"></span></a>	<span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">get_ietf_parts</span> <span class="p">(</span><span class="n">raw_code</span><span class="p">);</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos" data-line="1756"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos" data-line="1757"></span></a>		<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;template&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;{{&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;template&#39;</span><span class="p">],</span> <span class="s1">&#39;}}: &#39;</span><span class="p">}))</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>	<span class="c1">-- make template name (if provided by the template)</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos" data-line="1758"></span></a>		<span class="kr">return</span> <span class="n">make_error_span</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos" data-line="1759"></span></a>	<span class="kr">end</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos" data-line="1760"></span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos" data-line="1761"></span></a>	<span class="n">raw_code</span> <span class="o">=</span> <span class="n">format_ietf_tag</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">);</span>	<span class="c1">-- format to recommended subtag styles; private omitted because private</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos" data-line="1762"></span></a>	<span class="n">language_name</span> <span class="o">=</span> <span class="n">language_name_get</span> <span class="p">(</span><span class="n">raw_code</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>							<span class="c1">-- get language name; try ietf tag first, then code w/o variant then code w/ variant</span>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos" data-line="1763"></span></a>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos" data-line="1764"></span></a>	<span class="kr">if</span> <span class="s1">&#39;yes&#39;</span> <span class="o">~=</span> <span class="n">args</span><span class="p">.</span><span class="n">raw</span> <span class="kr">then</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos" data-line="1765"></span></a>		<span class="n">language_name</span> <span class="o">=</span> <span class="n">language_name</span><span class="p">:</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;%s+%b()&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>						<span class="c1">-- remove IANA parenthetical disambiguators or qualifiers from names that have them</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos" data-line="1766"></span></a>	<span class="kr">end</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos" data-line="1767"></span></a>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos" data-line="1768"></span></a>	<span class="kr">if</span> <span class="n">link</span> <span class="kr">then</span>																<span class="c1">-- when |link=yes, wikilink the language name</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos" data-line="1769"></span></a>		<span class="kr">if</span> <span class="n">mw</span><span class="p">.</span><span class="n">ustring</span><span class="p">.</span><span class="n">find</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="kr">then</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos" data-line="1770"></span></a>			<span class="n">language_name</span> <span class="o">=</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">language_name</span><span class="p">,</span> <span class="n">label</span><span class="p">);</span>				<span class="c1">-- collective language name uses simple wikilink</span>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos" data-line="1771"></span></a>		<span class="kr">elseif</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">raw_code</span><span class="p">:</span><span class="n">lower</span><span class="p">()]</span> <span class="kr">then</span>					<span class="c1">-- is ietf tag in article name override?</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos" data-line="1772"></span></a>			<span class="n">language_name</span> <span class="o">=</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">raw_code</span><span class="p">:</span><span class="n">lower</span><span class="p">()],</span> <span class="n">label</span> <span class="ow">or</span> <span class="n">language_name</span><span class="p">);</span>	<span class="c1">-- language name with wikilink from override data</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos" data-line="1773"></span></a>		<span class="kr">elseif</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>								<span class="c1">-- is language tag in article name override?</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos" data-line="1774"></span></a>			<span class="n">language_name</span> <span class="o">=</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">lang_data</span><span class="p">.</span><span class="n">article_name</span><span class="p">[</span><span class="n">code</span><span class="p">],</span> <span class="n">label</span> <span class="ow">or</span> <span class="n">language_name</span><span class="p">);</span>	<span class="c1">-- language name with wikilink from override data</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos" data-line="1775"></span></a>		<span class="kr">else</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos" data-line="1776"></span></a>			<span class="n">language_name</span> <span class="o">=</span> <span class="n">make_wikilink</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="s1">&#39;$1 $2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">language_name</span><span class="p">,</span> <span class="n">cfg</span><span class="p">.</span><span class="n">misc_text_t</span><span class="p">.</span><span class="n">language</span><span class="p">}),</span> <span class="n">label</span> <span class="ow">or</span> <span class="n">language_name</span><span class="p">);</span>	<span class="c1">-- language name with wikilink</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos" data-line="1777"></span></a>		<span class="kr">end</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos" data-line="1778"></span></a>	<span class="kr">end</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos" data-line="1779"></span></a>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos" data-line="1780"></span></a>	<span class="kr">return</span> <span class="n">language_name</span><span class="p">;</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos" data-line="1781"></span></a><span class="kr">end</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos" data-line="1782"></span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos" data-line="1783"></span></a>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos" data-line="1784"></span></a><span class="cm">--[[--------------------------&lt; N A M E _ F R O M _ T A G &gt;----------------------------------------------------</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos" data-line="1785"></span></a>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos" data-line="1786"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos" data-line="1787"></span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos" data-line="1788"></span></a><span class="cm">]]</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos" data-line="1789"></span></a>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos" data-line="1790"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">name_from_tag</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>											<span class="c1">-- entry point from an {{#invoke:Lang|name_from_tag|&lt;ietf tag&gt;|link=&lt;yes&gt;|template=&lt;template name&gt;}}</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos" data-line="1791"></span></a>	<span class="kr">return</span> <span class="n">_name_from_tag</span> <span class="p">(</span><span class="n">getArgs</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>										<span class="c1">-- pass-on the args table, nothing else; getArgs() so we also get parent frame</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos" data-line="1792"></span></a><span class="kr">end</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos" data-line="1793"></span></a>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos" data-line="1794"></span></a>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos" data-line="1795"></span></a><span class="cm">--[[--------------------------&lt; _ T A G _ F R O M _ N A M E &gt;--------------------------------------------------</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos" data-line="1796"></span></a>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos" data-line="1797"></span></a><span class="cm">Returns the ietf language tag associated with the language name.  Spelling of language name must be correct</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos" data-line="1798"></span></a><span class="cm">according to the spelling in the source tables.  When a standard language name has a parenthetical disambiguator,</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos" data-line="1799"></span></a><span class="cm">that disambiguator must be omitted (they are not present in the data name-to-tag tables).</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos" data-line="1800"></span></a>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos" data-line="1801"></span></a><span class="cm">Module entry point from another module.</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos" data-line="1802"></span></a>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos" data-line="1803"></span></a><span class="cm">]]</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos" data-line="1804"></span></a>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos" data-line="1805"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_tag_from_name</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>											<span class="c1">-- entry point from another module</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos" data-line="1806"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos" data-line="1807"></span></a>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos" data-line="1808"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos" data-line="1809"></span></a>		<span class="kd">local</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mw</span><span class="p">.</span><span class="n">loadData</span> <span class="p">(</span><span class="s1">&#39;Module:Lang/tag from name&#39;</span><span class="p">);</span>					<span class="c1">-- get the reversed data tables TODO: change when going live</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos" data-line="1810"></span></a>		<span class="kd">local</span> <span class="n">lang</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">lower</span><span class="p">();</span>											<span class="c1">-- allow any-case for the language name (speeling must till be correct)</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos" data-line="1811"></span></a>		<span class="kd">local</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">rev_override_table</span><span class="p">[</span><span class="n">lang</span><span class="p">]</span> <span class="ow">or</span> <span class="n">data</span><span class="p">.</span><span class="n">rev_lang_table</span><span class="p">[</span><span class="n">lang</span><span class="p">]</span> <span class="ow">or</span> <span class="n">data</span><span class="p">.</span><span class="n">rev_lang_dep_table</span><span class="p">[</span><span class="n">lang</span><span class="p">];</span>	<span class="c1">-- get the code; look first in the override then in the standard</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos" data-line="1812"></span></a>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos" data-line="1813"></span></a>		<span class="kr">if</span> <span class="n">tag</span> <span class="kr">then</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos" data-line="1814"></span></a>			<span class="kr">return</span> <span class="n">tag</span><span class="p">,</span> <span class="kc">true</span><span class="p">;</span>													<span class="c1">-- language name found so return tag and done; second return used by is_lang_name()</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos" data-line="1815"></span></a>		<span class="kr">else</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos" data-line="1816"></span></a>			<span class="n">msg</span> <span class="o">=</span> <span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">tag_from_name_t</span><span class="p">.</span><span class="n">lang_not_found</span><span class="p">,</span> <span class="p">{</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]});</span>	<span class="c1">-- language name not found, error message</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos" data-line="1817"></span></a>		<span class="kr">end</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos" data-line="1818"></span></a>	<span class="kr">else</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos" data-line="1819"></span></a>		<span class="n">msg</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">tag_from_name_t</span><span class="p">.</span><span class="n">missing_lang_name</span><span class="p">;</span>							<span class="c1">-- language name not found, error message</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos" data-line="1820"></span></a>	<span class="kr">end</span>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos" data-line="1821"></span></a>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos" data-line="1822"></span></a>	<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos" data-line="1823"></span></a>	<span class="kr">if</span> <span class="n">args</span><span class="p">.</span><span class="n">template</span> <span class="ow">and</span> <span class="s1">&#39;&#39;</span> <span class="o">~=</span> <span class="n">args</span><span class="p">.</span><span class="n">template</span> <span class="kr">then</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos" data-line="1824"></span></a>		<span class="n">template</span> <span class="o">=</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;{{&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;template&#39;</span><span class="p">],</span> <span class="s1">&#39;}}: &#39;</span><span class="p">});</span>				<span class="c1">-- make template name (if provided by the template)</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos" data-line="1825"></span></a>	<span class="kr">end</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos" data-line="1826"></span></a>	<span class="kr">return</span> <span class="n">make_error_span</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos" data-line="1827"></span></a>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos" data-line="1828"></span></a><span class="kr">end</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos" data-line="1829"></span></a>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos" data-line="1830"></span></a>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos" data-line="1831"></span></a><span class="cm">--[[--------------------------&lt; T A G _ F R O M _ N A M E &gt;----------------------------------------------------</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos" data-line="1832"></span></a>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos" data-line="1833"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos" data-line="1834"></span></a>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos" data-line="1835"></span></a><span class="cm">]]</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos" data-line="1836"></span></a>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos" data-line="1837"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">tag_from_name</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>											<span class="c1">-- entry point from an {{#invoke:Lang|tag_from_name|&lt;language name&gt;|link=&lt;yes&gt;|template=&lt;template name&gt;}}</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos" data-line="1838"></span></a>	<span class="kd">local</span> <span class="n">result</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_tag_from_name</span> <span class="p">(</span><span class="n">getArgs</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>							<span class="c1">-- pass-on the args table, nothing else; getArgs() so we also get parent frame; supress second return used by is_lang_name()</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos" data-line="1839"></span></a>	<span class="kr">return</span> <span class="n">result</span><span class="p">;</span>		
</span><span id="L-1840"><a href="#L-1840"><span class="linenos" data-line="1840"></span></a><span class="kr">end</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos" data-line="1841"></span></a>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos" data-line="1842"></span></a>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos" data-line="1843"></span></a><span class="cm">--[[--------------------------&lt; I S _ L A N G _ N A M E &gt;------------------------------------------------------</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos" data-line="1844"></span></a>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos" data-line="1845"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos" data-line="1846"></span></a>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos" data-line="1847"></span></a><span class="cm">]]</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos" data-line="1848"></span></a>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos" data-line="1849"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">is_lang_name</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos" data-line="1850"></span></a>	<span class="kd">local</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">_tag_from_name</span> <span class="p">(</span><span class="n">getArgs</span><span class="p">(</span><span class="n">frame</span><span class="p">))</span>							<span class="c1">-- pass-on the args table, nothing else; getArgs() so we also get parent frame; supress second return used by tag_from_name()</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos" data-line="1851"></span></a>	<span class="kr">return</span> <span class="n">result</span> <span class="ow">and</span> <span class="kc">true</span> <span class="ow">or</span> <span class="kc">nil</span><span class="p">;</span>		
</span><span id="L-1852"><a href="#L-1852"><span class="linenos" data-line="1852"></span></a><span class="kr">end</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos" data-line="1853"></span></a>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos" data-line="1854"></span></a>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos" data-line="1855"></span></a><span class="cm">--[[--------------------------&lt; _ T R A N S L &gt;----------------------------------------------------------------</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos" data-line="1856"></span></a>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos" data-line="1857"></span></a><span class="cm">Module entry point from another module.</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos" data-line="1858"></span></a>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos" data-line="1859"></span></a><span class="cm">]]</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos" data-line="1860"></span></a>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos" data-line="1861"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_transl</span> <span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos" data-line="1862"></span></a>	<span class="kd">local</span> <span class="n">title_table</span> <span class="o">=</span> <span class="n">lang_data</span><span class="p">.</span><span class="n">translit_title_table</span><span class="p">;</span>							<span class="c1">-- table of transliteration standards and the language codes and scripts that apply to those standards</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos" data-line="1863"></span></a>	<span class="kd">local</span> <span class="n">language_name</span><span class="p">;</span>														<span class="c1">-- language name that matches language code; used for tool tip</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos" data-line="1864"></span></a>	<span class="kd">local</span> <span class="n">translit</span><span class="p">;</span>																<span class="c1">-- transliterated text to display</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos" data-line="1865"></span></a>	<span class="kd">local</span> <span class="n">script</span><span class="p">;</span>																<span class="c1">-- IANA script</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos" data-line="1866"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>																	<span class="c1">-- for when called functions return an error message</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos" data-line="1867"></span></a>	<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">template</span> <span class="ow">or</span> <span class="n">cfg</span><span class="p">.</span><span class="n">templates_t</span><span class="p">.</span><span class="n">transliteration</span><span class="p">;</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos" data-line="1868"></span></a>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos" data-line="1869"></span></a>	<span class="n">maint_cats</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- initialize because when this module required into another module, these only declared once so only initialzed once</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos" data-line="1870"></span></a>	<span class="n">maint_msgs</span> <span class="o">=</span> <span class="p">{};</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos" data-line="1871"></span></a>	
</span><span id="L-1872"><a href="#L-1872"><span class="linenos" data-line="1872"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="kr">then</span>													<span class="c1">-- [3] set when {{transliteration|code|standard|text}}</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos" data-line="1873"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>													<span class="c1">-- get the transliterated text</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos" data-line="1874"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">translit_std</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="n">lower</span><span class="p">();</span>						<span class="c1">-- get the standard; lower case for table indexing</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos" data-line="1875"></span></a>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos" data-line="1876"></span></a>		<span class="kr">if</span> <span class="ow">not</span> <span class="n">title_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">translit_std</span><span class="p">]</span> <span class="kr">then</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos" data-line="1877"></span></a>			<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">unrecog_xlit_std</span><span class="p">,</span> <span class="p">{</span><span class="n">args</span><span class="p">.</span><span class="n">translit_std</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos" data-line="1878"></span></a>		<span class="kr">end</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos" data-line="1879"></span></a>	<span class="kr">else</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos" data-line="1880"></span></a>		<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="kr">then</span>												<span class="c1">-- [2] set when {{transliteration|code|text}}</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos" data-line="1881"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>												<span class="c1">-- get the transliterated text</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos" data-line="1882"></span></a>		<span class="kr">else</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos" data-line="1883"></span></a>			<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%a%a%a?%a?$&#39;</span><span class="p">)</span> <span class="ow">or</span>					<span class="c1">-- args[2] missing; is args[1] a language or script tag or is it the transliterated text?</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos" data-line="1884"></span></a>				<span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%a%a%a?%-x%-&#39;</span><span class="p">))</span> <span class="kr">then</span>							<span class="c1">-- or is args[1] a private-use tag</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos" data-line="1885"></span></a>					<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">no_text</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>	<span class="c1">-- args[1] is a code so we&#39;re missing text</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos" data-line="1886"></span></a>			<span class="kr">else</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos" data-line="1887"></span></a>				<span class="n">args</span><span class="p">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>											<span class="c1">-- args[1] is not a code so we&#39;re missing that; assign args.text for error message</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos" data-line="1888"></span></a>				<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">missing_lang_scr</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos" data-line="1889"></span></a>			<span class="kr">end</span>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos" data-line="1890"></span></a>		<span class="kr">end</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos" data-line="1891"></span></a>	<span class="kr">end</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos" data-line="1892"></span></a>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos" data-line="1893"></span></a>	<span class="kr">if</span> <span class="n">is_set</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="kr">then</span>													<span class="c1">-- IANA language code used for html lang= attribute; or ISO 15924 script code</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos" data-line="1894"></span></a>		<span class="kr">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%a%a%a?%a?$&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%a%a%a?%-x%-&#39;</span><span class="p">)</span> <span class="kr">then</span>	<span class="c1">-- args[1] has correct form?</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos" data-line="1895"></span></a>			<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="n">lower</span><span class="p">();</span>										<span class="c1">-- use the language/script code; only (2, 3, or 4 alpha characters) or private-use; lower case because table indexes are lower case</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos" data-line="1896"></span></a>		<span class="kr">else</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos" data-line="1897"></span></a>			<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">unrecog_lang_scr</span><span class="p">,</span> <span class="p">{</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>	<span class="c1">-- invalid language / script code</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos" data-line="1898"></span></a>		<span class="kr">end</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos" data-line="1899"></span></a>	<span class="kr">else</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos" data-line="1900"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">missing_lang_scr</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>	<span class="c1">-- missing language / script code so quit</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos" data-line="1901"></span></a>	<span class="kr">end</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos" data-line="1902"></span></a>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos" data-line="1903"></span></a>	<span class="kd">local</span> <span class="n">is_latn_text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">;</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos" data-line="1904"></span></a>	<span class="n">is_latn_text</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="o">=</span> <span class="n">is_latin</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">);</span>		<span class="c1">-- is latn text? strip accept-as-written markup</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos" data-line="1905"></span></a>	<span class="kr">if</span> <span class="ow">not</span> <span class="n">is_latn_text</span> <span class="kr">then</span>													<span class="c1">-- when text is not latn</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos" data-line="1906"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">lang_xx_t</span><span class="p">.</span><span class="n">translit_nonlatn</span><span class="p">,</span> <span class="p">{</span><span class="n">pos</span><span class="p">,</span> <span class="n">char</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>	<span class="c1">-- abandon with error message</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos" data-line="1907"></span></a>	<span class="kr">end</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos" data-line="1908"></span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos" data-line="1909"></span></a>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos" data-line="1910"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">validate_italic</span> <span class="p">(</span><span class="n">args</span><span class="p">);</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos" data-line="1911"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos" data-line="1912"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos" data-line="1913"></span></a>	<span class="kr">end</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos" data-line="1914"></span></a>	
</span><span id="L-1915"><a href="#L-1915"><span class="linenos" data-line="1915"></span></a>	<span class="kr">if</span> <span class="s1">&#39;italic&#39;</span> <span class="o">==</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="kr">then</span>												<span class="c1">-- &#39;italic&#39; when |italic=yes; because that is same as absent or not set and |italic=default</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos" data-line="1916"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">;</span>														<span class="c1">-- set to nil; </span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos" data-line="1917"></span></a>	<span class="kr">end</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos" data-line="1918"></span></a>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos" data-line="1919"></span></a>	<span class="n">args</span><span class="p">.</span><span class="n">engvar</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">engvar_sel_t</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">]</span> <span class="ow">or</span> <span class="n">cfg</span><span class="p">.</span><span class="n">default_engvar</span><span class="p">;</span>			<span class="c1">-- |engvar= when valid; cfg.default_engvar else</span>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos" data-line="1920"></span></a>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos" data-line="1921"></span></a>	<span class="kr">if</span> <span class="n">override_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- is code a language code defined in the override table?</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos" data-line="1922"></span></a>		<span class="n">language_name</span> <span class="o">=</span> <span class="n">override_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos" data-line="1923"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">:</span><span class="n">match</span> <span class="p">(</span><span class="s1">&#39;^%a%a%a?&#39;</span><span class="p">);</span>								<span class="c1">-- if private use, strip all but language subtag</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos" data-line="1924"></span></a>	<span class="kr">elseif</span> <span class="n">lang_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- is code a language code defined in the standard language code tables?</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos" data-line="1925"></span></a>		<span class="n">language_name</span> <span class="o">=</span> <span class="n">lang_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos" data-line="1926"></span></a>	<span class="kr">elseif</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>										<span class="c1">-- is code a language code defined in the deprecated language code tables?</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos" data-line="1927"></span></a>		<span class="n">language_name</span> <span class="o">=</span> <span class="n">lang_dep_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos" data-line="1928"></span></a>	<span class="kr">elseif</span> <span class="n">script_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">]</span> <span class="kr">then</span>											<span class="c1">-- if here, code is not a language code; is it a script code?</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos" data-line="1929"></span></a>		<span class="n">language_name</span> <span class="o">=</span> <span class="n">script_table</span><span class="p">[</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">];</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos" data-line="1930"></span></a>		<span class="n">script</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">;</span>														<span class="c1">-- code was an ISO 15924 script so use that instead</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos" data-line="1931"></span></a>		<span class="n">args</span><span class="p">.</span><span class="n">code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>															<span class="c1">-- unset because not a language code</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos" data-line="1932"></span></a>	<span class="kr">else</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos" data-line="1933"></span></a>		<span class="kr">return</span> <span class="n">make_error_msg</span> <span class="p">(</span><span class="n">substitute</span> <span class="p">(</span><span class="n">cfg</span><span class="p">.</span><span class="n">transl_t</span><span class="p">.</span><span class="n">unrecog_lang_scr</span><span class="p">,</span> <span class="p">{</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">}),</span> <span class="n">args</span><span class="p">,</span> <span class="n">template</span><span class="p">);</span>	<span class="c1">-- invalid language / script code</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos" data-line="1934"></span></a>	<span class="kr">end</span>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos" data-line="1935"></span></a>																				<span class="c1">-- here only when all parameters passed to make_translit() are valid</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos" data-line="1936"></span></a>	<span class="kr">return</span> <span class="n">make_translit</span> <span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">code</span><span class="p">,</span> <span class="n">language_name</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">text</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">translit_std</span><span class="p">,</span> <span class="n">script</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">italic</span><span class="p">,</span> <span class="n">args</span><span class="p">.</span><span class="n">engvar</span><span class="p">);</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos" data-line="1937"></span></a><span class="kr">end</span>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos" data-line="1938"></span></a>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos" data-line="1939"></span></a>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos" data-line="1940"></span></a><span class="cm">--[[--------------------------&lt; T R A N S L &gt;------------------------------------------------------------------</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos" data-line="1941"></span></a>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos" data-line="1942"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos" data-line="1943"></span></a>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos" data-line="1944"></span></a><span class="cm">]]</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos" data-line="1945"></span></a>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos" data-line="1946"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">transl</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos" data-line="1947"></span></a>	<span class="kr">return</span> <span class="n">_transl</span> <span class="p">(</span><span class="n">getArgs</span><span class="p">(</span><span class="n">frame</span><span class="p">));</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos" data-line="1948"></span></a><span class="kr">end</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos" data-line="1949"></span></a>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos" data-line="1950"></span></a>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos" data-line="1951"></span></a><span class="cm">--[[--------------------------&lt; C A T E G O R Y _ F R O M _ T A G &gt;--------------------------------------------</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos" data-line="1952"></span></a>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos" data-line="1953"></span></a><span class="cm">Returns category name associated with IETF language tag if valid; error message else.</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos" data-line="1954"></span></a>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos" data-line="1955"></span></a><span class="cm">All code combinations supported by {{lang}} and the {{lang-??}} templates are supported by this function.</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos" data-line="1956"></span></a>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos" data-line="1957"></span></a><span class="cm">Module entry point from another module.</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos" data-line="1958"></span></a>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos" data-line="1959"></span></a><span class="cm">]]</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos" data-line="1960"></span></a>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos" data-line="1961"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">_category_from_tag</span> <span class="p">(</span><span class="n">args_t</span><span class="p">)</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos" data-line="1962"></span></a>	<span class="kd">local</span> <span class="n">subtags</span> <span class="o">=</span> <span class="p">{};</span>															<span class="c1">-- IETF subtags script, region, variant, and private</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos" data-line="1963"></span></a>	<span class="kd">local</span> <span class="n">raw_code</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>													<span class="c1">-- save a copy of the input IETF subtag</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos" data-line="1964"></span></a>	<span class="kd">local</span> <span class="n">link</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">.</span><span class="n">keywords_t</span><span class="p">.</span><span class="n">affirmative</span> <span class="o">==</span> <span class="n">args_t</span><span class="p">.</span><span class="n">link</span><span class="p">;</span>						<span class="c1">-- make a boolean</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos" data-line="1965"></span></a>	<span class="kd">local</span> <span class="n">label</span> <span class="o">=</span> <span class="n">args_t</span><span class="p">.</span><span class="n">label</span><span class="p">;</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos" data-line="1966"></span></a>	<span class="kd">local</span> <span class="n">code</span><span class="p">;</span>																	<span class="c1">-- the language code</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos" data-line="1967"></span></a>	<span class="kd">local</span> <span class="n">msg</span><span class="p">;</span>																	<span class="c1">-- gets an error message if IETF language tag is malformed or invalid</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos" data-line="1968"></span></a>	<span class="kd">local</span> <span class="n">category_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos" data-line="1969"></span></a>	
</span><span id="L-1970"><a href="#L-1970"><span class="linenos" data-line="1970"></span></a>	<span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">get_ietf_parts</span> <span class="p">(</span><span class="n">raw_code</span><span class="p">);</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos" data-line="1971"></span></a>	<span class="kr">if</span> <span class="n">msg</span> <span class="kr">then</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos" data-line="1972"></span></a>		<span class="kd">local</span> <span class="n">template</span> <span class="o">=</span> <span class="p">(</span><span class="n">args_t</span><span class="p">.</span><span class="n">template</span> <span class="ow">and</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;{{&#39;</span><span class="p">,</span> <span class="n">args_t</span><span class="p">.</span><span class="n">template</span><span class="p">,</span> <span class="s1">&#39;}}: &#39;</span><span class="p">}))</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>	<span class="c1">-- make template name (if provided by the template)</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos" data-line="1973"></span></a>		<span class="kr">return</span> <span class="n">make_error_span</span> <span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos" data-line="1974"></span></a>	<span class="kr">end</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos" data-line="1975"></span></a>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos" data-line="1976"></span></a>	<span class="n">raw_code</span> <span class="o">=</span> <span class="n">format_ietf_tag</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">script</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">region</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">variant</span><span class="p">,</span> <span class="n">subtags</span><span class="p">.</span><span class="n">private</span><span class="p">);</span>	<span class="c1">-- format to recommended subtag styles; private omitted because private</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos" data-line="1977"></span></a>	<span class="n">category_name</span> <span class="o">=</span> <span class="n">language_name_get</span> <span class="p">(</span><span class="n">raw_code</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>							<span class="c1">-- get language name; try ietf tag first, then code w/o variant then code w/ variant</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos" data-line="1978"></span></a>	<span class="n">category_name</span> <span class="o">=</span> <span class="n">make_category</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">true</span><span class="p">):</span><span class="n">gsub</span> <span class="p">(</span><span class="s1">&#39;[%[%]]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos" data-line="1979"></span></a>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos" data-line="1980"></span></a>	<span class="kr">if</span> <span class="n">link</span> <span class="kr">then</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos" data-line="1981"></span></a>		<span class="kr">return</span> <span class="nb">table.concat</span> <span class="p">({</span><span class="s1">&#39;[[:&#39;</span><span class="p">,</span> <span class="n">category_name</span><span class="p">,</span> <span class="s1">&#39;]]&#39;</span><span class="p">});</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos" data-line="1982"></span></a>	<span class="kr">else</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos" data-line="1983"></span></a>		<span class="kr">return</span> <span class="n">category_name</span><span class="p">;</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos" data-line="1984"></span></a>	<span class="kr">end</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos" data-line="1985"></span></a><span class="kr">end</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos" data-line="1986"></span></a>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos" data-line="1987"></span></a>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos" data-line="1988"></span></a><span class="cm">--[[--------------------------&lt; C A T E G O R Y _ F R O M _ T A G &gt;--------------------------------------------</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos" data-line="1989"></span></a>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos" data-line="1990"></span></a><span class="cm">Module entry point from an {{#invoke:}}.</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos" data-line="1991"></span></a>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos" data-line="1992"></span></a><span class="cm">]]</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos" data-line="1993"></span></a>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos" data-line="1994"></span></a><span class="kd">local</span> <span class="kr">function</span> <span class="nf">category_from_tag</span> <span class="p">(</span><span class="n">frame</span><span class="p">)</span>										<span class="c1">-- entry point from an {{#invoke:Lang|category_from_tag|&lt;ietf tag&gt;|template=&lt;template name&gt;}}</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos" data-line="1995"></span></a>	<span class="kr">return</span> <span class="n">_category_from_tag</span> <span class="p">(</span><span class="n">getArgs</span> <span class="p">(</span><span class="n">frame</span><span class="p">));</span>								<span class="c1">-- pass-on the args table, nothing else; getArgs() so we also get parent frame</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos" data-line="1996"></span></a><span class="kr">end</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos" data-line="1997"></span></a>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos" data-line="1998"></span></a>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos" data-line="1999"></span></a><span class="cm">--[[--------------------------&lt; E X P O R T E D   F U N C T I O N S &gt;------------------------------------------</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos" data-line="2000"></span></a><span class="cm">]]</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos" data-line="2001"></span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos" data-line="2002"></span></a><span class="kr">return</span> <span class="p">{</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos" data-line="2003"></span></a>	<span class="n">category_from_tag</span> <span class="o">=</span> <span class="n">category_from_tag</span><span class="p">,</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos" data-line="2004"></span></a>	<span class="n">lang</span> <span class="o">=</span> <span class="n">lang</span><span class="p">,</span>																<span class="c1">-- entry point for {{lang}}</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos" data-line="2005"></span></a>	<span class="n">langx</span> <span class="o">=</span> <span class="n">langx</span><span class="p">,</span>																<span class="c1">-- entry point for {{langx}}</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos" data-line="2006"></span></a>	<span class="n">lang_xx_inherit</span> <span class="o">=</span> <span class="n">lang_xx_inherit</span><span class="p">,</span>											<span class="c1">-- entry points for {{lang-??}}</span>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos" data-line="2007"></span></a>	<span class="n">lang_xx_italic</span> <span class="o">=</span> <span class="n">lang_xx_italic</span><span class="p">,</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos" data-line="2008"></span></a>	<span class="n">is_ietf_tag</span> <span class="o">=</span> <span class="n">is_ietf_tag</span><span class="p">,</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos" data-line="2009"></span></a>	<span class="n">is_ietf_tag_frame</span> <span class="o">=</span> <span class="n">is_ietf_tag_frame</span><span class="p">,</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos" data-line="2010"></span></a>	<span class="n">is_lang_name</span> <span class="o">=</span> <span class="n">is_lang_name</span><span class="p">,</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos" data-line="2011"></span></a>	<span class="n">tag_from_name</span> <span class="o">=</span> <span class="n">tag_from_name</span><span class="p">,</span>												<span class="c1">-- returns ietf tag associated with language name</span>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos" data-line="2012"></span></a>	<span class="n">name_from_tag</span> <span class="o">=</span> <span class="n">name_from_tag</span><span class="p">,</span>												<span class="c1">-- used for template documentation; possible use in ISO 639 name from code templates</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos" data-line="2013"></span></a>	<span class="n">transl</span> <span class="o">=</span> <span class="n">transl</span><span class="p">,</span>															<span class="c1">-- entry point for {{transliteration}}</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos" data-line="2014"></span></a>	
</span><span id="L-2015"><a href="#L-2015"><span class="linenos" data-line="2015"></span></a>	<span class="n">_category_from_tag</span> <span class="o">=</span> <span class="n">_category_from_tag</span><span class="p">,</span>									<span class="c1">-- entry points when this module is require()d into other modules</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos" data-line="2016"></span></a>	<span class="n">_lang</span> <span class="o">=</span> <span class="n">_lang</span><span class="p">,</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos" data-line="2017"></span></a>	<span class="n">_langx</span> <span class="o">=</span> <span class="n">_langx</span><span class="p">,</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos" data-line="2018"></span></a>	<span class="n">_lang_xx_inherit</span> <span class="o">=</span> <span class="n">_lang_xx_inherit</span><span class="p">,</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos" data-line="2019"></span></a>	<span class="n">_lang_xx_italic</span> <span class="o">=</span> <span class="n">_lang_xx_italic</span><span class="p">,</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos" data-line="2020"></span></a>	<span class="n">_is_ietf_tag</span> <span class="o">=</span> <span class="n">_is_ietf_tag</span><span class="p">,</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos" data-line="2021"></span></a>	<span class="n">get_ietf_parts</span> <span class="o">=</span> <span class="n">get_ietf_parts</span><span class="p">,</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos" data-line="2022"></span></a>	<span class="n">_tag_from_name</span> <span class="o">=</span> <span class="n">_tag_from_name</span><span class="p">,</span> 
</span><span id="L-2023"><a href="#L-2023"><span class="linenos" data-line="2023"></span></a>	<span class="n">_name_from_tag</span> <span class="o">=</span> <span class="n">_name_from_tag</span><span class="p">,</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos" data-line="2024"></span></a>	<span class="n">_transl</span> <span class="o">=</span> <span class="n">_transl</span><span class="p">,</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos" data-line="2025"></span></a>	<span class="n">_translation_make</span> <span class="o">=</span> <span class="n">translation_make</span><span class="p">,</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos" data-line="2026"></span></a>	<span class="p">};</span>
</span></pre></div>
<!-- 
NewPP limit report
Parsed by mw‐web.codfw.main‐779c5f569f‐n6xtk
Cached time: 20250328221724
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, vary‐page‐id, show‐toc]
CPU time usage: 0.286 seconds
Real time usage: 0.381 seconds
Preprocessor visited node count: 421/1000000
Post‐expand include size: 32280/2097152 bytes
Template argument size: 619/2097152 bytes
Highest expansion depth: 8/100
Expensive parser function count: 23/500
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 14644/5000000 bytes
Lua time usage: 0.228/10.000 seconds
Lua memory usage: 12257747/52428800 bytes
Number of Wikibase entities loaded: 0/400
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%  199.650      1 Module:Lang/doc
100.00%  199.650      1 -total
 54.88%  109.564      1 Template:Language_templates
 53.14%  106.102      1 Template:Sidebar
 16.54%   33.014      1 Template:High-use
  9.85%   19.661      4 Template:Category_link_with_count
  9.34%   18.650      1 Template:Lua
  3.93%    7.853      4 Template:Tlx
  3.10%    6.188      1 Template:Section_link
  2.13%    4.258      8 Template:Tl
-->
</div><!--esi <esi:include src="/esitest-fa8a495983347898/content" /> --><noscript><img src="https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&amp;type=1x1&amp;usesul3=0" alt="" width="1" height="1" style="border: none; position: absolute;"></noscript>
<div class="printfooter" data-nosnippet="">Retrieved from "<a dir="ltr" href="https://en.wikipedia.org/w/index.php?title=Module:Lang&amp;oldid=1271539603">https://en.wikipedia.org/w/index.php?title=Module:Lang&amp;oldid=1271539603</a>"</div></div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/wiki/Help:Category" title="Help:Category">Categories</a>: <ul><li><a href="/wiki/Category:Language-related_modules" title="Category:Language-related modules">Language-related modules</a></li><li><a href="/wiki/Category:Modules_that_check_for_strip_markers" title="Category:Modules that check for strip markers">Modules that check for strip markers</a></li></ul></div><div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="/wiki/Category:Wikipedia_template-protected_modules" title="Category:Wikipedia template-protected modules">Wikipedia template-protected modules</a></li></ul></div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 24 January 2025, at 14:24<span class="anonymous-show">&#160;(UTC)</span>.</li>
	<li id="footer-info-copyright">Text is available under the <a href="/wiki/Wikipedia:Text_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License" title="Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License">Creative Commons Attribution-ShareAlike 4.0 License</a>;
additional terms may apply. By using this site, you agree to the <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Terms_of_Use" class="extiw" title="foundation:Special:MyLanguage/Policy:Terms of Use">Terms of Use</a> and <a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy" class="extiw" title="foundation:Special:MyLanguage/Policy:Privacy policy">Privacy Policy</a>. Wikipedia® is a registered trademark of the <a rel="nofollow" class="external text" href="https://wikimediafoundation.org/">Wikimedia Foundation, Inc.</a>, a non-profit organization.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Wikipedia:About">About Wikipedia</a></li>
	<li id="footer-places-disclaimers"><a href="/wiki/Wikipedia:General_disclaimer">Disclaimers</a></li>
	<li id="footer-places-contact"><a href="//en.wikipedia.org/wiki/Wikipedia:Contact_us">Contact Wikipedia</a></li>
	<li id="footer-places-wm-codeofconduct"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Universal_Code_of_Conduct">Code of Conduct</a></li>
	<li id="footer-places-developers"><a href="https://developer.wikimedia.org">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/en.wikipedia.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Cookie_statement">Cookie statement</a></li>
	<li id="footer-places-mobileview"><a href="//en.m.wikipedia.org/w/index.php?title=Module:Lang&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://www.wikimedia.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/static/images/footer/wikimedia-button.svg" width="84" height="29"><img src="/static/images/footer/wikimedia.svg" width="25" height="25" alt="Wikimedia Foundation" lang="en" loading="lazy"></picture></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><picture><source media="(min-width: 500px)" srcset="/w/resources/assets/poweredby_mediawiki.svg" width="88" height="31"><img src="/w/resources/assets/mediawiki_compact.svg" alt="Powered by MediaWiki" lang="en" width="25" height="25" loading="lazy"></picture></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-header-container vector-sticky-header-container">
	<div id="vector-sticky-header" class="vector-sticky-header">
		<div class="vector-sticky-header-start">
			<div class="vector-sticky-header-icon-start vector-button-flush-left vector-button-flush-right" aria-hidden="true">
				<button class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-sticky-header-search-toggle" tabindex="-1" data-event-name="ui.vector-sticky-search-form.icon"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
			</button>
		</div>
			
		<div role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box">
			<div class="vector-typeahead-search-container">
				<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail">
					<form action="/w/index.php" id="vector-sticky-search-form" class="cdx-search-input cdx-search-input--has-end-button">
						<div  class="cdx-search-input__input-wrapper"  data-search-loc="header-moved">
							<div class="cdx-text-input cdx-text-input--has-start-icon">
								<input
									class="cdx-text-input__input"
									
									type="search" name="search" placeholder="Search Wikipedia">
								<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
							</div>
							<input type="hidden" name="title" value="Special:Search">
						</div>
						<button class="cdx-button cdx-search-input__end-button">Search</button>
					</form>
				</div>
			</div>
		</div>
		<div class="vector-sticky-header-context-bar">
				<nav aria-label="Contents" class="vector-toc-landmark">
						
					<div id="vector-sticky-header-toc" class="vector-dropdown mw-portlet mw-portlet-sticky-header-toc vector-sticky-header-toc vector-button-flush-left"  >
						<input type="checkbox" id="vector-sticky-header-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-sticky-header-toc" class="vector-dropdown-checkbox "  aria-label="Toggle the table of contents"  >
						<label id="vector-sticky-header-toc-label" for="vector-sticky-header-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"  ><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
						</label>
						<div class="vector-dropdown-content">
					
						<div id="vector-sticky-header-toc-unpinned-container" class="vector-unpinned-container">
						</div>
					
						</div>
					</div>
			</nav>
				<div class="vector-sticky-header-context-bar-primary" aria-hidden="true" ><span class="mw-page-title-namespace">Module</span><span class="mw-page-title-separator">:</span><span class="mw-page-title-main">Lang</span></div>
			</div>
		</div>
		<div class="vector-sticky-header-end" aria-hidden="true">
			<div class="vector-sticky-header-icons">
				<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-talk-sticky-header" tabindex="-1" data-event-name="talk-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbles mw-ui-icon-wikimedia-speechBubbles"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-subject-sticky-header" tabindex="-1" data-event-name="subject-sticky-header"><span class="vector-icon mw-ui-icon-article mw-ui-icon-wikimedia-article"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-history-sticky-header" tabindex="-1" data-event-name="history-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-history mw-ui-icon-wikimedia-wikimedia-history"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only mw-watchlink" id="ca-watchstar-sticky-header" tabindex="-1" data-event-name="watch-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-star mw-ui-icon-wikimedia-wikimedia-star"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-edit-sticky-header" tabindex="-1" data-event-name="wikitext-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-wikiText mw-ui-icon-wikimedia-wikimedia-wikiText"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-ve-edit-sticky-header" tabindex="-1" data-event-name="ve-edit-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-edit mw-ui-icon-wikimedia-wikimedia-edit"></span>

<span></span>
			</a>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only" id="ca-viewsource-sticky-header" tabindex="-1" data-event-name="ve-edit-protected-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-editLock mw-ui-icon-wikimedia-wikimedia-editLock"></span>

<span></span>
			</a>
		</div>
			<div class="vector-sticky-header-buttons">
				<button class="cdx-button cdx-button--weight-quiet mw-interlanguage-selector" id="p-lang-btn-sticky-header" tabindex="-1" data-event-name="ui.dropdown-p-lang-btn-sticky-header"><span class="vector-icon mw-ui-icon-wikimedia-language mw-ui-icon-wikimedia-wikimedia-language"></span>

<span>142 languages</span>
			</button>
			<a href="#" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--action-progressive" id="ca-addsection-sticky-header" tabindex="-1" data-event-name="addsection-sticky-header"><span class="vector-icon mw-ui-icon-speechBubbleAdd-progressive mw-ui-icon-wikimedia-speechBubbleAdd-progressive"></span>

<span>Add topic</span>
			</a>
		</div>
			<div class="vector-sticky-header-icon-end">
				<div class="vector-user-links">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="mw-portlet mw-portlet-dock-bottom emptyPortlet" id="p-dock-bottom">
	<ul>
		
	</ul>
</div>
<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgHostname":"mw-web.codfw.main-779c5f569f-n6xtk","wgBackendResponseTime":906,"wgPageParseReport":{"limitreport":{"cputime":"0.286","walltime":"0.381","ppvisitednodes":{"value":421,"limit":1000000},"postexpandincludesize":{"value":32280,"limit":2097152},"templateargumentsize":{"value":619,"limit":2097152},"expansiondepth":{"value":8,"limit":100},"expensivefunctioncount":{"value":23,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":14644,"limit":5000000},"entityaccesscount":{"value":0,"limit":400},"timingprofile":["100.00%  199.650      1 Module:Lang/doc","100.00%  199.650      1 -total"," 54.88%  109.564      1 Template:Language_templates"," 53.14%  106.102      1 Template:Sidebar"," 16.54%   33.014      1 Template:High-use","  9.85%   19.661      4 Template:Category_link_with_count","  9.34%   18.650      1 Template:Lua","  3.93%    7.853      4 Template:Tlx","  3.10%    6.188      1 Template:Section_link","  2.13%    4.258      8 Template:Tl"]},"scribunto":{"limitreport-timeusage":{"value":"0.228","limit":"10.000"},"limitreport-memusage":{"value":12257747,"limit":52428800}},"cachereport":{"origin":"mw-web.codfw.main-779c5f569f-n6xtk","timestamp":"20250328221724","ttl":2592000,"transientcontent":false}}});});</script>
</body>
</html>